var oaApp=angular.module("oaApp",["gantt","gantt.drawtask","gantt.tooltips","gantt.progress","gantt.table","gantt.tree","ui.tree","ng.ueditor","gantt.overlap","highcharts-ng","ui.router","ngCookies","ui.bootstrap.datetimepicker","angularFileUpload","ngFileUpload","factoryApp","LoginMod","IndexMod","TaskMod","AttendanceMod","NoticeMod","MeetingMod","ProjectMod","SurveyMod","workStatementMod","systemMod","ApplyMod","MsgMod","ColleagueMod","personalInfoMod","NanoCloudMod","ng-context-menu","ApplymobileMod"]).directive("head",["$rootScope","$compile","$state","$interpolate",function($rootScope,$compile,$state,$interpolate){return{restrict:"E",link:function(scope,elem){var start=$interpolate.startSymbol(),end=$interpolate.endSymbol(),html='<link rel="stylesheet" ng-repeat="(k, css) in routeStyles track by k" ng-href="'+start+"css"+end+'" >';elem.append($compile(html)(scope));var $$parentState=function(state){var name=state.parent||(/^(.+)\.[^.]+$/.exec(state.name)||[])[1];return name&&$state.get(name)};scope.routeStyles=[],$rootScope.$on("$stateChangeSuccess",function(evt,toState){scope.routeStyles=[];for(var state=toState;state&&""!==state.name;state=$$parentState(state))state&&state.data&&state.data.css&&(Array.isArray(state.data.css)||(state.data.css=[state.data.css]),angular.forEach(state.data.css,function(css){scope.routeStyles.indexOf(css)===-1&&scope.routeStyles.push(css)}));scope.routeStyles.reverse()})}}}]).run(function($rootScope,$stateParams,$state,$location,$cookieStore){$rootScope.$on("$stateChangeStart",function(e,toState,toParams,fromState,fromParams){if($("#masklayer1,#masklayer2").hide(),"public"===toState.module&&$location.path().indexOf("/forgetPassword/")>0)return!0;if(1==$cookieStore.get("app"))return!0;if("private"===toState.module&&"undefined"==typeof $cookieStore.get("userInfo")?(e.preventDefault(),$state.go("login")):"public"===toState.module&&"undefined"!=typeof $cookieStore.get("userInfo")&&(e.preventDefault(),$state.go("main.index")),"private"===toState.module){var user=$cookieStore.get("userInfo");if(1==user.perm_groupid)return!0;var sname=toState.name,perms=JSON.parse(window.localStorage.allper),permObject=JSON.parse(window.localStorage.userper),ishide=!0,currentPerm="";angular.forEach(perms,function(ov,ok){if(ov==sname)return currentPerm=ok,!1}),""!=currentPerm&&(angular.forEach(permObject,function(v,k){if(v.toLowerCase()==currentPerm.toLowerCase())return ishide=!1,!1}),ishide&&(e.preventDefault(),$state.go("main.error")))}return!0})}).config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q,$state){$urlRouterProvider.otherwise("/login")}]).config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push("OAInterceptor")}]);
Array.prototype.distincts=function(){var self=this,_a=this.concat().sort();return _a.sort(function(a,b){if(a==b){var n=self.indexOf(a);self.splice(n,1)}}),self},oaApp.directive("checkLength",function($timeout){return function(scope,element,attrs){function strlen(str){for(var realLength=0,len=str.length,charCode=-1,i=0;i<len;i++)charCode=str.charCodeAt(i),realLength+=charCode>=0&&charCode<=128?1:2;return realLength}element.bind("keyup",function(){var str=element.val();if(strlen(str)>16)return alert("技能名称不能超过8个字符"),!1})}}),oaApp.directive("checkingNums",function($timeout,Publicfactory){return{restrict:"E",replace:!0,require:"?ngModel",transclude:!0,scope:{nums:"=checkingMax",place:"=checkingPlaceholder",id:"=checkingId"},controller:function($scope){$scope.text={},$scope.text.nums=$scope.nums,$scope.text.placeholder=$scope.place,$scope.text.id=$scope.id},template:'<div><form name="myform"><textarea placeholder="{{text.placeholder}}" id="{{text.id}}" ng-model="textarea"  ng-paste="pastes(event)"  ng-keydown="textarea_change(event)" ng-keyup="textarea_change(event)"></textarea><span class="input_tips" ng-class="{error:text.nums-textarealength<0}">{{text.nums-textarealength<0 ? \'您输入的内容已超出\'+(-(text.nums-textarealength)) : \'您还可输入\'+(text.nums-textarealength)}}个字</span></form></div>',link:function(scope,element,attrs,ngModel){function check_texttarea(str){str=str.replace(/\s/g,""),str?Publicfactory.checkEnCnstrlen(str)>2*scope.nums:(angular.element("#"+scope.id).val(""),scope.textarealength=0)}scope.textarealength=0,scope.textarea_change=function(event){scope.$evalAsync(function(){ngModel.$setViewValue(angular.element("#"+scope.id).val())}),check_texttarea(angular.element("#"+scope.id).val()),scope.textarealength=Math.round(Publicfactory.checkEnCnstrlen(angular.element("#"+scope.id).val())/2)},scope.pastes=function(event){$timeout(function(){scope.$apply(function(){scope.textarea_change(event)})})},angular.element(".p2pInfoClose, .apprBtn-cancel").bind("click",function(){scope.$apply(function(){return!(scope.nums-scope.textarealength<0)&&(scope.textarea="",angular.element("#"+scope.id).val(""),scope.textarealength=0,void 0)})})}}}),oaApp.directive("myformDateFormat",["$filter",function($filter){var dateFilter=$filter("date");return{require:"ngModel",link:function(scope,elm,attrs,ctrl){function formatter(value){return"年-月-日 时:分"==attrs.placeholder||""==attrs.placeholder||"请输入开始时间"==attrs.placeholder||"请输入结束时间"==attrs.placeholder?dateFilter(value,"yyyy-MM-dd HH:mm"):"年-月-日 时"==attrs.placeholder?dateFilter(value,"yyyy-MM-dd HH"):"年-月-日"==attrs.placeholder?dateFilter(value,"yyyy-MM-dd"):"年-月"==attrs.placeholder?dateFilter(value,"yyyy-MM"):attrs.placeholder?dateFilter(value,value):dateFilter(value,"yyyy-MM-dd")}ctrl.$formatters.push(formatter)}}}]),oaApp.directive("myformDateFormats",["$filter",function($filter){var dateFilter=$filter("date");return{require:"ngModel",link:function(scope,elm,attrs,ctrl){function formatter(value){return"年-月-日 时:分"==attrs.placeholder?dateFilter(value,"yyyy-MM-dd HH:00"):"年-月-日 时"==attrs.placeholder?dateFilter(value,"yyyy-MM-dd HH"):"年-月-日"==attrs.placeholder?dateFilter(value,"yyyy-MM-dd"):"年-月"==attrs.placeholder?dateFilter(value,"yyyy-MM"):attrs.placeholder?dateFilter(value,value):dateFilter(value,"yyyy-MM-dd")}ctrl.$formatters.push(formatter)}}}]),oaApp.directive("showNoData",function(){return{link:function(scope,elm,attrs,ctrl){elm.html("此类暂无数据")}}}),oaApp.directive("uploadModal",function(FileUploader){return{scope:{uploadAttrs:"&uploadAttrs",att:"=attObject"},controller:function($scope,$element,$attrs,$transclude){$scope.uploader=new FileUploader,$scope.uploader.onAfterAddingFile=function(fileItem){if(fileItem._file.size>52428800)return alert(fileItem._file.name+"大小超过50MB，已从上传队列中移除。"),fileItem.remove(),!1;var isUpload=0,msg="总文件大小超过50MB，已从上传队列中移除。",countSize=0;return angular.element.each($scope.att,function(key,val){countSize+=parseInt(val.file_size)}),countSize+=fileItem._file.size,1==isUpload||countSize>52428800?(alert(msg),fileItem.remove(),$scope.uploadModal||($scope.uploadModal=!1),!1):($scope.uploadModal=!1,void($scope.uploader.autoUpload=!0))}},restrict:"AE",templateUrl:"/appnews/modules/window/upload_modal.html",transclude:!0,link:function(scope,element,attrs){var uploadAttrs=scope.uploadAttrs();element.find(".openModal").bind("click",function(event){uploadAttrs(scope.uploader,element)}),element.find(".finish").bind("click",function(event){scope.$apply(function(){scope.uploadModal=!scope.uploadModal}),scope.uploader.clearQueue()})}}}),oaApp.directive("uploadModalImages",function(FileUploader){return{scope:{uploadAttrs:"&uploadAttrs",att:"=attObject"},controller:function($scope,$element,$attrs,$transclude){$scope.uploader=new FileUploader,$scope.uploader.onAfterAddingFile=function(fileItem){var regexp=/(.png)|(.PNG)|(.jpg)|(.JPG)|(.gif)|(.jpeg)$/g;if(!regexp.test(fileItem._file.name))return alert("请上传图片文件！"),fileItem.remove(),!1;if(fileItem._file.size>52428800)return alert(fileItem._file.name+"大小超过50MB，已从上传队列中移除。"),fileItem.remove(),!1;var isUpload=0,msg="总文件大小超过50MB，已从上传队列中移除。",countSize=0;return angular.element.each($scope.att,function(key,val){countSize+=parseInt(val.file_size)}),countSize+=fileItem._file.size,1==isUpload||countSize>52428800?(alert(msg),fileItem.remove(),$scope.uploadModal||($scope.uploadModal=!1),!1):($scope.uploadModal=!1,void($scope.uploader.autoUpload=!0))}},restrict:"AE",templateUrl:"/appnews/modules/window/upload_modal_images.html",transclude:!0,link:function(scope,element,attrs){var uploadAttrs=scope.uploadAttrs();element.find(".openModal").bind("click",function(event){uploadAttrs(scope.uploader,element)}),element.find(".finish").bind("click",function(event){scope.$apply(function(){scope.uploadModal=!scope.uploadModal}),scope.uploader.clearQueue()})}}}),oaApp.directive("uploadModalsingle",function(FileUploader){return{scope:{uploadAttrs:"&uploadAttrs"},controller:function($scope,$element,$attrs,$transclude){$scope.uploader=new FileUploader,$scope.uploader.onAfterAddingFile=function(fileItem){$scope.uploadModal=!1;fileItem._file.name.length>40&&(alert("文件名过长，请限制在20字以内。"),fileItem.remove()),fileItem._file.size>52428800&&(alert(fileItem._file.name+"大小超过50MB，已从上传队列中移除。"),fileItem.remove()),$scope.uploader.autoUpload=!0}},restrict:"AE",templateUrl:"/appnews/modules/window/upload_modal_single.html",transclude:!0,link:function(scope,element,attrs){var uploadAttrs=scope.uploadAttrs();element.find(".openModal").bind("click",function(event){uploadAttrs(scope.uploader)}),element.find(".finish").bind("click",function(event){scope.$apply(function(){scope.uploadModal=!scope.uploadModal}),scope.uploader.clearQueue()})}}}),oaApp.directive("uploadModalsinglebtn",function(FileUploader){return{scope:{uploadAttrs:"&uploadAttrs"},controller:function($scope,$element,$attrs,$transclude){$scope.uploader=new FileUploader,$scope.uploader.onAfterAddingFile=function(fileItem){$scope.uploadModal=!0;fileItem._file.name.length>20&&(alert("文件名过长，请限制在20字以内。"),fileItem.remove()),fileItem._file.size>52428800&&(alert(fileItem._file.name+"大小超过50MB，已从上传队列中移除。"),fileItem.remove()),$scope.uploader.autoUpload=!0}},restrict:"AE",templateUrl:"/appnews/views/templates/default/modal/upload_modal_single3.html",transclude:!0,link:function(scope,element,attrs){var uploadAttrs=scope.uploadAttrs();element.find(".openModal").bind("click",function(event){uploadAttrs(scope.uploader)}),element.find(".finish").bind("click",function(event){scope.$apply(function(){scope.uploadModal=!scope.uploadModal}),scope.uploader.clearQueue()})}}}),oaApp.directive("boardroomReserve",function($timeout){return{scope:{},controller:function($scope,$element,$attrs,$transclude){$scope.chosenArray=[],$scope.$on("ngRepeatFinished",function(ngRepeatFinishedEvent){$element.find("p").length>=1&&$element.find(".reserve_time_bor").addClass("selected")})},link:function(scope,element,attrs,$index){element.bind("click",function(){element.find(".reserved").length||(scope.$apply(function(){scope.chosenArray.push(element.index())}),element.toggleClass("chosen"),chosenNum=element.parents(".br-reserve-li").find(".chosen").length,chosenNum?element.parents(".br-reserve-li").find("button").removeAttr("disabled"):element.parents(".br-reserve-li").find("button").attr("disabled",!0))});var bodyW=parseInt(document.body.clientWidth)-265;$(window).on("resize",function(e){bodyW=parseInt(document.body.clientWidth)-265}),element.bind("mouseenter",function(){var Rtip=element.find(".reserved-tip"),thisR=parseInt(element[0].offsetLeft)+550;console.log(bodyW),bodyW-thisR<0&&bodyW>820?Rtip.addClass("reserved-rtip").show():Rtip.removeClass("reserved-rtip").show()}),element.bind("mouseleave",function(){element.find(".reserved-tip").hide()}),$timeout(function(){scope.$emit("ngRepeatFinished")})}}}),oaApp.directive("reservedTime",function(){return function(scope,element,attrs){var reservedTime=element.find(".reserved-time-list");reservedTime.bind("mouseenter",function(){reservedTime.find(".reserved-time-tip").show()}),reservedTime.bind("mouseleave",function(){reservedTime.find(".reserved-time-tip").hide()})}}),oaApp.directive("repeatClick",function($timeout){return function(scope,element,attrs){element.bind("click",function(){element.addClass("disabled-click"),$timeout(function(){element.removeClass("disabled-click")},6e3)})}}),oaApp.directive("repeatClickmin",function($timeout){return function(scope,element,attrs){element.bind("click",function(){element.addClass("disabled-click"),$timeout(function(){element.removeClass("disabled-click")},3e3)})}}),oaApp.directive("isperm",function($compile,$cookies,$cookieStore,$rootScope){return function(scope,element,attrs){if(1==$cookieStore.get("app"))return!0;var permStr=attrs.pcode;if(null!=JSON.parse(window.localStorage.userper)||""!=JSON.parse(window.localStorage.userper)){var permObject=angular.fromJson(JSON.parse(window.localStorage.userper));if(""!=permStr&&void 0!=permStr){permStr=permStr.toLowerCase();var ishide=!0;angular.forEach(permObject,function(v,k){if(v.toLowerCase()==permStr)return ishide=!1,!1}),ishide&&angular.element(element).addClass("none")}else angular.element(element).addClass("none")}else angular.element(element).addClass("none")}}),oaApp.directive("ispremmulti",function($compile,$cookieStore,$state,$rootScope){return{restrict:"EA",scope:!0,link:function($scope,element,attrs){var permUrls=JSON.parse(window.localStorage.allper);if("undefined"==typeof permUrls)return angular.element(element).addClass("hide"),!1;if($scope.tmpperm={},$scope.tmpperm.tojump=function(perm){return"undefined"!=typeof permUrls[perm]&&$state.href(permUrls[perm])},$scope.tmpperm.currentperm=attrs.currenturl,1==user.perm_groupid)return!1;if(""==attrs.pcodes||"undefined"==typeof attrs.pcodes)return!0;if(null==user.permission||""==user.permission)return angular.element(element).addClass("hide"),!1;var perms=attrs.pcodes.split(","),permObject=angular.fromJson(user.permission),ishide=!0;angular.forEach(perms,function(ov,ok){angular.forEach(permObject,function(v,k){if(v.toLowerCase()==ov.toLowerCase())return ishide=!1,$scope.tmpperm.currentperm=v,!1})}),ishide&&angular.element(element).addClass("hide")}}}),oaApp.directive("userGroup",function($timeout){return{scope:{gid:"@orgid"},restrict:"AE",replace:!0,transclude:!0,template:'<em id="dire-org" ng-bind="ug"></em>',controller:function($scope,$element,$attrs,$http){$attrs.$observe("orgid",function(actual_value){actual_value&&$http.get("/index.php?r=org/get-all-parent-orgname&org_id="+actual_value).success(function(data,status){$scope.ug=data.data})})},link:function(scope,element,attrs){}}}),oaApp.directive("spanFilesize",function($timeout){return{restrict:"E",replace:!0,require:"?ngModel",transclude:!0,scope:{sizesb:"=sizesId"},controller:function($scope){},link:function(scope,element,attrs,ngModel){function bytesToSizes(bytes){if(0===bytes)return"0 B";var k=1024,sizes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(bytes)/Math.log(k));return(bytes/Math.pow(k,i)).toPrecision(3)+" "+sizes[i]}var spanfilesize=element.parent().find(".spanfilesize");$timeout(function(){var texts=bytesToSizes(spanfilesize.text());element.html(texts)},500)}}}),oaApp.directive("paging",function($timeout){return{replace:!0,scope:{page:"=pageObject",query:"=clickFunction"},controller:function($scope,$element){$scope.createHtml=function(){if($scope.page.sumPage>1){var str='<div class="listWrap"><div class="pagebor of clear"><ul>';if($scope.page.curPage>1&&(str+='<li><a href="javascript:void(0);">&lt;上一页</a></li>'),$scope.page.sumPage>5)if($scope.page.curPage<4){for(var i=1;i<=4;i++)str+=i==$scope.page.curPage?'<li class="selected"><a href="javascript:void(0);">'+i+"</a></li>":'<li><a href="javascript:void(0);">'+i+"</a></li>";str+='<li class="omit3 nobor poabso">…</li>',str+='<li><a href="javascript:void(0);">'+$scope.page.sumPage+"</a></li>"}else if($scope.page.curPage>$scope.page.sumPage-3){str+='<li><a href="javascript:void(0);">1</a></li>',str+='<li class="omit3 nobor poabso">…</li>';for(var i=parseInt($scope.page.sumPage)-3;i<=parseInt($scope.page.sumPage);i++)str+=i==$scope.page.curPage?'<li class="selected"><a href="javascript:void(0);">'+i+"</a></li>":'<li><a href="javascript:void(0);">'+i+"</a></li>"}else{str+='<li><a href="javascript:void(0);">1</a></li>',str+='<li class="omit3 nobor poabso">…</li>';for(var i=parseInt($scope.page.curPage)-1;i<=parseInt($scope.page.curPage)+1;i++)str+=i==$scope.page.curPage?'<li class="selected"><a href="javascript:void(0);">'+i+"</a></li>":'<li><a href="javascript:void(0);">'+i+"</a></li>";str+='<li class="omit3 nobor poabso">…</li>',str+='<li><a href="javascript:void(0);">'+$scope.page.sumPage+"</a></li>"}else for(var i=1;i<=$scope.page.sumPage;i++)str+=i==$scope.page.curPage?'<li class="selected"><a href="javascript:void(0);">'+i+"</a></li>":'<li><a href="javascript:void(0);">'+i+"</a></li>";$scope.page.curPage<$scope.page.sumPage&&(str+='<li><a href="javascript:void(0);">下一页&gt;</a></li>'),str+='<div class="inblock pagesearchbor porela">共<span>'+$scope.page.sumPage+'</span>页，到第 <input type="text" id="jumpNum"/> 页<a class="of button">确定</a><!--<button class="of">确定</button>--></div></ul></div></div>',$element.html(str),$scope.bindEvent()}else{var str="";$element.html(str),$scope.bindEvent()}},$scope.bindEvent=function(){$element.find("a").on("click",function(){if($scope.page.tempcurPage==$scope.page.curPage){var text=$(this).html(),is_fun=!1,jumpNum=$("#jumpNum").val(),chk_num=/^\d+$/,curPage=$scope.page.curPage;if("&lt;上一页"==$.trim(text))curPage>1&&($scope.page.tempcurPage=parseInt(curPage)-1,is_fun=!0);else if("下一页&gt;"==$.trim(text))curPage<$scope.page.sumPage&&($scope.page.tempcurPage=parseInt(curPage)+1,is_fun=!0);else if("确定"==$.trim(text)){if(!chk_num.test(jumpNum))return $("#jumpNum").focus().select(),void alert("请输入正确的页码");if(jumpNum<1)return $("#jumpNum").focus().select(),void alert("请输入正确的页码");if(jumpNum>$scope.page.sumPage)return $("#jumpNum").focus().select(),void alert("请输入正确的页码");is_fun=!0,$scope.page.tempcurPage=parseInt(jumpNum)}else{if($scope.page.curPage==$.trim(text))return;if(!chk_num.test($.trim(text)))return $("#jumpNum").focus().select(),void alert("请输入正确的页码");if($.trim(text)<1)return $("#jumpNum").focus().select(),void alert("请输入正确的页码");if($.trim(text)>$scope.page.sumPage)return $("#jumpNum").focus().select(),void alert("请输入正确的页码");$scope.page.tempcurPage=$.trim(text),is_fun=!0}is_fun&&($scope.query(),$scope.createHtml())}})},$scope.createHtml(),$scope.$watch("page.curPage",function(){$scope.createHtml()}),$scope.$watch("page.sumPage",function(){$scope.createHtml()})}}}),oaApp.directive("notice",function($state){return{restrict:"EA",templateUrl:"/appnews/modules/window/dialog.html",scope:{message:"=",type:"=",gourl:"="},link:function(scope,element,attrs){scope.hideNotice=function(gourl){scope.message=null,scope.type=null,gourl&&void 0!=gourl.url&&void 0!=gourl.params&&void 0!=gourl.params2&&$state.go(gourl.url,gourl.params,gourl.params2),scope.gourl=null,$("#masklayer1").hide()}}}});
oaApp.factory("noticeService",["$timeout",function($timeout){return{message:null,type:null,gourl:null,setMessage:function(msg,type,time,goUrl){this.message=msg,this.type=type,this.gourl=goUrl,$("#masklayer1").show();var _self=this;time&&$timeout(function(){_self.clear()},time)},clear:function(){this.message=null,this.type=null,this.gourl=null,$("#masklayer1").hide()}}}]),oaApp.factory("permissionService",function($http,$cookieStore,$rootScope){var service={};return service.getAllPermission=function($scope){$http.post("/index.php?r=permission/permission/permissionlist",JSON.stringify($scope.permission_param)).success(function(data,status){2e4==data.code&&($scope.permission.permissionList=data.data)})},service.checkPermission=function(pcode){if(null!=JSON.parse(window.localStorage.userper)||""!=JSON.parse(window.localStorage.userper)){var permObject=angular.fromJson(JSON.parse(window.localStorage.userper));if(""!=pcode&&void 0!=pcode){pcode=pcode.toLowerCase();var isFind=!1;angular.forEach(permObject,function(v,k){v.toLowerCase()==pcode&&(isFind=!0)})}}return!!isFind||(alert("没有权限，请联系管理员!"),!1)},service});
var factoryApp=angular.module("factoryApp",[]);factoryApp.factory("formshowfactory",function(Publicfactory){var service={};return service.formshow=function(results,$compile,$scope,status){function selectTimes(str){return"年-月-日 时:分"==str?str="yyyy-mm-dd HH:ii":"年-月-日 时"==str?str="yyyy-mm-dd HH":"年-月-日"==str?str="yyyy-mm-dd":"年-月"==str&&(str="yyyy-mm"),str}function selectTimes_format(str){return"年-月-日 时:分"==str?str=0:"年-月-日 时"==str?str=1:"年-月-日"==str?str=2:"年-月"==str&&(str=3),str}$(".formpresentation .formtitles").html(results.title),1==status?$("#formpresentation_edit .scrollbor:eq(0)").html(""):$("#formpresentation .scrollbor:eq(0)").html("");var showForms=new jQuery.showeditForm;$.each(results.field,function(i,item){var htmls=showForms.formWidget(results.field[i].formtype),fieldlast="";1==status?($("#formpresentation_edit .scrollbor:eq(0)").append(htmls),fieldlast=$("#formpresentation_edit .scrollbor:eq(0) .borderbor:last")):($("#formpresentation .scrollbor:eq(0)").append(htmls),fieldlast=$("#formpresentation .scrollbor:eq(0) .borderbor:last"));var leftTitle=results.field[i].title,description=results.field[i].describe,required=results.field[i].required;if(fieldlast.find(".widget-title").text(leftTitle),description&&fieldlast.find(".field-description").removeClass("hide").text(description),1==required&&fieldlast.find(".widget-required").addClass("block"),"Mobile"!=results.field[i].formtype&&"Phone"!=results.field[i].formtype&&"NumberComponent"!=results.field[i].formtype&&"Email"!=results.field[i].formtype||results.field[i].inputvalue&&fieldlast.find("input").val(results.field[i].inputvalue),"Text"==results.field[i].formtype&&(1==status?results.field[i].inputvalue&&fieldlast.find("input").val(results.field[i].inputvalue):results.field[i].inputvalue&&(fieldlast.find("input").remove(),fieldlast.find(".rcontent").prepend('<span class="readtext">'+results.field[i].inputvalue+"</span>"))),"CheckBox"==results.field[i].formtype){fieldlast.find(".rcontent ul").html("");var checkboxNum=Object.keys(results.field[i].setting.checkbox).length,checkboxMax=results.field[i].setting.checkedMax;fieldlast.find("input[name=checkedMax]").val(checkboxMax);for(var c=0;c<checkboxNum;c++){var checkbox_title=results.field[i].setting.checkbox[c].itemTitle;fieldlast.find(".rcontent ul").append('<li><label class="CheckBox_js"><input name="CheckBoxView'+i+'" type="checkbox"><span>'+checkbox_title+"</span></label></li>"),results.field[i].setting.checkbox[c].itemData&&fieldlast.find(".CheckBox_js:eq("+c+")").find("input").attr("checked",!0)}fieldlast.find(".rcontent ul input").click(function(){var checkedNum=showForms.checkedMax(checkboxMax,checkboxNum,fieldlast);checkedNum>checkboxMax&&(alert("您最多只能勾选"+checkboxMax+"个"),$(this).attr("checked",!1))})}if("RadioBox"==results.field[i].formtype){fieldlast.find(".rcontent ul").html("");for(var radioNum=Object.keys(results.field[i].setting.radio).length,o=0;o<radioNum;o++){var radio_title=results.field[i].setting.radio[o].itemTitle;fieldlast.find(".rcontent ul").append('<li><label class="radio-inline"><input name="radioView'+i+'" type="radio"><span>'+radio_title+"</span></label></li>"),results.field[i].setting.radio[o].itemData&&fieldlast.find(".radio-inline:eq("+o+")").find("input").attr("checked",!0)}}if("Select"==results.field[i].formtype){fieldlast.find(".choicelist").html("");for(var SelectNum=Object.keys(results.field[i].setting.select).length,s=0;s<SelectNum;s++){var Select_title=results.field[i].setting.select[s].itemTitle;fieldlast.find(".choicelist").append('<option class="Select_js" value="">'+Select_title+"</option>"),results.field[i].setting.select[s].itemData&&fieldlast.find(".Select_js:eq("+s+")").attr("selected",!0)}}if("Paragraph"==results.field[i].formtype){var Paragraph_style=results.field[i].styleType;fieldlast.find(".alert").html(results.field[i].content),fieldlast.find(".alert").removeClass().addClass("alert "+Paragraph_style)}if("Money"==results.field[i].formtype&&(fieldlast.find(".money-type").text(results.field[i].moneyType),results.field[i].inputvalue&&fieldlast.find("input").val(results.field[i].inputvalue)),setTimeout(function(){"DateComponent"==results.field[i].formtype&&(fieldlast.find("input").val(""),1==status&&(fieldlast.find("input").eq(0).attr({placeholder:results.field[i].dateType}),fieldlast.find("input").datetimepicker({format:selectTimes(results.field[i].dateType),autoclose:!0,todayBtn:!0,startView:selectTimes_format(results.field[i].dateType),minView:selectTimes_format(results.field[i].dateType),pickerPosition:"bottom-right"})),results.field[i].inputvalue&&fieldlast.find("input").val(results.field[i].inputvalue)),"DateInterval"==results.field[i].formtype&&(fieldlast.find("input").attr({placeholder:results.field[i].dateType}),1==status&&fieldlast.find("input")&&(fieldlast.find("input").eq(0).datetimepicker({format:selectTimes(results.field[i].dateType),autoclose:!0,todayBtn:!1,startView:selectTimes_format(results.field[i].dateType),minView:selectTimes_format(results.field[i].dateType),pickerPosition:"bottom-right"}).on("changeDate",function(ev,startDate){fieldlast.find("input").eq(1).datetimepicker("setStartDate",fieldlast.find("input").eq(0).val())}),fieldlast.find("input").eq(1).datetimepicker({format:selectTimes(results.field[i].dateType),autoclose:!0,todayBtn:!1,startView:selectTimes_format(results.field[i].dateType),minView:selectTimes_format(results.field[i].dateType),pickerPosition:"bottom-right"}).on("changeDate",function(ev){fieldlast.find("input").eq(0).datetimepicker("setEndDate",fieldlast.find("input").eq(1).val())})),results.field[i].inputvalue&&(fieldlast.find("input").eq(0).val(results.field[i].inputvalue),fieldlast.find("input").eq(1).val(results.field[i].dateTimeEnd)))},1e3),"FileComponent"==results.field[i].formtype){var file="<upload-modal upload-attrs='addFileBtn' att-object='att'>添加附件</upload-modal>",filenews=$compile(file)($scope);if(fieldlast.find(".btn").html(filenews),results.field[i].setting)for(var fieldNum=Object.keys(results.field[i].setting.FileComponent).length,fieldc=0;fieldc<fieldNum;fieldc++)fieldlast.find("ul").append('<li class="porela">'+results.field[i].setting.FileComponent[fieldc].FileComponent+"</li>");0==status&&fieldlast.find(".btn, .del").remove()}if("ImageComponent"==results.field[i].formtype){var file="<upload-modal-images upload-attrs='addFileBtn' att-object='att'>上传图片</upload-modal-images>",filenews=$compile(file)($scope);if(fieldlast.find(".btn").html(filenews),results.field[i].setting)for(var ImageNum=Object.keys(results.field[i].setting.ImageComponent).length,imgc=0;imgc<ImageNum;imgc++)fieldlast.find("ul").append('<li class="porela">'+results.field[i].setting.ImageComponent[imgc].itemImgs+"</li>");0==status&&fieldlast.find(".btn, .del").remove()}if("TextArea"==results.field[i].formtype){if(results.field[i].inputvalue){var field_value=results.field[i].inputvalue;field_value=field_value.replace(/<br\/>/gi,"\n"),field_value=field_value.replace(/&nbsp;/gi," "),fieldlast.find("textarea").val(field_value)}0==status&&fieldlast.find("textarea").attr({disabled:"disabled"})}if("Department"==results.field[i].formtype||"Employee"==results.field[i].formtype){var grouphtml=fieldlast.find(".addbtn1");if(grouphtml.attr({id:i}),$compile(grouphtml)($scope),results.field[i].setting)for(var deparNum=Object.keys(results.field[i].setting.Employee).length,dep=0;dep<deparNum;dep++)fieldlast.find("ul").append('<li class="porela"><div class="filename fl omit" data-member_id='+results.field[i].setting.Employee[dep].itemId+">"+results.field[i].setting.Employee[dep].itemName+'</div><div class="del fr">删除</div></li>');0==status&&(fieldlast.find(".addbtn1,.del").remove(),fieldlast.find(".rcontent").addClass("read"))}0==status&&fieldlast.find("input").attr({disabled:"disabled"})})},service.formshowsave=function(results){function formError(obj){var oTimer=null,i=0;oTimer=setInterval(function(){i++,7==i?clearInterval(oTimer):i%2==0?obj.css("background-color","#ffffff"):obj.css("background-color","#ffd8d5")},100)}function scrollcontr(id){container.scrollTop(id.offset().top-container.offset().top+container.scrollTop()),formError(id)}if(CheckTextBiaoqing()){var isok=!0,fieldlast=$("#formpresentation_edit .borderbor"),borderborid=$("#formpresentation_edit .scrollbor .borderbor"),reg_Mobile=/^((\+?86)|(\(\+86\)))?(13[012356789][0-9]{8}|15[012356789][0-9]{8}|18[02356789][0-9]{8}|147[0-9]{8}|1349[0-9]{7})$/,reg_Emails=/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]+$/,reg_phones=/^([0-9]{3,4}-)?[0-9]{7,8}$/,reg_num_one=/^([1-9]\d{0,7}|0)(\.\d{1,2})?$/,container=$("#formpresentation_edit .scrollbor");$.each(results.field,function(i,item){var leftTitle=results.field[i].title;if("CheckBox"==results.field[i].formtype&&1==results.field[i].required){var checkboxed=fieldlast.eq(i).find("input[type='checkbox']:checked").length;if(0==checkboxed)return alert("请选择该"+leftTitle+"！"),scrollcontr(borderborid.eq(i)),isok=!1,!1}if("RadioBox"==results.field[i].formtype&&1==results.field[i].required){var radioed=fieldlast.eq(i).find("input[type='radio']:checked").length;if(0==radioed)return alert("请选择该"+leftTitle+"！"),scrollcontr(borderborid.eq(i)),isok=!1,!1}if("DateComponent"==results.field[i].formtype&&1==results.field[i].required&&""==fieldlast.eq(i).find("input").val())return alert("请选择该"+leftTitle+"！"),scrollcontr(borderborid.eq(i)),isok=!1,!1;if("DateInterval"==results.field[i].formtype&&1==results.field[i].required&&(""==fieldlast.eq(i).find("input:eq(0)").val()||""==fieldlast.eq(i).find("input:eq(1)").val()))return alert("请选择该"+leftTitle+"！"),scrollcontr(borderborid.eq(i)),isok=!1,!1;if("Text"==results.field[i].formtype||"Money"==results.field[i].formtype||"Mobile"==results.field[i].formtype||"Phone"==results.field[i].formtype||"NumberComponent"==results.field[i].formtype||"Email"==results.field[i].formtype){if(1==results.field[i].required&&""==fieldlast.eq(i).find("input").val().YLstringcheck())return alert("请填写该"+leftTitle+"！"),scrollcontr(borderborid.eq(i)),isok=!1,!1;if(Publicfactory.checkEnCnstrlen(fieldlast.eq(i).find("input").val())>60)return alert("请填写该"+leftTitle+"内容长度不能大于30个字！"),scrollcontr(borderborid.eq(i)),isok=!1,!1}if(("Employee"==results.field[i].formtype||"Department"==results.field[i].formtype||"FileComponent"==results.field[i].formtype||"ImageComponent"==results.field[i].formtype)&&1==results.field[i].required&&0==fieldlast.eq(i).find("ul li").length)return alert("请添加该"+leftTitle+"！"),scrollcontr(borderborid.eq(i)),isok=!1,!1;if("TextArea"==results.field[i].formtype){if(1==results.field[i].required&&""==fieldlast.eq(i).find("textarea").val().YLstringcheck())return alert("请填写该"+leftTitle+"！"),scrollcontr(borderborid.eq(i)),isok=!1,!1;if(Publicfactory.checkEnCnstrlen(fieldlast.eq(i).find("textarea").val())>200)return alert("请填写该"+leftTitle+"内容长度不能大于100个字！"),scrollcontr(borderborid.eq(i)),isok=!1,!1}return("Money"!=results.field[i].formtype||""==fieldlast.eq(i).find("input").val().YLstringcheck()||reg_num_one.test(fieldlast.eq(i).find("input").val()))&&("NumberComponent"!=results.field[i].formtype||""==fieldlast.eq(i).find("input").val().YLstringcheck()||reg_num_one.test(fieldlast.eq(i).find("input").val()))&&("Mobile"!=results.field[i].formtype||""==fieldlast.eq(i).find("input").val().YLstringcheck()||reg_Mobile.test(fieldlast.eq(i).find("input").val()))&&("Phone"!=results.field[i].formtype||""==fieldlast.eq(i).find("input").val().YLstringcheck()||reg_phones.test(fieldlast.eq(i).find("input").val()))&&("Email"!=results.field[i].formtype||""==fieldlast.eq(i).find("input").val().YLstringcheck()||reg_Emails.test(fieldlast.eq(i).find("input").val()))?void 0:(alert("请填写正确的"+leftTitle),scrollcontr(borderborid.eq(i)),isok=!1,!1)})}return isok},service}),factoryApp.factory("Publicfactory",function(){var service={};return service.Timeintervalcomparison=function(startTime,endTime){if(endTime&&startTime>endTime)return alert("开始必须小于结束时间-或-结束必须大于开始时间！"),!1},service.VerificationInputs=function(str,maxnum,title,isnull){maxnum=""==maxnum?20:maxnum;var name=title;return str=str.replace(/\s/g,""),!str&&0!=isnull||0!=service.checkEnCnstrlen(str)?service.checkEnCnstrlen(str)>maxnum?(alert(name+"长度不能超过"+maxnum/2+"个字符！"),!1):void 0:(alert("请输入"+name+"！"),!1)},service.checkEnCnstrlen=function(str){var realLength=0,len=0,charCode=-1,str=str.replace(/[\r\n]/g,"");len=str.length;for(var i=0;i<len;i++)charCode=str.charCodeAt(i),realLength+=charCode>=0&&charCode<=128?1:2;return realLength},service.VerificationInputNumber=function(str,maxnum,title,isnull){var name=title,check=/^[0-9]*[1-9][0-9]*$/;return!str&&0!=isnull||0!=service.checkEnCnstrlen(str)?check.test(str)?str>100?(alert("请输入小于100的正整数！"),!1):void 0:(alert("请输入1-100的正整数！"),!1):(alert("请输入"+name+"！"),!1)},service}),factoryApp.factory("filtersModel",function($filter){var service={};return service.filterTime=function(datatime){var timedata,dateFilter=$filter("date");return timedata=dateFilter(datatime,"yyyy-MM-dd")},service.filterTimeHHmm=function(datatime){var timedata,dateFilter=$filter("date");return timedata=dateFilter(datatime,"HH:mm")},service.filterTimeHH=function(datatime){var timedata,dateFilter=$filter("date");return timedata=dateFilter(datatime,"HH")},service.filterDateTime=function(datatime){var timedata,dateFilter=$filter("date");return timedata=dateFilter(datatime,"yyyy-MM-dd HH:mm")},service.filterStrDate=function(strDate){return"object"==typeof strDate?strDate:new Date(Date.parse(strDate.replace(/-/g,"/")))},service.filterNowDateTime=function(){var Today_date=new Date,year_date=Today_date.getFullYear(),month_date=Today_date.getMonth()+1,day_date=Today_date.getDate(),hour_date=Today_date.getHours(),minute_date=Today_date.getMinutes();month_date<10?month_date="0"+month_date:month_date,day_date<10?day_date="0"+day_date:day_date,hour_date<10?hour_date="0"+hour_date:hour_date,minute_date<10?minute_date="0"+minute_date:minute_date;var Today_date_s=year_date+"-"+month_date+"-"+day_date;return Today_date_s},service.countTimesdays=function(startTime,endTime){var s1=endTime,s2=startTime;s1=new Date(s1.replace(/-/g,"/")),s2=new Date(s2.replace(/-/g,"/"));var days=s1.getTime()-s2.getTime(),times=parseInt(days/864e5);return times},service}),factoryApp.factory("validate",function(){var service={fileSize:function(file,maxSize,callback){return!(file.size>maxSize)||(alert("上传文件超过指定大小！"),!1)}};return service}),factoryApp.factory("topsearchsize",function(){var service={adjustment:function(){var topsearchbar=$(".applywork .top-search-bar");if(1==topsearchbar.length){var z_bor=parseInt(topsearchbar.css("width")),t_bor=parseInt($(".applywork .top-search-bar > div").css("width")),z_left=(z_bor-t_bor)/2;topsearchbar.find("div:first").css("left",z_left+"px")}}};return service}),factoryApp.factory("infoModel",function($http,$state){var service={};return service.permissionalert=function($scope,data){return data.code!=-5||(alert(data.msg),$state.go("main.index",{},{reload:!0}),!1)},service}),factoryApp.factory("checkBrowsers",function($http,$state){var service={};return service.checkBrowser=function(){var userAgent=navigator.userAgent,isOpera=userAgent.indexOf("Opera")>-1;return isOpera?"Opera":userAgent.indexOf("Firefox")>-1?"FF":userAgent.indexOf("Chrome")>-1?"Chrome":userAgent.indexOf("Safari")>-1?"Safari":userAgent.indexOf("compatible")>-1&&userAgent.indexOf("MSIE")>-1&&!isOpera?"IE":void 0},service}),factoryApp.factory("checkBrowserRedirect",function($http,$state){var service={};return service.checkBrowserRect=function(){var sUserAgent=navigator.userAgent.toLowerCase(),bIsIpad="ipad"==sUserAgent.match(/ipad/i),bIsIphoneOs="iphone os"==sUserAgent.match(/iphone os/i),bIsAndroid=("midp"==sUserAgent.match(/midp/i),"rv:1.2.3.4"==sUserAgent.match(/rv:1.2.3.4/i),"ucweb"==sUserAgent.match(/ucweb/i),"android"==sUserAgent.match(/android/i));"windows ce"==sUserAgent.match(/windows ce/i),"windows mobile"==sUserAgent.match(/windows mobile/i);return bIsIpad||bIsIphoneOs?1:bIsAndroid?2:"PC"},service}),factoryApp.factory("checkModel",function($http){var service={};return service.checkInput=function(formName){var patt=/[^\u4e00-\u9fa5a-zA-Z\d]/g;return formName.replace(/\s/g,""),"undefined"==formName||""==formName?(alert("请输入内容！"),!1):formName.length>15?(alert("不能超过15个字符！"),!1):!formName.match(patt)||(alert("内容只能包含中文、字母和数字"),!1)},service.checkNumber=function(formName,msg){var reg_Number=/\D/g;return formName.replace(/\s/g,""),!formName.match(reg_Number)||(alert(msg),!1)},service.checkMail=function(formName){var patt=/[\w!#$%&'*+\/=?^_`{|}~-]+(?:\.[\w!#$%&'*+\/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/g;return!!formName.match(patt)||(alert("邮箱格式不正确"),!1)},service.checkStrLen=function(str){for(var realLength=0,len=str.length,charCode=-1,i=0;i<len;i++)charCode=str.charCodeAt(i),realLength+=1;return realLength},service}),factoryApp.factory("activeModel",function($http){var service={};return service.openTaskDetail=function($scope){},service.closeTaskDetail=function($scope){},service}),factoryApp.factory("OAInterceptor",function($q,$cookies,$cookieStore,$location){return{request:function(config){return config},response:function(response){return response},responseError:function(response){var data=response.data;return 401==data.status?($cookieStore.remove("userInfo"),$location.path("#/login")):504==data.status?alert("请求超时，请重试！"):alert("请求超时，请重试！"),$q.reject(response)}}}),factoryApp.factory("util",function(){var util={};return util.setImgRand=function(data){return Array.isArray(data)?data.forEach(function(item){item.hasOwnProperty("head_img")&&item.head_img&&(item.head_img+="?"+Date.now()),item.hasOwnProperty("head_img_path")&&item.head_img_path&&(item.head_img_path+="?"+Date.now()),item.hasOwnProperty("headImg")&&item.headImg&&(item.headImg+="?"+Date.now())}):(data.hasOwnProperty("head_img")&&data.head_img&&(data.head_img+="?"+Date.now()),data.hasOwnProperty("head_img_path")&&data.head_img_path&&(data.head_img_path+="?"+Date.now()),data.hasOwnProperty("headImg")&&data.headImg&&(data.headImg+="?"+Date.now())),data},util});
function CheckTextBiaoqing(){var patrns=/(%uD)+/,texts=$('.borderbor[data-widget="Text"]'),TextAreas=$('.borderbor[data-widget="TextArea"]'),DataTables=$('.borderbor[data-widget="DataTable"]');if(texts.length>0)for(var i=0;i<texts.length;i++)if(patrns.test(escape(texts.eq(i).find("input").val())))return alert("不允许输入系统表情"),!1;if(TextAreas.length>0)for(var i=0;i<TextAreas.length;i++)if(patrns.test(escape(TextAreas.eq(i).find("textarea").val())))return alert("不允许输入系统表情"),!1;if(DataTables.length>0)for(var i=0;i<DataTables.length;i++)for(var DataTablesInputs=DataTables.eq(i).find('input[placeholder="文本"]'),j=0;j<DataTablesInputs.length;j++)if(patrns.test(escape(DataTablesInputs.eq(j).val())))return alert("不允许输入系统表情"),!1;return!0}factoryApp.filter("cut",function(){return function(value,wordwise,max,tail){if(!value)return"";if(max=parseInt(max,10),!max)return value;if(value.length<=max)return value;if(value=value.substr(0,max),wordwise){var lastspace=value.lastIndexOf(" ");lastspace!=-1&&(value=value.substr(0,lastspace))}return value+(tail||" ¡­")}});
var commonMod=angular.module("commonMod",[]);commonMod.directive("departDialog",function($timeout,$http){return{restrict:"E",replace:!0,transclude:!0,scope:{selectedDeparts:"=",visble:"=",updateDeparts:"&",single:"@"},link:function(scope,element,attrs){function fetchDeparts(keyword){$http.post("/index.php?r=attendance/attendance/org-info",{search_org_name:keyword}).success(function(ret){1===ret.code&&(scope.departs=ret.data.map(function(v){var departSelected=!1;return _.some(scope.selectedDeparts,{value:v.org_id})&&(departSelected=!0),{value:v.org_id,label:v.org_name,selected:departSelected}}))})}scope.keyword="",scope.search=function(){$timeout(function(){fetchDeparts(scope.keyword?scope.keyword:"")},500)},scope.departs=[],scope.selectedDeparts=scope.selectedDeparts||[],scope.selectDepart=function(depart,index){depart.selected=!depart.selected,scope.departs[index]=depart,depart.selected?scope.selectedDeparts.push(depart):scope.selectedDeparts.forEach(function(item,i){if(item.value==depart.value)return void scope.selectedDeparts.splice(i,1)})},scope.$watch("selectedDeparts",function(newValue,oldValue){_.map(scope.departs,function(v){var departSelected=!1;return _.some(newValue,{value:v.value})&&(departSelected=!0),v.selected=departSelected,v}),scope.updateDeparts({departs:newValue})}),scope.submit=function(){scope.visble=!1},scope.cancel=function(){scope.visble=!1},fetchDeparts("")},templateUrl:"appnews/modules/common/dialog/depart_dialog.html"}}),commonMod.directive("departCombo",function($http,$timeout){return{restrict:"E",replace:!0,templateUrl:"appnews/modules/common/dialog/depart_combo.html",scope:{handleSelect:"&",depart:"="},link:function(scope,elment,attrs){function fetchDeparts(keyword){$http.post("/index.php?r=attendance/attendance/org-info",{search_org_name:keyword}).success(function(ret){1===ret.code&&(scope.departs=ret.data.map(function(v){var departSelected=!1;return _.some(scope.selectedDeparts,{value:v.org_id})&&(departSelected=!0),{value:v.org_id,label:v.org_name,selected:departSelected}}))})}scope.keyword="",scope.search=function(){$timeout(function(){fetchDeparts(scope.keyword?scope.keyword:"")},500)},scope.departs=[],scope.$watch("depart",function(){scope.selectedDepart=scope.depart}),scope.selectDepart=function(depart,index){_.map(scope.departs,function(v){return v.selected=!1,v}),depart.selected=!depart.selected,scope.departs[index]=depart,scope.selectedDepart=depart,scope.handleSelect({depart:depart}),$(".visible1").css("display","none")},scope.toggle=function($event){var div=$($event.target).parent().next();$(".visible2").css("display","none"),div.toggle(),scope.keyword="",fetchDeparts(scope.keyword)},fetchDeparts(""),angular.element(document).bind("click",function(e){setTimeout(function(){scope.$apply(function(){0==angular.element(e.target).parents(".depart-combo").length&&($(".visible1").css("display","none"),$(".visible2").css("display","none"))})})}),$(".selecttimebor").bind("click",function(e){setTimeout(function(){scope.$apply(function(){$(".visible1").css("display","none"),$(".visible2").css("display","none")})})})}}}),commonMod.directive("memberDialog",function($http,$timeout){return{restrict:"E",replace:!0,scope:{selectedMembers:"=",visble:"=",single:"=",updateMembers:"&",cancelAttr:"&cancelAttr",supervisor:"="},link:function(scope,element,attrs){scope.keyword="",scope.search=function(){$timeout(function(){scope.keyword&&$http.post("index.php?r=attendance/attendance/member-info",{search_real_name:scope.keyword}).success(function(ret){1===ret.code&&(scope.members=ret.data.map(function(v){return{value:v.u_id,label:v.real_name,avatar:v.head_img}}),scope.supervisor&&scope.members.unshift({value:"-1",label:"直属上级",avatar:"/static/head-img/defaultHead.png"}),_.map(scope.members,function(member){return _.some(scope.selectedMembers,{value:member.value})&&(member.selected=!0),member}))})},500)},scope.selectedMembers=scope.selectedMembers||[],_.map(scope.members,function(member){return _.some(scope.selectedMembers,{value:member.value})&&(member.selected=!0),member}),scope.$watch("visble",function(newValue,oldValue){newValue&&(scope.members=scope.supervisor?[{value:"-1",label:"直属上级",avatar:"/static/head-img/defaultHead.png"}]:[])}),scope.selectMember=function(member,index){scope.single&&_.some(scope.members,{selected:!0})||member.selected||(member.selected=!0,scope.members[index]=member,scope.supervisor?scope.selectedMembers=_.filter(scope.members,{selected:!0}):scope.selectedMembers.push(member))};var cancelAttr=scope.cancelAttr();scope.cancel=function(){_.isFunction(cancelAttr)&&cancelAttr(),scope.members=[{value:"-1",label:"直属上级",avatar:"/static/head-img/defaultHead.png"}],scope.keyword="",scope.visble=!1}},controller:function($scope){$scope.$watch("selectedMembers",function(newValue,oldValue){_.map($scope.members,function(member){return _.some(newValue,{value:member.value})?member.selected=!0:member.selected=!1,member}),$scope.updateMembers({members:newValue})})},template:'<div class="memPartPop pfixed"><div class="memPartPop-header"><span>人员选择</span><i class="iconMemPart" ng-click="cancel()">&#xe603;</i></div><div class="memPartPop-search"><i class="iconMemPart">&#xe612;</i><input type="text" ng-model="keyword" placeholder="搜索" ng-change="search()"/></div><div class="memPartPop-data mem-data"><ul><li ng-repeat="item in members"><img ng-src="{{item.avatar}}" alt="" class="memHead-img"/><span>{{item.label}}</span><span class="fr addPrin-btn" ng-click="selectMember(item,$index)">{{item.selected?"已添加":"添加"}}</span></li></ul></div></div>'}}),commonMod.directive("departDialogForm",function($timeout,$http){return{restrict:"E",replace:!0,transclude:!0,scope:{selectedDeparts:"=",visble:"=",updateDeparts:"&",cancelAttr:"&cancelAttr"},link:function(scope,element,attrs){function fetchDeparts(keyword){$http.post("/index.php?r=attendance/attendance/org-info",{search_org_name:keyword}).success(function(ret){1===ret.code&&(scope.departs=ret.data.map(function(v){return{value:v.org_id,label:v.org_name}}))})}scope.keyword="",scope.search=function(){$timeout(function(){scope.keyword&&fetchDeparts(scope.keyword)},700)},fetchDeparts(""),scope.departs=[],scope.selectedDeparts=scope.selectedDeparts||[],scope.selectDepart=function(depart){scope.selectedDeparts.indexOf(depart)==-1&&scope.selectedDeparts.push(depart)},scope.$watch("selectedDeparts",function(newValue,oldValue){scope.updateDeparts({departs:newValue})}),scope.submit=function(){scope.visble=!1};var cancelAttr=scope.cancelAttr();scope.cancel=function(){scope.visble=!1,scope.keyword="",$("#masklayer2").is(":hidden")?$("#masklayer1").hide():$("#masklayer2").hide(),scope.selectedDeparts=[]},scope.submit=function(){scope.visble=!1,cancelAttr(),scope.selectedDeparts=[],scope.departs=[],scope.keyword=""},scope.close=function(){scope.visble=!1,scope.keyword="",$("#masklayer2").is(":hidden")?$("#masklayer1").hide():$("#masklayer2").hide(),scope.selectedDeparts=[]}},template:'<div class="memPartPop pfixed apply-member-pop"><div class="memPartPop-header"><span>部门选择</span><i class="iconMemPart" ng-click="cancel()">&#xe603;</i></div><div ng-transclude></div><div class="memPartPop-search"><i class="iconMemPart">&#xe612;</i><input type="text" placeholder="搜索" ng-model="keyword" ng-change="search()"/></div><div class="memPartPop-data"><ul><li ng-repeat="item in departs"><input type="checkbox" name="part" ng-click="selectDepart(item)" ng-checked="selectedDeparts[0].value==item.value" class="chbStyle"/><span>{{item.label}}</span></li></ul></div><div class="memPartPop-bottom"><button class="btns blue" ng-click="submit()">确定</button><button class="btns gray ml20" ng-click="close()">取消</button></div></div>'}}),commonMod.directive("memberCombo",function($http,$timeout){return{restrict:"E",replace:!0,scope:{handleSelect:"&",member:"=",depart:"="},link:function(scope,element,attrs){function fetchMembers(keyword){$http.post("index.php?r=attendance/attendance/member-info",{search_real_name:scope.keyword,search_org_id:scope.depart}).success(function(ret){1===ret.code&&(ret.data.unshift({head_img:"/static/head-img/defaultHead.png",real_name:"全部",u_id:0}),scope.members=ret.data.map(function(v){return{value:v.u_id,label:v.real_name,avatar:v.head_img,selected:!1}}),scope.supervisor&&scope.members.unshift({value:"-1",label:"直属上级",avatar:"/static/head-img/defaultHead.png"}))})}scope.$watch("depart",function(newValue,oldValue){void 0!==newValue&&newValue!==oldValue&&(fetchMembers("",newValue),scope.selectedMember=null)}),scope.keyword="",scope.search=function(){$timeout(function(){scope.keyword?fetchMembers(scope.keyword,""):fetchMembers("","")},700)},scope.members=[],scope.visble=!1,scope.selectedMember=scope.member||null,scope.selectMember=function(member,index){_.map(scope.members,function(v){return v.selected=!1,v}),member.selected=!0,scope.members[index]=member,scope.selectedMember=member,scope.handleSelect({member:member}),$(".visible2").css("display","none")},scope.toggle=function($event){var div=$($event.target).parent().next();$(".visible1").css("display","none"),div.toggle(),scope.keyword="",fetchMembers(scope.keyword)},fetchMembers("","")},templateUrl:"appnews/modules/common/dialog/member_combo.html"}}),commonMod.directive("cascadeMember",function(){return{restrict:"E",replace:!0,scope:{handleDepartSelect:"&",handleMemberSelect:"&"},templateUrl:"appnews/modules/common/dialog/cascade_combo.html",link:function(scope,element,attrs){scope.depart=scope.depart||{},scope.member=scope.member||{},scope.selectMember=function(member){scope.handleMemberSelect({member:member})},scope.selectDepart=function(depart){scope.departId=depart.value,scope.handleDepartSelect({depart:depart})}}}});
!function(e,t){function i(t,i){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,!(!t.href||!a||"map"!==n.nodeName.toLowerCase())&&(o=e("img[usemap=#"+a+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||i:i)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var n=0,a=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var s,n,a=e(this[0]);a.length&&a[0]!==document;){if(s=a.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(n=parseInt(a.css("zIndex"),10),!isNaN(n)&&0!==n))return n;a=a.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){a.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var s=e.attr(t,"tabindex"),n=isNaN(s);return(n||s>=0)&&i(t,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,s){function n(t,i,s,n){return e.each(a,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),n&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var a="Width"===s?["Left","Right"]:["Top","Bottom"],o=s.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+s]=function(i){return i===t?r["inner"+s].call(this):this.each(function(){e(this).css(o,n(this,i)+"px")})},e.fn["outer"+s]=function(t,i){return"number"!=typeof t?r["outer"+s].call(this,t):this.each(function(){e(this).css(o,n(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i){var s,n=e.plugins[t];if(n&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(s=0;n.length>s;s++)e.options[n[s][0]]&&n[s][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0||(t[s]=1,n=t[s]>0,t[s]=0,n)}})}(jQuery),function(t,e){var i=0,s=Array.prototype.slice,n=t.cleanData;t.cleanData=function(e){for(var i,s=0;null!=(i=e[s]);s++)try{t(i).triggerHandler("remove")}catch(a){}n(e)},t.widget=function(i,s,n){var a,o,r,h,l={},u=i.split(".")[0];i=i.split(".")[1],a=u+"-"+i,n||(n=s,s=t.Widget),t.expr[":"][a.toLowerCase()]=function(e){return!!t.data(e,a)},t[u]=t[u]||{},o=t[u][i],r=t[u][i]=function(t,i){return this._createWidget?(arguments.length&&this._createWidget(t,i),e):new r(t,i)},t.extend(r,o,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),h=new s,h.options=t.widget.extend({},h.options),t.each(n,function(i,n){return t.isFunction(n)?(l[i]=function(){var t=function(){return s.prototype[i].apply(this,arguments)},e=function(t){return s.prototype[i].apply(this,t)};return function(){var i,s=this._super,a=this._superApply;return this._super=t,this._superApply=e,i=n.apply(this,arguments),this._super=s,this._superApply=a,i}}(),e):(l[i]=n,e)}),r.prototype=t.widget.extend(h,{widgetEventPrefix:o?h.widgetEventPrefix||i:i},l,{constructor:r,namespace:u,widgetName:i,widgetFullName:a}),o?(t.each(o._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,r,i._proto)}),delete o._childConstructors):s._childConstructors.push(r),t.widget.bridge(i,r)},t.widget.extend=function(i){for(var n,a,o=s.call(arguments,1),r=0,h=o.length;h>r;r++)for(n in o[r])a=o[r][n],o[r].hasOwnProperty(n)&&a!==e&&(i[n]=t.isPlainObject(a)?t.isPlainObject(i[n])?t.widget.extend({},i[n],a):t.widget.extend({},a):a);return i},t.widget.bridge=function(i,n){var a=n.prototype.widgetFullName||i;t.fn[i]=function(o){var r="string"==typeof o,h=s.call(arguments,1),l=this;return o=!r&&h.length?t.widget.extend.apply(null,[o].concat(h)):o,r?this.each(function(){var s,n=t.data(this,a);return n?t.isFunction(n[o])&&"_"!==o.charAt(0)?(s=n[o].apply(n,h),s!==n&&s!==e?(l=s&&s.jquery?l.pushStack(s.get()):s,!1):e):t.error("no such method '"+o+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var e=t.data(this,a);e?e.option(o||{})._init():t.data(this,a,new n(o,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,s){s=t(s||this.defaultElement||this)[0],this.element=t(s),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),s!==this&&(t.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===s&&this.destroy()}}),this.document=t(s.style?s.ownerDocument:s.document||s),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,s){var n,a,o,r=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(r={},n=i.split("."),i=n.shift(),n.length){for(a=r[i]=t.widget.extend({},this.options[i]),o=0;n.length-1>o;o++)a[n[o]]=a[n[o]]||{},a=a[n[o]];if(i=n.pop(),1===arguments.length)return a[i]===e?null:a[i];a[i]=s}else{if(1===arguments.length)return this.options[i]===e?null:this.options[i];r[i]=s}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(i,s,n){var a,o=this;"boolean"!=typeof i&&(n=s,s=i,i=!1),n?(s=a=t(s),this.bindings=this.bindings.add(s)):(n=s,s=this.element,a=this.widget()),t.each(n,function(n,r){function h(){return i||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof r?o[r]:r).apply(o,arguments):e}"string"!=typeof r&&(h.guid=r.guid=r.guid||h.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),u=l[1]+o.eventNamespace,c=l[2];c?a.delegate(c,u,h):s.bind(u,h)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var n,a,o=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(t.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),o=!t.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){t(this)[e](),a&&a.call(s[0]),i()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,a=!("string"!=typeof this.options.cancel||!i.target.nodeName)&&e(i.target).closest(this.options.cancel).length;return!(n&&!a&&this._mouseCapture(i))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return s._mouseMove(e)},this._mouseUpDelegate=function(e){return s._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0))}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function i(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function s(t,i){return parseInt(e.css(t,i),10)||0}function n(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(a!==t)return a;var i,s,n=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=n.children()[0];return e("body").append(n),i=o.offsetWidth,n.css("overflow","scroll"),s=o.offsetWidth,i===s&&(s=n[0].clientWidth),n.remove(),a=i-s},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s?i.width():i.outerWidth(),height:s?i.height():i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var a,p,m,g,v,_,b=e(t.of),y=e.position.getWithinInfo(t.within),x=e.position.getScrollInfo(y),w=(t.collision||"flip").split(" "),k={};return _=n(b),b[0].preventDefault&&(t.at="left top"),p=_.width,m=_.height,g=_.offset,v=e.extend({},g),e.each(["my","at"],function(){var e,i,s=(t[this]||"").split(" ");1===s.length&&(s=l.test(s[0])?s.concat(["center"]):u.test(s[0])?["center"].concat(s):["center","center"]),s[0]=l.test(s[0])?s[0]:"center",s[1]=u.test(s[1])?s[1]:"center",e=c.exec(s[0]),i=c.exec(s[1]),k[this]=[e?e[0]:0,i?i[0]:0],t[this]=[d.exec(s[0])[0],d.exec(s[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===t.at[0]?v.left+=p:"center"===t.at[0]&&(v.left+=p/2),"bottom"===t.at[1]?v.top+=m:"center"===t.at[1]&&(v.top+=m/2),a=i(k.at,p,m),v.left+=a[0],v.top+=a[1],this.each(function(){var n,l,u=e(this),c=u.outerWidth(),d=u.outerHeight(),f=s(this,"marginLeft"),_=s(this,"marginTop"),D=c+f+s(this,"marginRight")+x.width,T=d+_+s(this,"marginBottom")+x.height,C=e.extend({},v),M=i(k.my,u.outerWidth(),u.outerHeight());"right"===t.my[0]?C.left-=c:"center"===t.my[0]&&(C.left-=c/2),"bottom"===t.my[1]?C.top-=d:"center"===t.my[1]&&(C.top-=d/2),C.left+=M[0],C.top+=M[1],e.support.offsetFractions||(C.left=h(C.left),C.top=h(C.top)),n={marginLeft:f,marginTop:_},e.each(["left","top"],function(i,s){e.ui.position[w[i]]&&e.ui.position[w[i]][s](C,{targetWidth:p,targetHeight:m,elemWidth:c,elemHeight:d,collisionPosition:n,collisionWidth:D,collisionHeight:T,offset:[a[0]+M[0],a[1]+M[1]],my:t.my,at:t.at,within:y,elem:u})}),t.using&&(l=function(e){var i=g.left-C.left,s=i+p-c,n=g.top-C.top,a=n+m-d,h={target:{element:b,left:g.left,top:g.top,width:p,height:m},element:{element:u,left:C.left,top:C.top,width:c,height:d},horizontal:0>s?"left":i>0?"right":"center",vertical:0>a?"top":n>0?"bottom":"middle"};c>p&&p>r(i+s)&&(h.horizontal="center"),d>m&&m>r(n+a)&&(h.vertical="middle"),h.important=o(r(i),r(s))>o(r(n),r(a))?"horizontal":"vertical",t.using.call(this,e,h)}),u.offset(e.extend(C,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,c=l+t.collisionWidth-o-h,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+d+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=d+p+f)):c>0&&(s=e.left-t.collisionPosition.marginLeft+d+p+f-h,(s>0||c>r(s))&&(e.left+=d+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,c=l+t.collisionHeight-o-h,d="top"===t.my[1],p=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,e.top+p+f+m>u&&(0>s||r(u)>s)&&(e.top+=p+f+m)):c>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,e.top+p+f+m>c&&(i>0||c>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,a,o=document.getElementsByTagName("body")[0],r=document.createElement("div");t=document.createElement(o?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in s)t.style[a]=s[a];t.appendChild(r),i=o||document.documentElement,i.insertBefore(t,i.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",n=e(r).offset().left,e.support.offsetFractions=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;return!(this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0))},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),!("original"===this.options.helper&&!e.contains(this.element[0].ownerDocument,this.element[0]))&&("invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1)},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;return n.containment?"window"===n.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],void(s&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i))):void(this.containment=null)},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:n.scrollTop(),left:n.scrollLeft()}),{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*s}},_generatePosition:function(t){var i,s,n,a,o=this.options,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=t.pageX,l=t.pageY;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(s=this.relative_container.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var s=e(this).data("ui-draggable"),n=s.options,a=e.extend({},i,{item:s.element});s.sortables=[],e(n.connectToSortable).each(function(){var i=e.data(this,"ui-sortable");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,a))})},stop:function(t,i){var s=e(this).data("ui-draggable"),n=e.extend({},i,{item:s.element});e.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,n))})},drag:function(t,i){var s=e(this).data("ui-draggable"),n=this;e.each(s.sortables,function(){var a=!1,o=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(a=!0,e.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(a=!1),a})),a?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,
this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",t),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",t),s.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("ui-draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor")),t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i){var s=e(i.helper),n=e(this).data("ui-draggable").options;s.css("opacity")&&(n._opacity=s.css("opacity")),s.css("opacity",n.opacity)},stop:function(t,i){var s=e(this).data("ui-draggable").options;s._opacity&&e(i.helper).css("opacity",s._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var i=e(this).data("ui-draggable"),s=i.options,n=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(s.axis&&"x"===s.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<s.scrollSensitivity?i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop+s.scrollSpeed:t.pageY-i.overflowOffset.top<s.scrollSensitivity&&(i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop-s.scrollSpeed)),s.axis&&"y"===s.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<s.scrollSensitivity?i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft+s.scrollSpeed:t.pageX-i.overflowOffset.left<s.scrollSensitivity&&(i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft-s.scrollSpeed))):(s.axis&&"x"===s.axis||(t.pageY-e(document).scrollTop()<s.scrollSensitivity?n=e(document).scrollTop(e(document).scrollTop()-s.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<s.scrollSensitivity&&(n=e(document).scrollTop(e(document).scrollTop()+s.scrollSpeed))),s.axis&&"y"===s.axis||(t.pageX-e(document).scrollLeft()<s.scrollSensitivity?n=e(document).scrollLeft(e(document).scrollLeft()-s.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<s.scrollSensitivity&&(n=e(document).scrollLeft(e(document).scrollLeft()+s.scrollSpeed)))),n!==!1&&e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),i=t.options;t.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=e(this),s=i.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:s.top,left:s.left})})},drag:function(t,i){var s,n,a,o,r,h,l,u,d,c,p=e(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=i.offset.left,v=g+p.helperProportions.width,_=i.offset.top,b=_+p.helperProportions.height;for(d=p.snapElements.length-1;d>=0;d--)r=p.snapElements[d].left,h=r+p.snapElements[d].width,l=p.snapElements[d].top,u=l+p.snapElements[d].height,r-m>v||g>h+m||l-m>b||_>u+m||!e.contains(p.snapElements[d].item.ownerDocument,p.snapElements[d].item)?(p.snapElements[d].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(s=m>=Math.abs(l-b),n=m>=Math.abs(u-_),a=m>=Math.abs(r-v),o=m>=Math.abs(h-g),s&&(i.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r-p.helperProportions.width}).left-p.margins.left),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:h}).left-p.margins.left)),c=s||n||a||o,"outer"!==f.snapMode&&(s=m>=Math.abs(l-_),n=m>=Math.abs(u-b),a=m>=Math.abs(r-g),o=m>=Math.abs(h-v),s&&(i.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r}).left-p.margins.left),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:h-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[d].snapping&&(s||n||a||o||c)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=s||n||a||o||c)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,i=this.data("ui-draggable").options,s=e.makeArray(e(i.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});s.length&&(t=parseInt(e(s[0]).css("zIndex"),10)||0,e(s).each(function(i){e(this).css("zIndex",t+i)}),this.css("zIndex",t+s.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i){var s=e(i.helper),n=e(this).data("ui-draggable").options;s.css("zIndex")&&(n._zIndex=s.css("zIndex")),s.css("zIndex",n.zIndex)},stop:function(t,i){var s=e(this).data("ui-draggable").options;s._zIndex&&e(i.helper).css("zIndex",s._zIndex)}})}(jQuery),function(e){function t(e,t,i){return e>t&&t+i>e}e.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},e.ui.ddmanager.droppables[i.scope]=e.ui.ddmanager.droppables[i.scope]||[],e.ui.ddmanager.droppables[i.scope].push(this),i.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,i=e.ui.ddmanager.droppables[this.options.scope];i.length>t;t++)i[t]===this&&i.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){"accept"===t&&(this.accept=e.isFunction(i)?i:function(e){return e.is(i)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return!(!s||(s.currentItem||s.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope===s.options.scope&&t.accept.call(t.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(n=!0,!1):void 0}),!n&&(!!this.accept.call(this.element[0],s.currentItem||s.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,i,s){if(!i.offset)return!1;var n,a,o=(e.positionAbs||e.position.absolute).left,r=(e.positionAbs||e.position.absolute).top,h=o+e.helperProportions.width,l=r+e.helperProportions.height,u=i.offset.left,c=i.offset.top,d=u+i.proportions().width,p=c+i.proportions().height;switch(s){case"fit":return o>=u&&d>=h&&r>=c&&p>=l;case"intersect":return o+e.helperProportions.width/2>u&&d>h-e.helperProportions.width/2&&r+e.helperProportions.height/2>c&&p>l-e.helperProportions.height/2;case"pointer":return n=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,a=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,t(a,c,i.proportions().height)&&t(n,u,i.proportions().width);case"touch":return(r>=c&&p>=r||l>=c&&p>=l||c>r&&l>p)&&(o>=u&&d>=o||h>=u&&d>=h||u>o&&h>d);default:return!1}},e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===n}),a.length&&(s=e.data(a[0],"ui-droppable"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}}}(jQuery),function(e){function t(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=e(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(i){var s,n,a,o=this.options,r=this.element.position(),h=this.element;return this.resizing=!0,/absolute/.test(h.css("position"))?h.css({position:"absolute",top:h.css("top"),left:h.css("left")}):h.is(".ui-draggable")&&h.css({position:"absolute",top:r.top,left:r.left}),this._renderProxy(),s=t(this.helper.css("left")),n=t(this.helper.css("top")),o.containment&&(s+=e(o.containment).scrollLeft()||0,n+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:s,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:h.width(),height:h.height()},this.originalSize=this._helper?{width:h.outerWidth(),height:h.outerHeight()}:{width:h.width(),height:h.height()},this.originalPosition={left:s,top:n},this.sizeDiff={width:h.outerWidth()-h.width(),height:h.outerHeight()-h.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,a=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===a?this.axis+"-resize":a),h.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(t){var i,s=this.helper,n={},a=this.originalMousePosition,o=this.axis,r=this.position.top,h=this.position.left,l=this.size.width,u=this.size.height,c=t.pageX-a.left||0,d=t.pageY-a.top||0,p=this._change[o];return!!p&&(i=p.apply(this,[t,c,d]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),this.position.top!==r&&(n.top=this.position.top+"px"),this.position.left!==h&&(n.left=this.position.left+"px"),this.size.width!==l&&(n.width=this.size.width+"px"),this.size.height!==u&&(n.height=this.size.height+"px"),s.css(n),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(n)||this._trigger("resize",t,this.ui()),!1)},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&e.ui.hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,s,n,a,o,r=this.options;o={minWidth:i(r.minWidth)?r.minWidth:0,maxWidth:i(r.maxWidth)?r.maxWidth:1/0,minHeight:i(r.minHeight)?r.minHeight:0,maxHeight:i(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,n=o.minWidth/this.aspectRatio,s=o.maxHeight*this.aspectRatio,a=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),n>o.minHeight&&(o.minHeight=n),o.maxWidth>s&&(o.maxWidth=s),o.maxHeight>a&&(o.maxHeight=a)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,s=this.size,n=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(s.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(s.height-e.height),e.left=t.left+(s.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,s=this.axis,n=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,a=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=i(e.width)&&t.minWidth&&t.minWidth>e.width,r=i(e.height)&&t.minHeight&&t.minHeight>e.height,h=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,u=/sw|nw|w/.test(s),c=/nw|ne|n/.test(s);return o&&(e.width=t.minWidth),r&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),a&&(e.height=t.maxHeight),o&&u&&(e.left=h-t.minWidth),n&&u&&(e.left=h-t.maxWidth),r&&c&&(e.top=l-t.minHeight),a&&c&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,s,n,a=this.helper||this.element;for(e=0;this._proportionallyResizeElements.length>e;e++){if(n=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],i=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")],s=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")],t=0;i.length>t;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(s[t],10)||0);n.css({height:a.height()-this.borderDif[0]-this.borderDif[2]||0,width:a.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).data("ui-resizable"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&e.ui.hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var i,s,n,a,o,r,h,l=e(this).data("ui-resizable"),u=l.options,c=l.element,d=u.containment,p=d instanceof e?d.get(0):/parent/.test(d)?c.parent().get(0):d;p&&(l.containerElement=e(p),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(i=e(p),s=[],e(["Top","Right","Left","Bottom"]).each(function(e,n){s[e]=t(i.css("padding"+n))}),l.containerOffset=i.offset(),l.containerPosition=i.position(),l.containerSize={height:i.innerHeight()-s[3],width:i.innerWidth()-s[1]},n=l.containerOffset,a=l.containerSize.height,o=l.containerSize.width,r=e.ui.hasScroll(p,"left")?p.scrollWidth:o,h=e.ui.hasScroll(p)?p.scrollHeight:a,l.parentData={element:p,left:n.left,top:n.top,width:r,height:h}))},resize:function(t){var i,s,n,a,o=e(this).data("ui-resizable"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,c={top:0,left:0},d=o.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(c=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-c.left),u&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?h.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,i=Math.abs((o._helper?o.offset.left-c.left:o.offset.left-c.left)+o.sizeDiff.width),s=Math.abs((o._helper?o.offset.top-c.top:o.offset.top-h.top)+o.sizeDiff.height),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a&&(i-=Math.abs(o.parentData.left)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,s=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)})},resize:function(t,i){var s=e(this).data("ui-resizable"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0},h=function(t,s){e(t).each(function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),a={},o=s&&s.length?s:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var i=(n[t]||0)+(r[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):e.each(n.alsoResize,function(e,t){h(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),i=t.options,s=t.size,n=t.originalSize,a=t.originalPosition,o=t.axis,r="number"==typeof i.grid?[i.grid,i.grid]:i.grid,h=r[0]||1,l=r[1]||1,u=Math.round((s.width-n.width)/h)*h,c=Math.round((s.height-n.height)/l)*l,d=n.width+u,p=n.height+c,f=i.maxWidth&&d>i.maxWidth,m=i.maxHeight&&p>i.maxHeight,g=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=r,g&&(d+=h),v&&(p+=l),f&&(d-=h),m&&(p-=l),/^(se|s|e)$/.test(o)?(t.size.width=d,t.size.height=p):/^(ne)$/.test(o)?(t.size.width=d,t.size.height=p,t.position.top=a.top-c):/^(sw)$/.test(o)?(t.size.width=d,t.size.height=p,t.position.left=a.left-u):(p-l>0?(t.size.height=p,t.position.top=a.top-c):(t.size.height=l,t.position.top=a.top+n.height-l),d-h>0?(t.size.width=d,t.position.left=a.left-u):(t.size.width=h,t.position.left=a.left+n.width-h))}})}(jQuery),function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{
unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(t){function e(t,e,i){return t>e&&e+i>t}function i(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}t.widget("ui.sortable",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===t.axis||i(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var s=null,n=!1,a=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,a.widgetName+"-item")===a?(s=t(this),!1):void 0}),t.data(e.target,a.widgetName+"-item")===a&&(s=t(e.target)),!!s&&(!(this.options.handle&&!i&&(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),!n))&&(this.currentItem=s,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-t(document).scrollTop()<o.scrollSensitivity?r=t(document).scrollTop(t(document).scrollTop()-o.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<o.scrollSensitivity&&(r=t(document).scrollTop(t(document).scrollTop()+o.scrollSpeed)),e.pageX-t(document).scrollLeft()<o.scrollSensitivity?r=t(document).scrollLeft(t(document).scrollLeft()-o.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<o.scrollSensitivity&&(r=t(document).scrollLeft(t(document).scrollLeft()+o.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"!==this.options.type||!t.contains(this.element[0],n))){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=t.left,o=a+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,u=this.offset.click.left,c="x"===this.options.axis||s+l>r&&h>s+l,d="y"===this.options.axis||e+u>a&&o>e+u,p=c&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var i="x"===this.options.axis||e(this.positionAbs.top+this.offset.click.top,t.top,t.height),s="y"===this.options.axis||e(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=i&&s,a=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return!!n&&(this.floating?o&&"right"===o||"down"===a?2:1:a&&("down"===a?2:1))},_intersectsWithSides:function(t){var i=e(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),s=e(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return this.floating&&a?"right"===a&&s||"left"===a&&!s:n&&("down"===n&&i||"up"===n&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&e)for(s=l.length-1;s>=0;s--)for(a=t(l[s]),n=a.length-1;n>=0;n--)o=t.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,c=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i]),s=n.length-1;s>=0;s--)a=t.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(c.push([t.isFunction(a.options.items)?a.options.items.call(a.element[0],e,{item:this.currentItem}):t(a.options.items,a.element),a]),this.containers.push(a));for(i=c.length-1;i>=0;i--)for(o=c[i][1],r=c[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===s?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)}):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_contactContainers:function(s){var n,a,o,r,h,l,u,c,d,p,f=null,m=null;for(n=this.containers.length-1;n>=0;n--)if(!t.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(f&&t.contains(this.containers[n].element[0],f.element[0]))continue;f=this.containers[n],m=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",s,this._uiHash(this)),this.containers[n].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",s,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(o=1e4,r=null,p=f.floating||i(this.currentItem),h=p?"left":"top",l=p?"width":"height",u=this.positionAbs[h]+this.offset.click[h],a=this.items.length-1;a>=0;a--)t.contains(this.containers[m].element[0],this.items[a].item[0])&&this.items[a].item[0]!==this.currentItem[0]&&(!p||e(this.positionAbs.top+this.offset.click.top,this.items[a].top,this.items[a].height))&&(c=this.items[a].item.offset()[h],d=!1,Math.abs(c-u)>Math.abs(c+this.items[a][l]-u)&&(d=!0,c+=this.items[a][l]),o>Math.abs(c-u)&&(o=Math.abs(c-u),r=this.items[a],this.direction=d?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;r?this._rearrange(s,r,null,!0):this._rearrange(s,null,this.containers[m].element,!0),this._trigger("change",s,this._uiHash()),this.containers[m]._trigger("change",s,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",s,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,a=e.pageX,o=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}(jQuery),function(e){var t=0,i={},s={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",s.height=s.paddingTop=s.paddingBottom=s.borderTopWidth=s.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.10.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e(),content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,s=this.options,n=s.heightStyle,a=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++t);this.active=this._findActive(s.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var i=e(this),s=i.attr("id"),n=i.next(),a=n.attr("id");s||(s=o+"-header-"+t,i.attr("id",s)),a||(a=o+"-panel-"+t,n.attr("id",a)),i.attr("aria-controls",a),n.attr("aria-labelledby",s)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(s.event),"fill"===n?(i=a.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.headers.each(function(){i-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===n&&(i=0,this.headers.next().each(function(){i=Math.max(i,e(this).css("height","").height())}).height(i))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=!o&&this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr("aria-selected","false"),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),
i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,n){var a,o,r,h=this,l=0,u=e.length&&(!t.length||e.index()<t.index()),d=this.options.animate||{},c=u&&d.down||d,p=function(){h._toggleComplete(n)};return"number"==typeof c&&(r=c),"string"==typeof c&&(o=c),o=o||c.easing||d.easing,r=r||c.duration||d.duration,t.length?e.length?(a=e.show().outerHeight(),t.animate(i,{duration:r,easing:o,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(s,{duration:r,easing:o,complete:p,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?l+=i.now:"content"!==h.options.heightStyle&&(i.now=Math.round(a-t.outerHeight()-l),l=0)}})):t.animate(i,r,o,p):e.animate(s,r,o,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e){e.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=!!a||!o&&this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,void(i=!0);t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case a.UP:t=!0,this._keyEvent("previous",n);break;case a.DOWN:t=!0,this._keyEvent("next",n);break;case a.ENTER:case a.NUMPAD_ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault());if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var s=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:s})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(s.value):this.liveRegion.text(s.value)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").append(e("<a>").text(i.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e){var t,i="ui-button ui-widget ui-state-default ui-corner-all",s="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",n=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},a=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?e(s).find("[name='"+i+"']"):e("[name='"+i+"']",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,n),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var s=this,o=this.options,r="checkbox"===this.type||"radio"===this.type,h=r?"":"ui-state-active";null===o.label&&(o.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(i).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){o.disabled||this===t&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){o.disabled||e(this).removeClass(h)}).bind("click"+this.eventNamespace,function(e){o.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),r&&this.element.bind("change"+this.eventNamespace,function(){s.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return!o.disabled&&void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(o.disabled)return!1;e(this).addClass("ui-state-active"),s.buttonElement.attr("aria-pressed","true");var t=s.element[0];a(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!o.disabled&&(e(this).addClass("ui-state-active"),t=this,void s.document.one("mouseup",function(){t=null}))}).bind("mouseup"+this.eventNamespace,function(){return!o.disabled&&void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return!o.disabled&&void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",o.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(i+" ui-state-active "+s).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.element.prop("disabled",!!t),void(t&&this.buttonElement.removeClass("ui-state-focus"))):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?a(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(s),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),n=this.options.icons,a=n.primary&&n.secondary,o=[];n.primary||n.secondary?(this.options.text&&o.push("ui-button-text-icon"+(a?"s":n.primary?"-primary":"-secondary")),n.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(o.push(a?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):o.push("ui-button-text-only"),t.addClass(o.join(" "))}}),e.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=s(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){e.datepicker._isDisabledDatepicker(a.inline?t.parent()[0]:a.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function n(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}e.extend(e.ui,{datepicker:{version:"1.10.4"}});var a,o="datepicker";e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return n(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var n=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?s(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,o,i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,o,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,a,r){var h,l,u,d,c,p=this._dialogInst;return p||(this.uuid+=1,h="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+h+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],o,p)),n(p.settings,a||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(l=document.documentElement.clientWidth,u=document.documentElement.clientHeight,d=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+d,u/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],o,p),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,o);s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,o),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,o);n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,o);n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,o)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,s,a){var o,r,h,l,u=this._getInst(i);return 2===arguments.length&&"string"==typeof s?"defaults"===s?e.extend({},e.datepicker._defaults):u?"all"===s?e.extend({},u.settings):this._get(u,s):null:(o=s||{},"string"==typeof s&&(o={},o[s]=a),u&&(this._curInst===u&&this._hideDatepicker(),r=this._getDateDatepicker(i,!0),h=this._getMinMaxDate(u,"min"),l=this._getMinMaxDate(u,"max"),n(u.settings,o),null!==h&&o.dateFormat!==t&&o.minDate===t&&(u.settings.minDate=this._formatDate(u,h)),null!==l&&o.dateFormat!==t&&o.maxDate===t&&(u.settings.maxDate=this._formatDate(u,l)),"disabled"in o&&(o.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(e(i),u),this._autoSize(u),this._setDate(u,r),this._updateAlternate(u),this._updateDatepicker(u)),t)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(i){var s,n,a=e.datepicker._getInst(i.target);return e.datepicker._get(a,"constrainInput")?(s=e.datepicker._possibleChars(e.datepicker._get(a,"dateFormat")),n=String.fromCharCode(null==i.charCode?i.keyCode:i.charCode),i.ctrlKey||i.metaKey||" ">n||!s||s.indexOf(n)>-1):t},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,s,a,o,r,h,l;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),s=e.datepicker._get(i,"beforeShow"),a=s?s.apply(t,[t,i]):{},a!==!1&&(n(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),r={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),r=e.datepicker._checkOffset(i,r,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),i.inline||(h=e.datepicker._get(i,"showAnim"),l=e.datepicker._get(i,"duration"),i.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[h]?i.dpDiv.show(h,e.datepicker._get(i,"showOptions"),l):i.dpDiv[h||"show"](h?l:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,a=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,s=this._getNumberOfMonths(t),n=s[1],o=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",o*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,r=this._curInst;!r||t&&r!==e.data(t,o)||this._datepickerShowing&&(i=this._get(r,"showAnim"),s=this._get(r,"duration"),n=function(){e.datepicker._tidyDialog(r)},e.effects&&(e.effects.effect[i]||e.effects[i])?r.dpDiv.hide(i,e.datepicker._get(r,"showOptions"),s,n):r.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(r,"onClose"),a&&a.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker();
}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(i,s,n){if(null==i||null==s)throw"Invalid arguments";if(s="object"==typeof s?""+s:s+"",""===s)return null;var a,o,r,h,l=0,u=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof u?u:(new Date).getFullYear()%100+parseInt(u,10),c=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,p=(n?n.dayNames:null)||this._defaults.dayNames,f=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,m=(n?n.monthNames:null)||this._defaults.monthNames,g=-1,v=-1,_=-1,b=-1,y=!1,x=function(e){var t=i.length>a+1&&i.charAt(a+1)===e;return t&&a++,t},w=function(e){var t=x(e),i="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n=RegExp("^\\d{1,"+i+"}"),a=s.substring(l).match(n);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},k=function(i,n,a){var o=-1,r=e.map(x(i)?a:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(r,function(e,i){var n=i[1];return s.substr(l,n.length).toLowerCase()===n.toLowerCase()?(o=i[0],l+=n.length,!1):t}),-1!==o)return o+1;throw"Unknown name at position "+l},D=function(){if(s.charAt(l)!==i.charAt(a))throw"Unexpected literal at position "+l;l++};for(a=0;i.length>a;a++)if(y)"'"!==i.charAt(a)||x("'")?D():y=!1;else switch(i.charAt(a)){case"d":_=w("d");break;case"D":k("D",c,p);break;case"o":b=w("o");break;case"m":v=w("m");break;case"M":v=k("M",f,m);break;case"y":g=w("y");break;case"@":h=new Date(w("@")),g=h.getFullYear(),v=h.getMonth()+1,_=h.getDate();break;case"!":h=new Date((w("!")-this._ticksTo1970)/1e4),g=h.getFullYear(),v=h.getMonth()+1,_=h.getDate();break;case"'":x("'")?D():y=!0;break;default:D()}if(s.length>l&&(r=s.substr(l),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d>=g?0:-100)),b>-1)for(v=1,_=b;o=this._getDaysInMonth(g,v-1),!(o>=_);)v++,_-=o;if(h=this._daylightSavingAdjust(new Date(g,v-1,_)),h.getFullYear()!==g||h.getMonth()+1!==v||h.getDate()!==_)throw"Invalid date";return h},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,i){return e.settings[i]!==t?e.settings[i]:this._defaults[i]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,_,b,y,x,w,k,D,T,C,M,S,N,P,I,A,z,H,E,F,O,W,j,R=new Date,L=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),Y=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),J=this._get(e,"hideIfNoPrevNext"),K=this._get(e,"navigationAsDateFormat"),q=this._getNumberOfMonths(e),U=this._get(e,"showCurrentAtPos"),V=this._get(e,"stepMonths"),Q=1!==q[0]||1!==q[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-U,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-q[0]*q[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-V,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+V,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?G:L,o=K?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),_=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),y="",w=0;q[0]>w;w++){for(k="",this.maxRows=4,D=0;q[1]>D;D++){if(T=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",M="",Q){if(M+="<div class='ui-datepicker-group",q[1]>1)switch(D){case 0:M+=" ui-datepicker-group-first",C=" ui-corner-"+(Y?"right":"left");break;case q[1]-1:M+=" ui-datepicker-group-last",C=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",C=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&0===w?Y?a:s:"")+(/all|right/.test(C)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||D>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",S=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+u)%7,S+="<th"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+c[N]+"'>"+p[N]+"</span></th>";for(M+=S+"</tr></thead><tbody>",P=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,P)),I=(this._getFirstDayOfMonth(et,Z)-u+7)%7,A=Math.ceil((I+P)/7),z=Q&&this.maxRows>A?this.maxRows:A,this.maxRows=z,H=this._daylightSavingAdjust(new Date(et,Z,1-I)),E=0;z>E;E++){for(M+="<tr>",F=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(H)+"</td>":"",x=0;7>x;x++)O=g?g.apply(e.input?e.input[0]:null,[H]):[!0,""],W=H.getMonth()!==Z,j=W&&!_||!O[0]||X&&X>H||$&&H>$,F+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(W?" ui-datepicker-other-month":"")+(H.getTime()===T.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===H.getTime()&&b.getTime()===T.getTime()?" "+this._dayOverClass:"")+(j?" "+this._unselectableClass+" ui-state-disabled":"")+(W&&!v?"":" "+O[1]+(H.getTime()===G.getTime()?" "+this._currentClass:"")+(H.getTime()===L.getTime()?" ui-datepicker-today":""))+"'"+(W&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(j?"":" data-handler='selectDay' data-event='click' data-month='"+H.getMonth()+"' data-year='"+H.getFullYear()+"'")+">"+(W&&!v?"&#xa0;":j?"<span class='ui-state-default'>"+H.getDate()+"</span>":"<a class='ui-state-default"+(H.getTime()===L.getTime()?" ui-state-highlight":"")+(H.getTime()===G.getTime()?" ui-state-active":"")+(W?" ui-priority-secondary":"")+"' href='#'>"+H.getDate()+"</a>")+"</td>",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H);M+=F+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(Q?"</div>"+(q[0]>0&&D===q[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}y+=k}return y+=l,e._keyEvent=!1,y},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),_=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(a||!g)y+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(y+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");y+="</select>"}if(_||(b+=y+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),_&&(b+=(!a&&g&&v?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.4"}(jQuery),function(e){var t={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._destroyOverlay(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!t&&this._trigger("focus",e),i},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(n.focus(1),t.preventDefault()):(s.focus(1),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(n))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(n,a){s.position=[a.position.left-i.document.scrollLeft(),a.position.top-i.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(n))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(n,a){s.height=e(this).height(),s.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(a))}}).css("position",a)},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(s){var n=this,a=!1,o={};e.each(s,function(e,s){n._setOption(e,s),e in t&&(a=!0),e in i&&(o[e]=s)}),a&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var i,s,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=n.is(":data(ui-resizable)"),s&&!t&&n.resizable("destroy"),s&&"string"==typeof t&&n.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!e(t.target).closest(".ui-dialog").length||!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=this,i=this.widgetFullName;e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(s){t._allowInteraction(s)||(s.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t,i=this.options.position,s=[],n=[0,0];i?(("string"==typeof i||"object"==typeof i&&"0"in i)&&(s=i.split?i.split(" "):[i[0],i[1]],1===s.length&&(s[1]=s[0]),e.each(["left","top"],function(e,t){+s[e]===s[e]&&(n[e]=s[e],s[e]=t)}),i={my:s[0]+(0>n[0]?n[0]:"+"+n[0])+" "+s[1]+(0>n[1]?n[1]:"+"+n[1]),at:s.join(" ")}),i=e.extend({},e.ui.dialog.prototype.options.position,i)):i=e.ui.dialog.prototype.options.position,t=this.uiDialog.is(":visible"),t||this.uiDialog.show(),this.uiDialog.position(i),t||this.uiDialog.hide()}})}(jQuery),function(e){e.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),
this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var s,n,a,o,r,h=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:h=!1,n=this.previousFilter||"",a=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),a===n?o=!0:a=n+a,r=RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(e(this).children("a").text())}),s=o&&-1!==s.index(this.active.next())?this.active.nextAll(".ui-menu-item"):s,s.length||(a=String.fromCharCode(t.keyCode),r=RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(e(this).children("a").text())})),s.length?(this.focus(t,s),s.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}h&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,i=this.options.icons.submenu,s=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),s=t.prev("a"),n=e("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);s.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",s.attr("id"))}),t=s.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.height(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var i,s,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}})}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.10.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),t)},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(jQuery),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,c=this.options;return!c.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===c.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r!==!1&&(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,n,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=!this._animateOff&&r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(i){var s,n,a,o,r=e(i.target).data("ui-slider-handle-index");switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(i.target).addClass("ui-state-active"),s=this._start(i,r),s===!1))return}switch(o=this.options.step,n=a=this.options.values&&this.options.values.length?this.values(r):this.value(),i.keyCode){case e.ui.keyCode.HOME:a=this._valueMin();break;case e.ui.keyCode.END:a=this._valueMax();break;case e.ui.keyCode.PAGE_UP:a=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:a=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;a=this._trimAlignValue(n+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;a=this._trimAlignValue(n-o)}this._slide(i,r,a)},click:function(e){e.preventDefault()},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(t){function e(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.widget("ui.spinner",{version:"1.10.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);void 0!==n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)!==!1&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return!(!this.spinning&&this._trigger("start",t)===!1)&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(t){this._super(t),this._value(this.element.val())}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:e(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:e(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:e(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void e(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(t,e){function i(){return++n}function s(t){return t=t.cloneNode(!1),t.hash.length>1&&decodeURIComponent(t.href.replace(a,""))===decodeURIComponent(location.href.replace(a,""))}var n=0,a=/#.*$/;t.widget("ui.tabs",{version:"1.10.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var i=this.options.active,s=this.options.collapsible,n=location.hash.substring(1);return null===i&&(n&&this.tabs.each(function(s,a){return t(a).attr("aria-controls")===n?(i=s,!1):e}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===i||-1===i)&&(i=!!this.tabs.length&&0)),i!==!1&&(i=this.tabs.index(this.tabs.eq(i)),-1===i&&(i=!s&&0)),!s&&i===!1&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(i){var s=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(s),a=!0;if(!this._handlePageNav(i)){switch(i.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:a=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return i.preventDefault(),clearTimeout(this.activating),this._activate(n),e;case t.ui.keyCode.ENTER:return i.preventDefault(),clearTimeout(this.activating),this._activate(n!==this.options.active&&n),e;default:return}i.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,a),i.ctrlKey||(s.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(i){return i.altKey&&i.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):i.altKey&&i.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):e},_findNextTab:function(e,i){function s(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==t.inArray(s(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,i){return"active"===t?(this._activate(i),e):"disabled"===t?(this._setupDisabled(i),e):(this._super(t,i),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",i),i||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(i),"heightStyle"===t&&this._setupHeightStyle(i),e)},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,n){var a,o,r,h=t(n).uniqueId().attr("id"),l=t(n).closest("li"),u=l.attr("aria-controls");s(n)?(a=n.hash,o=e.element.find(e._sanitizeSelector(a))):(r=e._tabId(l),a="#"+r,o=e.element.find(a),o.length||(o=e._createPanel(r),o.insertAfter(e.panels[i-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),u&&l.data("ui-tabs-aria-controls",u),l.attr({"aria-controls":a.substring(1),"aria-labelledby":h}),o.attr("aria-labelledby",h)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0);
},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,s=0;i=this.tabs[s];s++)e===!0||-1!==t.inArray(s,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(t){t.preventDefault()}};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();"fill"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?t():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):t(),u={oldTab:s,oldPanel:l,newTab:r?t():a,newPanel:h};e.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",e,u)===!1||(i.active=!r&&this.tabs.index(a),this.active=o?t():a,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),e),this._toggle(e,u))},_toggle:function(e,i){function s(){a.running=!1,a._trigger("activate",e,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var s=this.options.disabled;s!==!1&&(i===e?s=!1:(i=this._getIndex(i),s=t.isArray(s)?t.map(s,function(t){return t!==i?t:null}):t.map(this.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(s))},disable:function(i){var s=this.options.disabled;if(s!==!0){if(i===e)s=!0;else{if(i=this._getIndex(i),-1!==t.inArray(i,s))return;s=t.isArray(s)?t.merge([i],s).sort():[i]}this._setupDisabled(s)}},load:function(e,i){e=this._getIndex(e);var n=this,a=this.tabs.eq(e),o=a.find(".ui-tabs-anchor"),r=this._getPanelForTab(a),h={tab:a,panel:r};s(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(a.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){r.html(t),n._trigger("load",i,h)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&n.panels.stop(!1,!0),a.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href"),beforeSend:function(e,a){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:a},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(jQuery),function(t){function e(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")}var s=0;t.widget("ui.tooltip",{version:"1.10.4",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var s=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e)})))},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,a=e?e.type:null;return"string"==typeof s?this._open(e,t,s):(i=s.call(t[0],function(i){t.data("ui-tooltip-open")&&n._delay(function(){e&&(e.type=a),this._open(e,t,i)})}),void(i&&this._open(e,t,i)))},_open:function(i,s,n){function a(t){l.of=t,o.is(":hidden")||o.position(l)}var o,r,h,l=t.extend({},this.options.position);if(n){if(o=this._find(s),o.length)return void o.find(".ui-tooltip-content").html(n);s.is("[title]")&&(i&&"mouseover"===i.type?s.attr("title",""):s.removeAttr("title")),o=this._tooltip(s),e(s,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:a}),a(i)):o.position(t.extend({of:s},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){o.is(":visible")&&(a(l.of),clearInterval(h))},t.fx.interval)),this._trigger("open",i,{tooltip:o}),r={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=s[0],this.close(i,!0)}},remove:function(){this._removeTooltip(o)}},i&&"mouseover"!==i.type||(r.mouseleave="close"),i&&"focusin"!==i.type||(r.focusout="close"),this._on(!0,s,r)}},close:function(e){var s=this,n=t(e?e.currentTarget:this.element),a=this._find(n);this.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&n.attr("title",n.data("ui-tooltip-title")),i(n),a.stop(!0),this._hide(a,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:a}),this.closing=!1)},_tooltip:function(e){var i="ui-tooltip-"+s++,n=t("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return t("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),this.tooltips[i]=e,n},_find:function(e){var i=e.data("ui-tooltip-id");return i?t("#"+i):t()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0),t("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))})}})}(jQuery),function(e,t){var i="ui-effects-";e.effects={effect:{}},function(e,t){function i(e,t,i){var s=c[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var c=this,d=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],d="array"),"string"===d?this.parse(s(n)||a._default):"array"===d?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===d?(n instanceof l?f(u,function(e,t){n[t.cache]&&(c[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!c[a]&&s.to){if("alpha"===e||null==n[e])return;c[a]=s.to(c._rgba)}c[a][t.idx]=i(n[e],t,!0)}),c[a]&&0>e.inArray(null,c[a].slice(0,3))&&(c[a][3]=1,s.from&&(c._rgba=s.from(c[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=c[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,c=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=c?l/u:l/(2-u),[Math.round(t)%360,i,c,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),c="array"===r||"object"===r?s:arguments,d=this[o].slice();return f(a,function(e,t){var s=c["object"===r?e:t.idx];null==s&&(s=d[t.idx]),d[t.idx]=i(s,t)}),u?(n=l(u(d)),n[o]=d,n):l(d)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r="";if("transparent"!==n&&("string"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!d.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function s(t,i){var s,n,o={};for(s in i)n=i[s],t[s]!==n&&(a[s]||(e.fx.step[s]||!isNaN(parseFloat(n)))&&(o[s]=n));return o}var n=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var t=e(this);return{el:t,start:i(this)}}),a=function(){e.each(n,function(e,i){t[i]&&o[i+"Class"](t[i])})},a(),l=l.map(function(){return this.end=i(this.el[0]),this.diff=s(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(i){return function(s,n,a,o,r){return"boolean"==typeof n||n===t?a?e.effects.animateClass.call(this,n?{add:s}:{remove:s},a,o,r):i.apply(this,arguments):e.effects.animateClass.call(this,{toggle:s},n,a,o)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function s(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function n(t){return!(t&&"number"!=typeof t&&!e.fx.speeds[t])||("string"==typeof t&&!e.effects.effect[t]||(!!e.isFunction(t)||"object"==typeof t&&!t.effect))}e.extend(e.effects,{version:"1.10.4",save:function(e,t){for(var s=0;t.length>s;s++)null!==t[s]&&e.data(i+t[s],e[0].style[t[s]])},restore:function(e,s){var n,a;for(a=0;s.length>a;a++)null!==s[a]&&(n=e.data(i+s[a]),n===t&&(n=""),e.css(s[a],n))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),float:t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function t(t){function s(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=i.complete,r=i.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),s()):o.call(n[0],i,s)}var i=s.apply(this,arguments),n=i.mode,a=i.queue,o=e.effects.effect[i.effect];return e.fx.off||!o?n?this[n](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):a===!1?this.each(t):this.queue(a||"fx",t)},show:function(e){return function(t){if(n(t))return e.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(e.fn.show),hide:function(e){return function(t){if(n(t))return e.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(e.fn.hide),toggle:function(e){return function(t){if(n(t)||"boolean"==typeof t)return e.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}()}(jQuery),function(e){var t=/up|down|vertical/,i=/up|left|vertical|horizontal/;e.effects.effect.blind=function(s,n){var a,o,r,h=e(this),l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(h,s.mode||"hide"),c=s.direction||"up",d=t.test(c),p=d?"height":"width",f=d?"top":"left",m=i.test(c),g={},v="show"===u;h.parent().is(".ui-effects-wrapper")?e.effects.save(h.parent(),l):e.effects.save(h,l),h.show(),a=e.effects.createWrapper(h).css({overflow:"hidden"}),o=a[p](),r=parseFloat(a.css(f))||0,g[p]=v?o:0,m||(h.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),g[f]=v?r:o+r),v&&(a.css(p,0),m||a.css(f,r+o)),a.animate(g,{duration:s.duration,easing:s.easing,queue:!1,complete:function(){"hide"===u&&h.hide(),e.effects.restore(h,l),e.effects.removeWrapper(h),n()}})}}(jQuery),function(e){e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"effect"),l="hide"===h,u="show"===h,c=t.direction||"up",d=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===c||"down"===c?"top":"left",_="up"===c||"left"===c,b=o.queue(),y=b.length;for((u||l)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),d||(d=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,_?2*-d:2*d).animate(a,m,g)),l&&(d/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(_?"-=":"+=")+d,o.animate(n,m,g).animate(a,m,g),d=l?2*d:d/2;l&&(n={opacity:0},n[v]=(_?"-=":"+=")+d,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),y>1&&b.splice.apply(b,[1,0].concat(b.splice(y,f+1))),o.dequeue()}}(jQuery),function(e){e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",c="vertical"===u,d=c?"height":"width",p=c?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[d](),l&&(n.css(d,0),n.css(p,a/2)),f[d]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})}}(jQuery),function(e){e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",c={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===u?-s:s),c[l]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})}}(jQuery),function(e){e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===c*d&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,c=t.pieces?Math.round(Math.sqrt(t.pieces)):3,d=c,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),_=Math.ceil(p.outerHeight()/c),b=[];for(a=0;c>a;a++)for(h=g.top+a*_,u=a-(c-1)/2,o=0;d>o;o++)r=g.left+o*v,l=o-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*_}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:_,left:r+(m?l*v:0),top:h+(m?u*_:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*_),opacity:m?1:0},t.duration||500,t.easing,s)}}(jQuery),function(e){e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})}}(jQuery),function(e){e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),h="show"===r,l="hide"===r,u=t.size||15,c=/([0-9]+)%/.exec(u),d=!!t.horizFirst,p=h!==d,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],c&&(u=parseInt(c[1],10)/100*n[l?0:1]),h&&s.css(d?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})}}(jQuery),function(e){e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})}}(jQuery),function(e){e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,c=0,d=n.queue(),p=d.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),c=1),s=1;l>s;s++)n.animate({opacity:c},u,t.easing),c=1-c;n.animate({opacity:c},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,l+1))),n.dequeue()}}(jQuery),function(e){e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),_=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(_=_.concat(c),o.from=e.effects.setTransition(o,c,a.from.y,o.from),o.to=e.effects.setTransition(o,c,a.to.y,o.to)),a.from.x!==a.to.x&&(_=_.concat(d),o.from=e.effects.setTransition(o,d,a.from.x,o.from),o.to=e.effects.setTransition(o,d,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(_=_.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,_),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(c=c.concat(["marginTop","marginBottom"]).concat(u),d=d.concat(["marginLeft","marginRight"]),l=r.concat(c).concat(d),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,
outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,c,a.from.y,i.from),i.to=e.effects.setTransition(i,c,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,d,a.from.x,i.from),i.to=e.effects.setTransition(i,d,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,_),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})}}(jQuery),function(e){e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,c=Math.round(t.duration/u),d="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),_=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[d]=(p?"-=":"+=")+h,m[d]=(p?"+=":"-=")+2*h,g[d]=(p?"-=":"+=")+2*h,n.animate(f,c,t.easing),s=1;l>s;s++)n.animate(m,c,t.easing).animate(g,c,t.easing);n.animate(m,c,t.easing).animate(f,c/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),_>1&&v.splice.apply(v,[1,0].concat(v.splice(_,u+1))),n.dequeue()}}(jQuery),function(e){e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,c={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),c[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})}}(jQuery),function(e){e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},c=s.offset(),d=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:c.top-r,left:c.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){d.remove(),i()})}}(jQuery);
function alert(str){if(1==isalertIdshow){isalertIdshow=!1;var alertId="#alertshowloading";$(alertId).addClass("md-show").text(str),setTimeouts(alertId,outTimes)}}function setTimeouts(alertId,outTimes){setTimeout(function(){$(alertId).removeClass("md-show"),isalertIdshow=!0},outTimes)}var isalertIdshow=!0,outTimes=3e3;String.prototype.YLstringcheck=function(){return this.replace(/(^\s*)/g,"")};
$(function(){$.extend({showeditForm:function(){}}),jQuery.showeditForm.prototype={formWidget:function(widgetType){switch(widgetType){case"Text":return"<div class='ui-state-default borderbor of porela' data-widget='Text'><label class='widget-title porela break inblock title'>文本输入框</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><input type='text' class='form-control'><div class='field-description hide'></div></div></div>";case"TextArea":return"<div class='ui-state-default borderbor of porela' data-widget='TextArea'><label class='widget-title porela break inblock title'>多行文本框</label><span class='widget-required'>*</span><div class='widget-content'><textarea class='pb_textareas noborder'></textarea><div class='field-description hide'></div></div></div>";case"RadioBox":return"<div class='ui-state-default borderbor of porela flex' data-widget='RadioBox'><label class='widget-title porela break inblock title'>单选框</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><ul><li><label class='radio-inline'><input name='radioView' type='radio'><span>选项1</span></label></li><li><label class='radio-inline'><input name='radioView' type='radio'><span>选项2</span></label></li><li><label class='radio-inline'><input name='radioView' type='radio'><span>选项3</span></label></li></ul><div class='field-description hide'></div></div></div>";case"CheckBox":return"<div class='ui-state-default borderbor of porela flex' data-widget='CheckBox'><label class='widget-title porela break inblock title'>复选框</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><ul><li><label class='CheckBox_js'><input name='CheckBoxView' type='checkbox'><span>选项1</span></label></li><li><label class='CheckBox_js'><input name='CheckBoxView' type='checkbox'><span>选项2</span></label></li><li><label class='CheckBox_js'><input name='CheckBoxView' type='checkbox'><span>选项3</span></label></li></ul><div class='field-description hide'></div></div><input type='hidden' name='checkedMax' value=''></div>";case"Select":return"<div class='ui-state-default borderbor of porela flex' data-widget='Select'><label class='widget-title porela break inblock title'>下拉菜单</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><select class='form-control choicelist'><option class='Select_js' value='选项1'>选项1</option><option class='Select_js' value='选项2'>选项2</option><option class='Select_js' value='选项3'>选项3</option></select><div class='field-description hide'></div></div></div>";case"DateComponent":return"<div class='ui-state-default borderbor of porela' data-widget='DateComponent'><label class='widget-title porela break inblock title'>日期</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><input type='text' class='form-control' placeholder='年-月-日' readonly='readonly' onfocus='this.blur()'/><div class='field-description hide'></div></div></div>";case"DateInterval":return"<div class='ui-state-default borderbor of porela' data-widget='DateInterval'><label class='widget-title porela break inblock title'>日期区间</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><input type='text' class='form-control' placeholder='年-月-日' readonly='readonly' onfocus='this.blur()'/><span class='mr5'>——</span><input type='text' class='form-control' placeholder='年-月-日' readonly='readonly' onfocus='this.blur()' /><div class='field-description hide'></div></div></div>";case"NumberComponent":return"<div class='ui-state-default borderbor of porela' data-widget='NumberComponent'><label class='widget-title porela break inblock title'>数字输入框</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><input type='text' class='form-control'><div class='field-description hide'></div></div></div>";case"Money":return"<div class='ui-state-default borderbor of porela' data-widget='Money'><label class='widget-title porela break inblock title'>金额</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'> <input type='text' class='form-control'> <span class='money-type fr'>(人民币)</span><div class='field-description hide'></div></div></div>";case"Employee":return"<div class='ui-state-default borderbor porela of' data-widget='Employee'><label class='widget-title porela break inblock title'>用户选择</label><span class='widget-required'>*</span> <div class='poabso addbtn1 fpgbtn' ng-click='addgroup($event,1)'></div>  <div class='break pbc inblock rcontent'><ul></ul></div>   <div class='field-description hide'></div></div>";case"Department":return"<div class='ui-state-default borderbor porela of' data-widget='Department'><label class='widget-title porela break inblock title'>部门选择</label><span class='widget-required'>*</span> <div class='poabso addbtn1 fpgbtn' ng-click='addgroup($event,0)'></div> <div class='break pbc inblock rcontent'><ul></ul></div>   <div class='field-description hide'></div></div>";case"DividingLine":return"<div class='ui-state-default borderbor of porela' data-widget='DividingLine'><div class='divider-line solid'></div><span class='widget-required'></span></div>";case"Paragraph":return"<div class='ui-state-default borderbor of porela' data-widget='Paragraph'><div class='alert alert-success' role='alert'>空白段落</div><span class='widget-required'></span></div>";case"Email":return"<div class='ui-state-default borderbor of porela' data-widget='Email'><label class='widget-title porela break inblock title'>邮箱</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><input type='text' class='form-control'><div class='field-description hide'></div></div></div>";case"Phone":return"<div class='ui-state-default borderbor of porela' data-widget='Phone'><label class='widget-title porela break inblock title'>电话</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><input type='text' class='form-control'><div class='field-description hide'></div></div></div>";case"Mobile":return"<div class='ui-state-default borderbor of porela' data-widget='Mobile'><label class='widget-title porela break inblock title'>手机</label><span class='widget-required'>*</span><div class='widget-content break pbc inblock rcontent'><input type='text' class='form-control'><div class='field-description hide'></div></div></div>";case"FileComponent":return"<div class='ui-state-default borderbor of porela ' data-widget='FileComponent'><label class='widget-title porela break inblock title'>附件</label><span class='widget-required'>*</span> <ul></ul><div class='none'>0</div>   <div class='btn blue fr poabso'></div>   <div class='field-description hide'></div> </div>";case"ImageComponent":return"<div class='ui-state-default borderbor of porela ' data-widget='ImageComponent'><label class='widget-title porela break inblock title'>图片</label><span class='widget-required'>*</span> <ul></ul><div class='none'>0</div>  <div class='btn blue fr poabso'></div>   <div class='field-description hide'></div> </div>";default:return alert("缺少模块！"),!1}},checkedMax:function(dataMax,radioNum,str){if(dataMax)for(var checkedNum=0,i=0;i<radioNum;i++)""==str?$("input[name=editor-option]:eq("+i+")").prop("checked")&&checkedNum++:str.find("input:eq("+i+")").prop("checked")&&checkedNum++;return checkedNum},saveForm:function(){var formArray={},field=new Array;formArray.title=$("#formpresentation_edit .formtitles").text();for(var maxid=$("#formpresentation_edit .scrollbor .borderbor"),widgetNum=$("#formpresentation_edit .scrollbor .borderbor").length,i=0;i<widgetNum;i++){var fieldArray={},field_setting={},field_type=(new Array,maxid.eq(i).data("widget"));if(fieldArray.formtype=field_type,"DividingLine"!=field_type&&"Paragraph"!=field_type){var field_title=maxid.eq(i).find(".widget-title").text();if(maxid.eq(i).find(".widget-required").is(":hidden"))var field_required=0;else var field_required=1;var field_value,field_describe=maxid.eq(i).find(".field-description").text(),field_value=maxid.eq(i).find("textarea").val();field_value="TextArea"==field_type?maxid.eq(i).find("textarea").val():maxid.eq(i).find("input").val(),fieldArray.title=field_title,fieldArray.required=field_required,fieldArray.describe=field_describe,"TextArea"==field_type&&(field_value=field_value.replace(/\n+/g,"<br/>"),field_value=field_value.replace(/\s+/g,"&nbsp;")),fieldArray.inputvalue=field_value}if("DataTable"==field_type){for(var field_table={},rowNum=maxid.eq(i).find("input[name=tableRow]").val(),totalItem=maxid.eq(i).find("input[name=tableTotal]").val(),cellNum=maxid.eq(i).find("th").length,countNum=maxid.eq(i).find(".hcounts").html(),t=0;t<cellNum;t++){var thText=maxid.eq(i).find("th:eq("+t+")").text(),inputType=maxid.eq(i).find("tr:eq(1)").find("td:eq("+t+") input").attr("placeholder"),field_item={};field_item.itemTitle=thText,field_item.itemData=inputType,field_table[t]=field_item}for(var rowsNum=$(".borderbor:eq("+i+") tr:gt(0):not(:last)").length,field_item_tr={},tr=0;tr<rowsNum;tr++){for(var field_item_form={},trhang=maxid.eq(i).find("tr:eq("+(tr+1)+")"),td=0;td<cellNum;td++){var trText=trhang.find("td:eq("+td+") input").val();field_item_form[td]=trText}field_item_tr[tr]=field_item_form}field_setting.rowNum=rowNum,field_setting.cellNum=cellNum,field_setting.totalItem=totalItem,field_setting.tableData=field_table,field_setting.table=field_item_tr,field_setting.countNum=countNum,fieldArray.setting=field_setting}if("RadioBox"==field_type){for(var field_radio={},radioNum=maxid.eq(i).find(".radio-inline").length,r=0;r<radioNum;r++){var radioText=maxid.eq(i).find(".radio-inline:eq("+r+") span").text();if(maxid.eq(i).find(".radio-inline:eq("+r+") input").prop("checked"))var radioChecked=!0;else var radioChecked=!1;var field_item={};field_item.itemTitle=radioText,field_item.itemData=radioChecked,field_radio[r]=field_item}field_setting.radio=field_radio,fieldArray.setting=field_setting}if("CheckBox"==field_type){for(var field_checkbox={},field_checkedMax=maxid.eq(i).find("input[name=checkedMax]").val(),checkboxNum=maxid.eq(i).find(".CheckBox_js").length,c=0;c<checkboxNum;c++){var checkboxText=maxid.eq(i).find(".CheckBox_js:eq("+c+") span").text();if(maxid.eq(i).find(".CheckBox_js:eq("+c+") input").prop("checked"))var checkboxChecked=!0;else var checkboxChecked=!1;var field_item={};field_item.itemTitle=checkboxText,field_item.itemData=checkboxChecked,field_checkbox[c]=field_item}field_setting.checkedMax=field_checkedMax,field_setting.checkbox=field_checkbox,fieldArray.setting=field_setting}if("Select"==field_type){for(var field_select={},selectNum=maxid.eq(i).find(".Select_js").length,s=0;s<selectNum;s++){var selectText=maxid.eq(i).find(".Select_js:eq("+s+")").text();if(maxid.eq(i).find(".Select_js:eq("+s+")").prop("selected"))var selected=!0;else var selected=!1;var field_item={};field_item.itemTitle=selectText,field_item.itemData=selected,field_select[s]=field_item}field_setting.select=field_select,fieldArray.setting=field_setting}if("DateComponent"==field_type||"DateInterval"==field_type){var field_dateType=maxid.eq(i).find("input").attr("placeholder");fieldArray.dateType=field_dateType,2==maxid.eq(i).find(".form-control").length&&(fieldArray.dateTimeEnd=maxid.eq(i).find(".form-control").eq(1).val())}if("Money"==field_type){var field_MoneyType=maxid.eq(i).find(".money-type").text().replace(/[()]/g,"");fieldArray.moneyType=field_MoneyType}if("DividingLine"==field_type){var field_DividingLine=maxid.eq(i).find(".divider-line").attr("class"),field_DividingLine=field_DividingLine.split(" ");fieldArray.styleType=field_DividingLine[1]}if("Paragraph"==field_type){var field_Paragraph=maxid.eq(i).find(".alert").attr("class"),field_Paragraph=field_Paragraph.split(" ");if(maxid.eq(i).find(".alert #ckeditor"))var field_ParagraphContent=maxid.eq(i).find(".alert").html();else var field_ParagraphContent=maxid.eq(i).find(".alert").html();fieldArray.styleType=field_Paragraph[1],fieldArray.content=field_ParagraphContent}if("Employee"==field_type||"Department"==field_type){for(var field_Employee={},checkboxNum=maxid.eq(i).find("ul li").length,em=0;em<checkboxNum;em++){var EmployeeName=maxid.eq(i).find("ul li:eq("+em+") .filename").html(),EmployeeId=maxid.eq(i).find("ul li:eq("+em+") .filename").attr("data-member_id"),field_item={};field_item.itemName=EmployeeName,field_item.itemId=EmployeeId,field_Employee[em]=field_item}field_setting.Employee=field_Employee,fieldArray.setting=field_setting}if("ImageComponent"==field_type){for(var field_ImageComponent={},ImageComponentNum=maxid.eq(i).find("li").length,img=0;img<ImageComponentNum;img++){var ImageComponentImg=maxid.eq(i).find("li").eq(img).html(),field_item={};field_item.itemImgs=ImageComponentImg,field_ImageComponent[img]=field_item}field_setting.ImageComponent=field_ImageComponent,fieldArray.setting=field_setting}if("FileComponent"==field_type){for(var field_FileComponent={},FileComponentNum=maxid.eq(i).find("li").length,imgf=0;imgf<FileComponentNum;imgf++){var FileComponentImg=maxid.eq(i).find("li").eq(imgf).html(),field_item={};field_item.FileComponent=FileComponentImg,field_FileComponent[imgf]=field_item}field_setting.FileComponent=field_FileComponent,fieldArray.setting=field_setting}field[i]=fieldArray,formArray.field=field}return formArray}}});
var LoginMod=angular.module("LoginMod",[]);LoginMod.controller("LoginCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state){var loginForm=$scope.loginForm={};loginForm.userName="",loginForm.passWord="",loginForm.newPass="",loginForm.againnewPass="",loginForm.findPassUsername="",loginForm.isUpdatePwdWin=!1,loginForm.isForgetPwdWin=!1,loginForm.isForgetPwdSuccessWin=!1,loginForm.isDisabled=!1,loginForm.checkemail=function(email){var reg=/^(\w-*\.*)+@(\w-?)+(\.\w{2,3})+$/;return!!reg.test(email)||(loginForm.isDisabled=!1,alert("格式错误，请输入正确的email！"),!1)},$scope.myKeyup=function(e){var keycode=window.event?e.keyCode:e.which;13==keycode&&loginForm.submitButton()},loginForm.submitButton=function(){if(loginForm.isDisabled)return!1;if(loginForm.isDisabled=!0,0==loginForm.userName.length)return loginForm.isDisabled=!1,alert("请输入email"),!1;if(loginForm.checkemail(loginForm.userName)){if(0==loginForm.passWord.length)return loginForm.isDisabled=!1,alert("请输入密码"),!1;if(loginForm.passWord.length<6)return loginForm.isDisabled=!1,alert("密码长度不能小于6位！"),!1;if(loginForm.passWord.length>16)return loginForm.isDisabled=!1,alert("密码长度不能大于16位!"),!1;$http.post("/index.php?r=login/login/login",{username:loginForm.userName,pwd:loginForm.passWord}).success(function(data,status){2==data.code?(alert(data.msg),loginForm.isUpdatePwdWin=!0):1==data.code?($cookieStore.put("userInfo",data.member),window.localStorage.allper=JSON.stringify(data.allper),window.localStorage.userper=JSON.stringify(data.userper),$rootScope.rootUserInfo=data.member,$state.go("main.index"),loginForm.userName="",loginForm.passWord=""):data.code==-1&&(alert(data.msg),$state.go("login",{})),loginForm.isDisabled=!1}).error(function(error){loginForm.isDisabled=!1})}},loginForm.updatePassword=function(){return!loginForm.isDisabled&&(loginForm.isDisabled=!0,0==$.trim(loginForm.newPass).length?(loginForm.isDisabled=!1,alert("请先输入新密码"),!1):$.trim(loginForm.newPass).length<6?(loginForm.isDisabled=!1,alert("新密码长度不能小于6位！"),!1):$.trim(loginForm.newPass).length>16?(loginForm.isDisabled=!1,alert("新密码长度不能大于16位!"),!1):$.trim(loginForm.newPass)!=$.trim(loginForm.againnewPass)?(loginForm.isDisabled=!1,alert("两次密码不一致!"),!1):void $http.post("/index.php?r=login/login/modify-pwd",{pwd1:loginForm.newPass,pwd2:loginForm.againnewPass}).success(function(data,status){1==data.code||data.code==-2?(alert(data.msg),1==data.code?(loginForm.isDisabled=!1,loginForm.passWord=loginForm.newPass,loginForm.submitButton()):$state.go("login",{},{reload:!0})):alert(data.msg),loginForm.isDisabled=!1}).error(function(error){loginForm.isDisabled=!1}))},loginForm.findPassword=function(){return!loginForm.isDisabled&&(loginForm.isDisabled=!0,loginForm.findPassUsername=loginForm.findPassUsername.replace(/\s/g,""),void(""==loginForm.findPassUsername?(loginForm.isDisabled=!1,alert("请先输入email!")):loginForm.checkemail(loginForm.findPassUsername)&&$http.post("/index.php?r=login/login/forgetpassword",{email:loginForm.findPassUsername}).success(function(data,status){1==data.code?(loginForm.isUpdatePwdWin=!1,loginForm.isForgetPwdWin=!1,loginForm.isForgetPwdSuccessWin&&alert(data.msg),loginForm.isForgetPwdSuccessWin=!0):alert(data.msg),loginForm.isDisabled=!1}).error(function(error){loginForm.isDisabled=!1})))},loginForm.retLogin=function(){return!loginForm.isDisabled&&(loginForm.isUpdatePwdWin=!1,loginForm.isForgetPwdWin=!1,loginForm.isForgetPwdSuccessWin=!1,loginForm.newPass="",loginForm.againnewPass="",void(loginForm.findPassUsername=""))},loginForm.forgetWin=function(){return!loginForm.isDisabled&&(loginForm.isUpdatePwdWin=!1,loginForm.isForgetPwdWin=!0,void(loginForm.isForgetPwdSuccessWin=!1))},$(".help-tab p").click(function(){$(".help-content>div").hide(),$("#"+this.dataset.target).show(),$(".help-tab p a").removeClass("curTab"),$(this).find("a").addClass("curTab")})});
LoginMod.controller("ForgetPasswordCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,$stateParams){var uid=$stateParams.uid,password_token=$stateParams.password_token;""!=uid&&""!=password_token||$state.go("login",{},{reload:!0});var loginForm=$scope.loginForm={};loginForm.newPass="",loginForm.againnewPass="",loginForm.updatePassword=function(){return 0==$.trim(loginForm.newPass).length?(alert("请先输入新密码"),!1):$.trim(loginForm.newPass).length<6?(alert("新密码长度不能小于6位！"),!1):$.trim(loginForm.newPass).length>16?(alert("新密码长度不能大于16位!"),!1):$.trim(loginForm.newPass)!=$.trim(loginForm.againnewPass)?(alert("两次密码不一致!"),!1):void $http.post("/index.php?r=login/login/resetpassword",{pwd1:loginForm.newPass,pwd2:loginForm.againnewPass,password_token:password_token,uid:uid}).success(function(data,status){1==data.code?(alert(data.msg),$state.go("login",{},{reload:!0})):alert(data.msg)})}});
LoginMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){$stateProvider.state("login",{url:"/login",module:"public",data:{css:["css/login.css"]},views:{"":{templateUrl:"appnews/modules/login/view/login.html",controller:"LoginCtrl"}}}).state("forgetPassword",{url:"/forgetPassword/:password_token/:uid",module:"public",data:{css:["css/login.css"]},views:{"":{templateUrl:"appnews/modules/login/view/psdreset.html",controller:"ForgetPasswordCtrl"}}}).state("aboutwe",{url:"/aboutwe",module:"public",data:{css:["css/login.css"]},views:{"":{templateUrl:"appnews/modules/login/view/aboutwe.html"}}}).state("mobile",{url:"/mobile",module:"public",data:{css:["css/login.css"]},views:{"":{templateUrl:"appnews/modules/login/view/mobile.html"}}}).state("help",{url:"/help",module:"public",data:{css:["css/login.css"]},views:{"":{templateUrl:"appnews/modules/login/view/help.html",controller:"LoginCtrl"}}})}]);
var IndexMod=angular.module("IndexMod",[]);IndexMod.controller("indexCtr",function($scope,$http,$location,deskModel){var index=$scope.index={},index_param=$scope.index_param={};index.task=[],index.my_work=[],index.attendance=[],index.project=[],index.notice=[],index.my_apply=[],index.my_approval=[],index.survey=[],index.workstate_approval=[],index.score_board=[],deskModel.getDeskTpl($scope),index.draw=function(index,allCount,finishCount){var canvas=angular.element(".pro-progress canvas"),ctx=canvas[index].getContext("2d");ctx.beginPath();var degree=(finishCount/allCount).toFixed(2);ctx.arc(75,75,66,-.5*Math.PI,degree*(2*Math.PI)-Math.PI/2,!1),ctx.lineWidth=15.4,ctx.lineCap="round",ctx.strokeStyle="#fff",ctx.stroke(),ctx.closePath()},index_param.type=1,index.scoreBoard=function(type){angular.element(".score-module").find("span").toggleClass("score-active"),index_param.type=type,deskModel.scoreBoard($scope)},index.tplUrl=function(tplCode){return"appnews/modules/common/view/templet/"+tplCode+".html"}}),IndexMod.controller("navCtr",function($scope,$location,$cookieStore,$state){!function(){function menuUlChange(){menu.ulHs=$(".menus").height(),menu.ulHs<menu.ulH?(menu.menuUpbtn.show(),menu.menuDownbtn.show()):(menu.menuUpbtn.hide(),menu.menuDownbtn.hide())}function taskupdown(){var taskhight=parseInt($(".taskcreatewin").css("height"))-107,iclass=$(".taskcreatewin .morebtn.ischange");iclass.length?$(".taskcreatewin .btnbor").css({top:taskhight+"px",height:"100%"}):$(".taskcreatewin .btnbor").css({top:"335px",height:"100%"})}var menu={};menu.menuTitle=$(".leftsbar .menus .menu-title"),menu.isMinMenu=!1,menu.menuUpbtn=$(".menu-up"),menu.menuDownbtn=$(".menu-down"),menu.aclick=$(".leftsbar ul ul li a"),menu.uln=62,menu.lis=0,menu.lisize=$(".menu-title").length,menu.ulH=menu.lisize*menu.uln,menu.leftsbara=$(".leftsbar a"),menu.logomax=$(".logomax"),menu.logomin=$(".logomin"),menu.leftsbar=$(".leftsbar"),menu.mainsbar=$(".mainsbar"),menu.leftmenus=$(".leftsbar .menus"),menu.menusli=$(".menus>ul>li"),menu.menubindFun=function(){menu.thisParent=$(this).parent(),menu.finduls=menu.thisParent.find("ul"),menu.addhref=menu.thisParent.find(".addhref"),menu.thisSlings=menu.thisParent.siblings(".menu-select"),menu.thisSlings.find("ul").slideUp(),menu.thisSlings.removeClass("menu-select"),menu.thisParent.siblings("li").find(".addhref").html("&#xe605;"),menu.thisParent.parent().find(".menu-select").length?(menu.finduls.slideUp(),menu.thisParent.removeClass("menu-select"),menu.addhref.html("&#xe605;")):(menu.finduls.slideDown(),menu.thisParent.addClass("menu-select"),menu.addhref.html("&#xe606;"))},menu.menuTitle.click(menu.menubindFun),menu.aclick.click(function(){menu.leftsbara.removeClass("liamenu-select"),$(this).addClass("liamenu-select")}),menu.mindhFunc=function(){menu.minlihover=$(".minleftsbar ul:eq(0)>li"),menu.minlihover.hover(function(){menu.hoverSlings=$(this).siblings(".menu-select"),menu.hoverSlings.find(".addhref").html("&#xe605;"),menu.hoverSlings.removeClass("menu-select"),$(this).addClass("menu-select").find(".libor").addClass("minMenusshow"),$(this).find("ul").stop().delay(350).slideDown(150)},function(){$(this).find(".libor").removeClass("minMenusshow"),$(this).find("ul").stop().slideUp(1)})},$(".switchbtn").click(function(){menu.minleftsbar=$(".minleftsbar"),menu.minmenuTitle=$(".minleftsbar ul:eq(0)>li"),menu.leftbarul=menu.leftsbar.find("ul ul"),menu.minleftsbar.length?(menu.menusli.slideDown(200),menu.lis=0,menu.isMinMenu=!1,menu.leftbarul.hide(1,function(){$(this).removeClass("ulupdown")}),menu.logomax.removeClass("logoshowmax"),menu.logomin.removeClass("logoshowmin"),menu.leftsbar.removeClass("minleftsbar"),menu.mainsbar.removeClass("minmainsbar"),menu.leftmenus.addClass("menusscroll"),$(this).find("i").html("&#xe60d;"),menu.menuTitle.bind("click",menu.menubindFun),menu.minmenuTitle.unbind("mouseenter").unbind("mouseleave"),menu.minleftsbar.find(".menu-select .addhref").html("-"),menu.minleftsbar.find(".menu-select ul").slideDown(),menu.menuUpbtn.hide(),menu.menuDownbtn.hide()):(menu.isMinMenu=!0,menu.logomax.addClass("logoshowmax"),menu.logomin.addClass("logoshowmin"),menu.leftsbar.addClass("minleftsbar"),menu.mainsbar.addClass("minmainsbar"),menu.leftmenus.removeClass("menusscroll"),$(this).find("i").html("&#xe60e;"),menu.menuTitle.unbind("click"),menu.mindhFunc(),menu.leftbarul.hide(250,function(){$(this).addClass("ulupdown")}),menuUlChange())}),$(menu.menuUpbtn).click(function(){menu.lis<menu.lisize-1&&(menu.menusli.eq(menu.lis).slideUp(200),menu.lis++)}),$(menu.menuDownbtn).click(function(){menu.lis>0&&(menu.lis--,menu.menusli.eq(menu.lis).slideDown(200))}),$(window).resize(function(){1==menu.isMinMenu&&menuUlChange(),taskupdown()}),$(".searchbor i,.searchbor input").hover(function(){$(this).parent().addClass("show")},function(){$(this).parent().removeClass("show")}),$(".taskcreatewin .morebtn").click(function(){var taskhight=parseInt($(".taskcreatewin").css("height"))-107,iclass=$(".taskcreatewin .morebtn.ischange");iclass.length?($(this).removeClass("ischange").find("i").removeClass("rotate180"),$(this).find("span").css({left:"30px"}).html("点击补充更多任务信息"),$(".scrollbor").removeClass("scroll"),$(".hidebor").stop().slideUp(),$(".taskcreatewin .btnbor").css({top:"335px",height:"100%"})):($(this).addClass("ischange").find("i").addClass("rotate180"),$(this).find("span").css({left:"73px"}).html("收起"),$(".scrollbor").addClass("scroll"),$(".hidebor").stop().slideDown(),$(".taskcreatewin .btnbor").css({top:taskhight+"px",height:"100%"}))}),$scope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){var str="nav"+$location.url().split("/")[1],strs=$location.url().split("/")[2],ul=$("."+str).next();if("navindex"==str&&$("."+str).parent().hasClass("menu-select")&&"set"!=strs&&$("."+str).find("a").trigger("click"),"navmsg"==str&&angular.forEach($(".menus>ul>li>ul"),function(data){"block"==$(data).css("display")&&$(data).prev().trigger("click")}),"none"!=ul.css("display")&&void 0!=ul.css("display")||$("."+str).trigger("click"),"progress"==strs){var route=fromState.url.split("/")[1];"mycreatepro"!=route&&"myinvoepro"!=route&&"openpro"!=route||window.localStorage.setItem("route",route),strs=window.localStorage.getItem("route")}strs&&strs.indexOf("mycreatepro")>-1&&(ul.find("a").removeClass("liamenu-select"),ul.find("a:eq(0)").addClass("liamenu-select")),"roleList"==strs&&(strs="employeelist"),"gradeSettingList"==strs&&(strs="skillList"),"departmentNanoCoinList"!=strs&&"personalNanoCoinSet"!=strs||(strs="personalNanoCoinList"),"myRewardTask"!=strs&&"myClaimRecord"!=strs||(strs="rewardTask"),ul.find("a").each(function(index,ele){$(ele).attr("ui-sref").indexOf(strs)>-1&&($("div.menus").find('a[class="liamenu-select"]').removeClass("liamenu-select"),"reserve"!=strs?$(ele).addClass("liamenu-select"):ul.find("a:eq(0)").addClass("liamenu-select"))})})}()});
IndexMod.controller("HeadCtrl",function($scope,$http,deskModel,$rootScope,$cookieStore,$state){var userInfo=$scope.userInfo={};$rootScope.rootUserInfo=$cookieStore.get("userInfo"),userInfo.mLayer=!1,location.href.indexOf("applymobile")>-1&&(userInfo.mLayer=!0),userInfo.userInfo="",userInfo.skillInfo="",$(".infosbor").click(function(){$(".infoslist").stop().slideToggle(200),$(this).find(".infosbtn i").toggleClass("rotate"),deskModel.getUserInfo($scope)}),$(document).bind("click",function(e){var b1=0==$(e.target).parents(".infoslist").length&&!$(e.target).hasClass("infoslist"),b2=0==$(e.target).parents(".infobor").length&&!$(e.target).hasClass("infobor");b1&&b2&&$(".infoslist").stop().slideUp(200)}),userInfo.hideUser=function(){$(".infoslist").stop().slideUp(200)},userInfo.logout=function(){$cookieStore.remove("userInfo"),$state.go("login",{},{reload:!0}),$http.post("/index.php?r=login/login/logout",{}).success(function(data,status){})},$scope.isShowSet=!0,$scope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){"/index"==toState.url?$scope.isShowSet=!0:$scope.isShowSet=!1})});
IndexMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){$stateProvider.state("main",{module:"private",data:{css:[""]},views:{"":{templateUrl:"appnews/modules/main/view/index.html"},"header@main":{templateUrl:"appnews/modules/common/view/header.html",controller:"HeadCtrl"},"nav@main":{templateUrl:"appnews/modules/common/view/nav.html",controller:"navCtr"},"mainContent@main":{templateUrl:"appnews/modules/common/view/main_content.html",controller:""}}}).state("main.error",{url:"/error",module:"private",views:{"errorContent@main":{templateUrl:"appnews/modules/common/view/error_content.html",controller:""}}}).state("main.index",{url:"/index",module:"private",data:{css:["css/default.css","css/colleague.css"]},views:{"indexContent@main":{templateUrl:"appnews/modules/common/view/index-content.html",controller:"indexCtr"}}}).state("main.index.set",{url:"/set",module:"private",data:{css:["css/default.css","css/colleague.css"]},views:{"indexSet@main":{templateUrl:"appnews/modules/common/view/index-set.html",controller:"indexSetCtr"}}}).state("main.index.taskdetail",{url:"/taskdetail/:task_id",module:"private",data:{css:["css/task.css","css/datetimepicker.css"]},views:{"task_detail@main.index":{templateUrl:"appnews/modules/task/view/task_detail.html",controller:"myTaskCtr"}}}).state("main.index.noticedetail",{url:"/noticedetail/:notice_id",module:"private",data:{css:["css/notice.css"]},views:{"notice_detail@main.index":{templateUrl:"appnews/modules/notice/view/noticedetail.html",controller:"NoticeListCtrl"}}}).state("main.index.applydetail",{url:"/applydetail/:apply_id/:model_id",module:"private",data:{css:["css/apply.css"]},views:{"apply_detail@main.index":{templateUrl:"appnews/modules/common/view/apply_detail.html",controller:"MyApplyListController"}}}).state("main.index.agentdetail",{url:"/agentdetail/:apply_id/:model_id/:model_type",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"apply_agent@main.index":{templateUrl:"appnews/modules/common/view/agent_detail.html",controller:"AgentApplyListController"}}}).state("main.index.workdetail",{url:"/workdetail/:work_id",module:"private",data:{css:["css/workStatement.css","css/lib/datetimepicker.css"]},views:{"workstate_detail@main.index":{templateUrl:"appnews/modules/workStatement/view/workStatement_checked.html",controller:"approveWorkCtrl"}}}).state("main.index.surveydetail",{url:"/surveydetail/:survey_id",module:"private",data:{css:["css/userResearch.css","css/lib/datetimepicker.css"]},views:{"survey_detail@main.index":{templateUrl:"appnews/modules/survey/view/surveydetail.html",controller:"SurveyDetailCtrl"}}})}]);
IndexMod.controller("indexSetCtr",function($scope,$state,$window,$http,deskModel){angular.element("#masklayer1").css("display","block");var index=$scope.index={},index_param=$scope.index_param={};index_param.bigSelected=[],index_param.smallSelected=[],index.bigTpl=[{name:"mytask",is_select:!1},{name:"mywork",is_select:!1},{name:"attendance",is_select:!1},{name:"project",is_select:!1},{name:"notice",is_select:!1},{name:"applyproval",is_select:!1},{name:"scoreboard",is_select:!1},{name:"survey",is_select:!1},{name:"workstate",is_select:!1},{name:"myapply",is_select:!1},{name:"shortcut",is_select:!1}],index.smallTpl=[{name:"s-workstate",is_select:!1},{name:"s-apply",is_select:!1},{name:"s-project",is_select:!1},{name:"s-task",is_select:!1},{name:"s-meeting",is_select:!1},{name:"s-workmate",is_select:!1}],deskModel.getDeskSet($scope),angular.element(".set-close").click(function(){$window.history.back(),angular.element("#masklayer1").css("display","none")}),angular.element(".set-mod").on("click","li",function(){return!$(this).hasClass("set-active")&&angular.element(".set-mod").find(".set-active").length>=6?void alert("只能选择6个功能模块"):($(this).hasClass("set-active")&&"shortcut"==$(this).attr("tpl-name")&&(angular.element(".col-gray.f16").css("visibility","hidden"),angular.element(".set-shortcut").css("visibility","hidden")),$(this).hasClass("set-active")||"shortcut"!=$(this).attr("tpl-name")||(angular.element(".col-gray.f16").css("visibility","visible"),angular.element(".set-shortcut").css("visibility","visible")),void $(this).toggleClass("set-active"))}),angular.element(".set-shortcut").on("click","li",function(){return!$(this).hasClass("shortcut-active")&&angular.element(".set-shortcut").find(".shortcut-active").length>=4?void alert("只能选择4个快捷通道"):void $(this).toggleClass("shortcut-active")}),index.setIndex=function(){index_param.bigSelected=[],index_param.smallSelected=[];var selectShortCut=!1;return angular.element(".set-mod").find("li").each(function(index,item){angular.element(item).hasClass("set-active")&&(index_param.bigSelected.push(angular.element(item).attr("tpl-name")),angular.element(item).attr("tpl-name").indexOf("shortcut")>-1&&(selectShortCut=!0))}),angular.element(".set-shortcut").find("li").each(function(index,item){angular.element(item).hasClass("shortcut-active")&&index_param.smallSelected.push(angular.element(item).attr("tpl-name"))}),selectShortCut&&index_param.smallSelected.length<4?void alert("必须选择4个快捷通道"):void deskModel.editeDeskTpl($scope,$state)}});
IndexMod.factory("deskModel",function($http,$state){var service={};return service.getDeskTpl=function($scope){$http.get("/index.php?r=desk/desk/desktemplet").success(function(data,status){2e4==data.code?(data.data.big.length>0&&($scope.index.bigTpl=data.data.big),data.data.small.length>0&&($scope.index.smallTpl=data.data.small)):($scope.index.bigTpl=["mytask","survey","attendance","project","notice","shortcut"],$scope.index.smallTpl=[{url:"main.workStatement.myWorkStatementTable.edite",class:"bg-blue",title:"工作报告",content:"汇报一下工作情况吧"},{url:"main.apply.application",class:"bg-green",title:"发起申请",content:"请假/报销/设备等申请"},{url:"main.project.createpro",class:"bg-ltgreen",title:"创建项目",content:"创建一个项目"},{url:"main.task.create",class:"bg-blue",title:"创建任务",content:"任务创建快捷入口"}]),angular.forEach($scope.index.bigTpl,function(item,index){switch(item){case"mytask":service.getMyTask($scope);break;case"mywork":service.getMyWork($scope);break;case"attendance":service.getAttendance($scope);break;case"project":service.project($scope);break;case"notice":service.notice($scope);break;case"applyproval":service.myApproval($scope);break;case"myapply":service.myApply($scope);break;case"scoreboard":service.scoreBoard($scope);break;case"survey":service.survey($scope);break;case"workstate":service.workstatApproval($scope)}}),$scope.index.isShowWorkbenchBg=$scope.index.bigTpl.every(function(item){return"blanktpl"==item}),service.drag()})},service.drag=function(){var wrap=angular.element(".sortable");wrap.sortable({revert:1e3,cursor:"move",update:function(){var tplPosition=[];return angular.element(".big-module").each(function(key,val){tplPosition.push(angular.element(val).attr("tpl_name"))}),!(tplPosition.length<1)&&void $http.post("/index.php?r=desk/desk/modify-big",tplPosition).success(function(data,status){2e4==data.code})},start:function(event){angular.element(event.target).css("pointer-events","none")},stop:function(event){angular.element(event.target).css("pointer-events","auto")}})},service.getDeskSet=function($scope){$http.get("/index.php?r=desk/desk/desk-set").success(function(data,status){2e4==data.code&&(data.data.big.length>0&&angular.forEach($scope.index.bigTpl,function(item,index){data.data.big.indexOf(item.name)>-1&&($scope.index.bigTpl[index].is_select=!0),data.data.big.indexOf("shortcut")>-1?(angular.element(".col-gray.f16").css("visibility","visible"),angular.element(".set-shortcut").css("visibility","visible")):(angular.element(".col-gray.f16").css("visibility","hidden"),angular.element(".set-shortcut").css("visibility","hidden"))}),data.data.small.length>0&&angular.forEach($scope.index.smallTpl,function(item,index){data.data.small.indexOf(item.name)>-1&&($scope.index.smallTpl[index].is_select=!0)}))})},service.editeDeskTpl=function($scope,$state){$http.post("/index.php?r=desk/desk/modify-desk",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code?$state.go("^",{},{reload:!0}):alert(data.msg)})},service.getMyTask=function($scope){$http.post("/index.php?r=desk/desk/my-task",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.task=data.data)})},service.getMyWork=function($scope){$http.post("/index.php?r=desk/desk/msg-list",JSON.stringify($scope.index_param)).success(function(data,status){1==data.code&&($scope.index.my_work=data.data)})},service.getAttendance=function($scope){$http.post("/index.php?r=desk/desk/my-attendance",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.attendance=data.data)})},service.project=function($scope){$http.post("/index.php?r=desk/desk/project",JSON.stringify($scope.index_param)).success(function(data,status){function slider(i){if(timeout){i=i.data;var sumPage=(parseFloat(ul.css("left")),parseFloat(ul.css("right")),Math.ceil($scope.index.project.length/2));if(i==-1&&(curPage++,curPage>sumPage))return void curPage--;if(1==i&&(curPage--,curPage<=0))return void curPage++;var left=i==-1?"-=480px":"+=480px";$(".banner ul").is(":animated")||$(".banner ul").animate({left:left},function(){1==i?angular.element(".sign").find('b[class="sign-cur"]').removeClass("sign-cur").prev().addClass("sign-cur"):angular.element(".sign").find('b[class="sign-cur"]').removeClass("sign-cur").next().addClass("sign-cur")}),timeout=!1,setTimeout(function(){timeout=!0},600)}}2e4==data.code&&($scope.index.project=data.data.project_list,$scope.index.project_count=data.data.project_count),$scope.index.project.length>=3?$(".banner-btnl,.banner-btnr").show():$(".banner-btnl,.banner-btnr").hide();for(var ul=angular.element(".banner ul"),lis=Math.ceil($scope.index.project.length/2),i=1,signTem="";i<=lis;i++)signTem+="<b></b>&nbsp;";angular.element(".sign").append(signTem),angular.element(".sign b:first-child").addClass("sign-cur"),ul.css("width",240*$scope.index.project.length+"px");var timeout=!0,curPage=1;$(".banner-btnl").click(1,slider),$(".banner-btnr").click(-1,slider)})},service.notice=function($scope){$http.post("/index.php?r=desk/desk/notice",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.notice=data.data)})},service.myApply=function($scope){$http.post("/index.php?r=desk/desk/my-apply",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.my_apply=data.data)})},service.myApproval=function($scope){$http.post("/index.php?r=desk/desk/my-approval",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.my_approval=data.data)})},service.survey=function($scope){$http.post("/index.php?r=desk/desk/survey",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.survey=data.data)})},service.workstatApproval=function($scope){$http.post("/index.php?r=desk/desk/workstate-approve",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.workstate_approval=data.data)})},service.scoreBoard=function($scope){$http.post("/index.php?r=desk/desk/score-board",JSON.stringify($scope.index_param)).success(function(data,status){2e4==data.code&&($scope.index.score_board=data.data)})},service.getUserInfo=function($scope){$http.post("/index.php?r=desk/desk/user-info",{}).success(function(data,status){1==data.code&&($scope.userInfo.userInfo=data.data.memInfo,$scope.userInfo.skillInfo=data.data.skillInfo,null!=$scope.userInfo.skillInfo?parseInt($scope.userInfo.skillInfo.point)>parseInt($scope.userInfo.skillInfo.nextpoint)?$scope.userInfo.skillInfo.degree=100:$scope.userInfo.skillInfo.degree=parseInt($scope.userInfo.skillInfo.point)/parseInt($scope.userInfo.skillInfo.nextpoint)*100:($scope.userInfo.skillInfo={},$scope.userInfo.skillInfo.level=0,$scope.userInfo.skillInfo.degree=0))})},service});
var ProjectMod=angular.module("ProjectMod",[]);ProjectMod.controller("ProListCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$location,$state,$stateParams,filtersModel,$cookieStore,permissionService){if(!permissionService.checkPermission("ProjectMypartake"))return $state.go("main.index",{},{reload:!1}),!1;var project=$scope.project={},param_project=$scope.param_project={};$location.path().indexOf("/mycreatepro")>0?project.public=1:$location.path().indexOf("/myinvoepro")>0?project.public=2:$location.path().indexOf("/openpro")>0&&(project.public=3),1!=project.public&&2!=project.public&&3!=project.public&&($state.go("^"),alert("没有权限")),project.search_status=0,project.search_begin_time="",project.search_end_time="",project.search_pro_name="",project.isStatusWin=!1,project.arrSearchStatus=[{status:0,statusstr:"状态"},{status:1,statusstr:"未开始"},{status:2,statusstr:"进行中"},{status:3,statusstr:"已完成"}],$scope.page={curPage:1,tempcurPage:1,sumPage:0};var isInit=$stateParams.isInit?$stateParams.isInit:1;if(1==isInit||"undefined"==typeof $cookieStore.get("ProList")){var ProList={};ProList.search_status=0,ProList.search_begin_time="",ProList.search_end_time="",ProList.search_pro_name="",ProList.page=1,ProList.type=1,$cookieStore.put("ProList",ProList)}var ProListCookie=$cookieStore.get("ProList");param_project.search_status=ProListCookie.search_status?ProListCookie.search_status:0,project.search_status=param_project.search_status,angular.element.each(project.arrSearchStatus,function(key,val){val.status==param_project.search_status&&angular.element("#status").html(val.statusstr)}),param_project.search_begin_time=ProListCookie.search_begin_time?ProListCookie.search_begin_time:"",project.search_begin_time=param_project.search_begin_time,param_project.search_end_time=ProListCookie.search_end_time?ProListCookie.search_end_time:"",project.search_end_time=param_project.search_end_time,param_project.search_pro_name=ProListCookie.search_pro_name?ProListCookie.search_pro_name:"",project.search_pro_name=param_project.search_pro_name,param_project.page=ProListCookie.page?ProListCookie.page:1,$scope.page.tempcurPage=param_project.page,param_project.type=ProListCookie.type?ProListCookie.type:1,2==param_project.type&&(angular.element(".changei a").eq(1).addClass("selected"),angular.element(".changei a").eq(0).removeClass("selected")),"undefined"!=typeof $stateParams.list_status&&0!=$stateParams.list_status&&(project.search_status=$stateParams.list_status,param_project.search_status=project.search_status,angular.element.each(project.arrSearchStatus,function(key,val){val.status==param_project.search_status&&angular.element("#status").html(val.statusstr)})),"/project/mycreatepro/0/0"!=$location.path()&&"/project/myinvoepro/0/0"!=$location.path()&&"/project/openpro/0/0"!=$location.path()||projectModel.setInit1($scope),projectModel.getPro($scope,project.public),$scope.page_fun=function(){param_project.page=$scope.page.tempcurPage,projectModel.getPro($scope,project.public)},project.searchButton=function(){return $scope.page={curPage:1,tempcurPage:1,sumPage:0},param_project.page=1,project.search_begin_time>project.search_end_time?(alert("结束时间必须大于开始时间！"),!1):(param_project.search_status=project.search_status,param_project.search_begin_time=project.search_begin_time,param_project.search_end_time=project.search_end_time,param_project.search_pro_name=project.search_pro_name,projectModel.getPro($scope,project.public),void 0)},project.statusWinButton=function(){angular.element("#projectInfo").is(":hidden")?angular.element("#projectInfo").show():angular.element("#projectInfo").hide()},project.selectSearchStatus=function(obj){project.search_status=obj.status,angular.element("#status").html(obj.statusstr),project.isStatusWin=!1,angular.element("#projectInfo").hide()},project.switchButton=function(type){1==type?(angular.element(".changei a").eq(0).addClass("selected"),angular.element(".changei a").eq(1).removeClass("selected")):(angular.element(".changei a").eq(1).addClass("selected"),angular.element(".changei a").eq(0).removeClass("selected")),param_project.type=type},project.draw=function(index,allCount,finishCount){var canvas=angular.element(".propiebor li canvas"),ctx=canvas[index].getContext("2d");ctx.beginPath();var degree=(finishCount/allCount).toFixed(2);ctx.arc(115,115,102,-.5*Math.PI,degree*(2*Math.PI)-Math.PI/2,!1),ctx.lineWidth=25,ctx.lineCap="round",ctx.strokeStyle="#fff",ctx.stroke(),ctx.closePath()},project.goDetail=function(pro_id){projectModel.setInit($scope),$location.path().indexOf("/mycreatepro")>0?$state.go("main.project.mycreatepro.prodetail",{pro_id:pro_id}):$location.path().indexOf("/myinvoepro")>0?$state.go("main.project.myinvoepro.prodetail",{pro_id:pro_id}):$location.path().indexOf("/openpro")>0&&$state.go("main.project.openpro.prodetail",{pro_id:pro_id})},project.goGantt=function(pro_id){projectModel.setInit($scope),$location.path().indexOf("/mycreatepro")>0?$state.go("main.project.mycreatepro.gantt",{pro_id:pro_id,type:1,position:1}):$location.path().indexOf("/myinvoepro")>0?$state.go("main.project.myinvoepro.gantt",{pro_id:pro_id,type:2,position:1}):$location.path().indexOf("/openpro")>0&&$state.go("main.project.openpro.gantt",{pro_id:pro_id,type:3,position:1})},project.goProgress=function(pro_id){projectModel.setInit($scope),$location.path().indexOf("/mycreatepro")>0?$state.go("main.project.progress",{pro_id:pro_id,type:1,position:1}):$location.path().indexOf("/myinvoepro")>0?$state.go("main.project.progress",{pro_id:pro_id,type:2,position:1}):$location.path().indexOf("/openpro")>0&&$state.go("main.project.progress",{pro_id:pro_id,type:3,position:1})},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor").length&&angular.element(".selectbor  ul").hide()}),angular.element(".selecttimebor").bind("click",function(event){$(".selectbor ul").hide()})});
ProjectMod.controller("CreateProCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$cookieStore,$state,permissionService){if(!permissionService.checkPermission("ProjectCreate"))return $state.go("main.index"),!1;var project=$scope.project={},paramobj=$scope.paramobj={};project.userInfo=$cookieStore.get("userInfo"),paramobj.pro_name="",paramobj.public_type=3,paramobj.begin_time="",paramobj.end_time="",paramobj.proMember=[],projectModel.getProCreateMemInfo($scope),project.isDispMemWin=!1,project.allMember=[],projectModel.getMembers($scope,""),project.search_mem="",project.search_mem_temp="",project.isCreateProSuccessWin=!1,project.workDay=0,project.pro_id="",project.SelectMemWin=function(){project.isDispMemWin=!project.isDispMemWin,project.isDispMemWin&&0==project.allMember.length&&projectModel.getMembers($scope)},project.searchAddMem=function(){project.search_mem_temp!=project.search_mem&&(project.search_mem_temp=project.search_mem,projectModel.getMembers($scope))},project.selectMemButton=function(obj){var isMember=1;angular.element.each(paramobj.proMember,function(key,val){val.u_id==obj.u_id&&(isMember=0)}),1==isMember&&(obj.owner=0,paramobj.proMember.push(obj))},project.delProMem=function(index){paramobj.proMember.splice(index,1)},project.addButton=function(){return""==paramobj.pro_name?(alert("项目名称不能为空"),!1):""==paramobj.begin_time||""==paramobj.end_time?(alert("开始时间或结束时间不能为空"),!1):void projectModel.addPro($scope)},project.getWordDay=function(){return""!=paramobj.begin_time&&""!=paramobj.end_time&&void(paramobj.begin_time>paramobj.end_time?project.workDay=0:projectModel.getWorkDay($scope))},project.resetButton=function(){paramobj.pro_name="",paramobj.public_type=3,paramobj.begin_time="",paramobj.end_time="",project.workDay=0;var temp=Array();angular.element.each(paramobj.proMember,function(key,val){1==val.owner&&(temp=val)}),paramobj.proMember=[],paramobj.proMember.push(temp)},project.isCreateTask=function(isCreate){$("#masklayer2").hide(),1==isCreate?$state.go("main.task.create",{pro_id:project.pro_id}):$state.go("main.project.mycreatepro")}});
ProjectMod.controller("EditProCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$stateParams,$state){$("#masklayer1").hide();var project=$scope.project={};project.param_pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project.param_pro_id&&$state.go("^"),1!=$stateParams.type&&2!=$stateParams.type&&3!=$stateParams.type&&($state.go("^"),alert("错误的链接！")),project.type=$stateParams.type;var paramobj=$scope.paramobj={};paramobj.pro_id=0,paramobj.pro_name="",paramobj.public_type=3,paramobj.begin_time="",paramobj.end_time="",paramobj.proMember=[],project.isDispMemWin=!1,project.allMember=[],projectModel.getMembers($scope,""),project.search_mem="",project.search_mem_temp="",project.workDay="",project.isEditTime=!1,projectModel.getProDetailSimp($scope),project.SelectMemWin=function(){project.isDispMemWin=!project.isDispMemWin,project.isDispMemWin&&0==project.allMember.length&&projectModel.getMembers($scope)},project.searchAddMem=function(){project.search_mem_temp!=project.search_mem&&(project.search_mem_temp=project.search_mem,projectModel.getMembers($scope))},project.selectMemButton=function(obj){var isMember=1;angular.element.each(paramobj.proMember,function(key,val){val.u_id==obj.u_id&&(isMember=0)}),1==isMember&&(obj.owner=0,paramobj.proMember.push(obj))},project.delProMem=function(index){paramobj.proMember.splice(index,1)},project.editButton=function(){projectModel.editPro($scope)},project.getWordDay=function(){return""!=paramobj.begin_time&&""!=paramobj.end_time&&void(paramobj.begin_time>paramobj.end_time?project.workDay=0:projectModel.getWorkDay($scope))},project.returnGo=function(){1==project.type?$state.go("main.project.mycreatepro.prodetail",{isInit:0,list_status:0,pro_id:project.param_pro_id}):2==project.type?$state.go("main.project.myinvoepro.prodetail",{isInit:0,list_status:0,pro_id:project.param_pro_id}):$state.go("main.project.openpro.prodetail",{isInit:0,list_status:0,pro_id:project.param_pro_id})}});
ProjectMod.controller("ProDetailCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$stateParams,$state,$location,$cookieStore){$("#masklayer1").show();var project=$scope.project={};$scope.param_project={};project.param_pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project.param_pro_id&&$state.go("^"),project.userInfo=$cookieStore.get("userInfo"),project.proInfo="",project.isDelayWin=!1,project.isCompleteWin=!1,project.isDelWin=!1,project.proMember="",project.delTag=0,project.param_delay_time="",project.param_delay_reason="",project.isPreMenReport=!1,project.paramPreMenReport={},project.paramPreMenReport.u_id="",project.paramPreMenReport.pro_id="",project.proMemReportList="",projectModel.getProDetail($scope),project.delProButton=function(){projectModel.delPro($scope)},project.proDelayWin=function(){$scope.project.param_delay_time=$scope.project.proInfo.delay_time},project.proDelayButton=function(){projectModel.delayPro($scope)},project.proCompleteButton=function(){projectModel.CompletePro($scope)},project.draw=function(index,allCount,finishCount){var canvas=angular.element(".bgw100 canvas"),ctx=canvas[index].getContext("2d");ctx.beginPath();var degree=(finishCount/allCount).toFixed(2);ctx.arc(115,115,102,-.5*Math.PI,degree*(2*Math.PI)-Math.PI/2,!1),ctx.lineWidth=25,ctx.lineCap="round",ctx.strokeStyle="#ffffff",ctx.stroke(),ctx.closePath()},project.openDelayWinButton=function(){project.param_delay_time="",project.param_delay_reason="",project.isDelayWin=!0,$("#masklayer2").show()},project.saveProDelay=function(){projectModel.delayPro($scope)},project.closeDelayWinButton=function(){project.isDelayWin=!1,$("#masklayer2").hide()},project.openCompleteWinButton=function(){project.isCompleteWin=!0,$("#masklayer2").show()},project.proCompleteButton=function(){projectModel.CompletePro($scope)},project.closeCompleteWinButton=function(){project.isCompleteWin=!1,$("#masklayer2").hide()},project.openDelWinButton=function(){project.isDelWin=!0,$("#masklayer2").show()},project.delProButton=function(){projectModel.delPro($scope)},project.closeDelWinButton=function(){project.isDelWin=!1,$("#masklayer2").hide()},project.returnGo=function(){$state.go("^",{isInit:0,list_status:0},{reload:!0})},project.goLog=function(){$location.path().indexOf("/mycreatepro")>0?$state.go("main.project.mycreatepro.prodetail.prolog",{pro_id:project.param_pro_id}):$location.path().indexOf("/myinvoepro")>0?$state.go("main.project.myinvoepro.prodetail.prolog",{pro_id:project.param_pro_id}):$location.path().indexOf("/openpro")>0&&$state.go("main.project.openpro.prodetail.prolog",{pro_id:project.param_pro_id})},project.goGantt=function(pro_id){$location.path().indexOf("/mycreatepro")>0?$state.go("main.project.mycreatepro.gantt",{pro_id:pro_id,type:1,position:2}):$location.path().indexOf("/myinvoepro")>0?$state.go("main.project.myinvoepro.gantt",{pro_id:pro_id,type:2,position:2}):$location.path().indexOf("/openpro")>0&&$state.go("main.project.openpro.gantt",{pro_id:pro_id,type:3,position:2})},project.goProgress=function(pro_id){$location.path().indexOf("/mycreatepro")>0?$state.go("main.project.progress",{pro_id:pro_id,type:1,position:2}):$location.path().indexOf("/myinvoepro")>0?$state.go("main.project.progress",{pro_id:pro_id,type:2,position:2}):$location.path().indexOf("/openpro")>0&&$state.go("main.project.progress",{pro_id:pro_id,type:3,position:2})},project.goEdit=function(pro_id){var type=1;$location.path().indexOf("/mycreatepro")>0?type=1:$location.path().indexOf("/myinvoepro")>0?type=2:$location.path().indexOf("/openpro")>0&&(type=3),$state.go("main.project.editpro",{pro_id:pro_id,type:type})},project.openProMemReport=function(u_id){project.paramPreMenReport.u_id=u_id,project.paramPreMenReport.pro_id=project.param_pro_id,projectModel.getProMemReport($scope),$("#masklayer2").show()},project.closeProMemReport=function(){project.isPreMenReport=!1,project.paramPreMenReport={},project.paramPreMenReport.u_id="",project.paramPreMenReport.pro_id="",project.proMemReportList="",$("#masklayer2").hide()}});
ProjectMod.controller("ProProgressHeadCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$stateParams,$state){var project=$scope.project={},project_param=$scope.project_param={};project_param.pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project_param.pro_id&&(alert("参数错误"),$state.go("^")),1!=$stateParams.type&&2!=$stateParams.type&&3!=$stateParams.type&&(alert("参数错误"),$state.go("^")),project.type=$stateParams.type,1!=$stateParams.position&&2!=$stateParams.position&&(alert("参数错误"),$state.go("^")),project.position=$stateParams.position,project.proInfo="",projectModel.getProProgressHead($scope),project.returnGo=function(){1==project.position?1==project.type?$state.go("main.project.mycreatepro",{isInit:0,list_status:0}):2==project.type?$state.go("main.project.myinvoepro",{isInit:0,list_status:0}):$state.go("main.project.openpro",{isInit:0,list_status:0}):1==project.type?$state.go("main.project.mycreatepro.prodetail",{pro_id:project_param.pro_id,isInit:0,list_status:0}):2==project.type?$state.go("main.project.myinvoepro.prodetail",{pro_id:project_param.pro_id,isInit:0,list_status:0}):$state.go("main.project.openpro.prodetail",{pro_id:project_param.pro_id,isInit:0,list_status:0})},project.goProTaskList=function(pro_id,status,type,position,sum){sum>0&&$state.go("main.project.protasklist",{pro_id:pro_id,status:status,type:type,position:position})}});
ProjectMod.controller("ProProgressListCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$stateParams,$state){var project=$scope.project={},project_param=$scope.project_param={};project_param.pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project_param.pro_id&&(alert("参数错误"),$state.go("^")),project.proInfo="",project.proMember=[],project.proTask=[],project_param.u_id=0,project_param.status=0,project_param.page=0,project.isTaskWin=!1,projectModel.getProProgressList($scope),project.checkTask=function(u_id,status){project_param.page=0,project_param.u_id=u_id,project_param.status=status,$scope.project.proTask=[],projectModel.getProProgressTask($scope)},project.closeTaskWin=function(){project.isTaskWin=!1},project.returnGo=function(){1==project.position?$state.go("^",{isInit:0,list_status:0},{reload:!0}):1==project.type?$state.go("main.project.mycreatepro.prodetail",{pro_id:project_param.pro_id}):2==project.type?$state.go("main.project.myinvoepro.prodetail",{pro_id:project_param.pro_id}):$state.go("main.project.openpro.prodetail",{pro_id:project_param.pro_id})}});
ProjectMod.controller("ProTaskListCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$stateParams,$state){var project=$scope.project={},project_param=$scope.project_param={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},project.taskInfo="",project.proInfo="",project_param.page=1,project_param.pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project_param.pro_id&&(alert("参数错误"),$state.go("^")),project_param.status=$stateParams.status?$stateParams.status:0,1!=project_param.status&&2!=project_param.status&&3!=project_param.status&&(alert("参数错误"),$state.go("^")),projectModel.setTab($scope),1!=$stateParams.type&&2!=$stateParams.type&&3!=$stateParams.type&&(alert("参数错误"),$state.go("^")),project.type=$stateParams.type,1!=$stateParams.position&&2!=$stateParams.position&&(alert("参数错误"),$state.go("^")),project.position=$stateParams.position,projectModel.getProInfo($scope,project_param.pro_id),projectModel.getProTaskListInfo($scope),project.tabButton=function(status){1!=status&&2!=status&&3!=status&&alert("参数错误！"),project_param.status=status,projectModel.setTab($scope),$scope.page={curPage:1,tempcurPage:1,sumPage:0},project_param.page=1,projectModel.getProTaskListInfo($scope)},$scope.page_fun=function(){project_param.page=$scope.page.tempcurPage,projectModel.getProTaskListInfo($scope)}});
ProjectMod.controller("ProGanttCtrl",function($scope,$http,$rootScope,$log,Publicfactory,projectModel,$stateParams,$state,$location,$window,permissionService){$("#masklayer1").hide();var project=$scope.project={},project_param=$scope.project_param={};project.proInfo="",project_param.pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project_param.pro_id&&(alert("参数错误"),$window.history.back()),1!=$stateParams.type&&2!=$stateParams.type&&3!=$stateParams.type&&(alert("参数错误"),$window.history.back()),project.type=$stateParams.type,1==project.type?project.typePerm="ProjectMycreateQuerywork":2==project.type?project.typePerm="ProjectMypartakeQuerywork":3==project.type&&(project.typePerm="ProjectPublicQuerywork"),1!=$stateParams.position&&2!=$stateParams.position&&(alert("参数错误"),$window.history.back()),project.position=$stateParams.position,$scope.data=[],$scope.options={mode:"custom",scale:"day",sortMode:void 0,sideMode:"TreeTable",daily:!1,maxHeight:!1,width:!0,headersFormats:{year:"YYYY",quarter:"[Q]Q YYYY",month:"YYYY年MM月",week:"第w周",day:"D",hour:"H",minute:"HH:mm"},tooltipsDateFormats:"YYYY-MM-DD HH:mm",zoom:1,columns:["model.name","model.tasks[0].leader","from","to"],treeTableColumns:["model.tasks[0].leader","from","to"],taskColumnsName:"任务名",columnsHeaders:{"model.name":"任务名","model.tasks[0].leader":"负责人"},columnsClasses:{"model.name":"gantt-column-name","model.tasks[0].leader":"gantt-column-leader",from:"gantt-column-from",to:"gantt-column-to"},columnsFormatters:{from:function(from){return""},to:function(to){return""},"model.tasks[0].limit":function(model){return model+"天"}},treeHeaderContent:'<i class="fa fa-align-justify"></i> {{getHeader()}}',columnsHeaderContents:{"model.name":'<i class="fa fa-align-justify"></i> {{getHeader()}}',"model.tasks[0].leader":'<i class="fa fa-calendar"></i> {{getHeader()}}',from:'<i class="fa fa-calendar"></i> {{getHeader()}}',to:'<i class="fa fa-calendar"></i> {{getHeader()}}',"model.tasks[0].limit":'<i class="fa fa-calendar"></i> {{getHeader()}}'},autoExpand:"none",taskOutOfRange:"truncate",fromDate:moment(null),toDate:void 0,rowContent:'<i class="fa fa-align-justify"></i> {{row.model.name}}',taskContent:'<i class="fa fa-tasks"></i> {{task.model.name}}',allowSideResizing:!0,labelsEnabled:!0,currentDate:"column",currentDateValue:new Date,draw:!1,readOnly:!1,groupDisplayMode:"group",filterTask:"",filterRow:"",timeFrames:{day:{start:moment("8:00","HH:mm"),end:moment("20:00","HH:mm"),color:"#ACFFA3",working:!0,default:!0},noon:{start:moment("12:00","HH:mm"),end:moment("13:30","HH:mm"),working:!1,default:!0},closed:{working:!1,default:!0},weekend:{working:!1},holiday:{working:!1,color:"red",classes:["gantt-timeframe-holiday"]}},dateFrames:{weekend:{evaluator:function(date){return 6===date.isoWeekday()||7===date.isoWeekday()},targets:["weekend"]},"11-november":{evaluator:function(date){return 10===date.month()&&11===date.date()},targets:["holiday"]}},timeFramesWorkingMode:"hidden",timeFramesNonWorkingMode:"hidden",columnMagnet:"15 minutes",timeFramesMagnet:!0,canDraw:function(event){var isLeftMouseButton=0===event.button||1===event.button;return $scope.options.draw&&!$scope.options.readOnly&&isLeftMouseButton},drawTaskFactory:function(){return{id:utils.randomUuid(),name:"Drawn task",color:"#AA8833"}},api:function(api){$scope.api=api,api.core.on.ready($scope,function(){api.scroll.on.scroll($scope,logScrollEvent),api.core.on.ready($scope,logReadyEvent),api.data.on.remove($scope,addEventName("data.on.remove",logDataEvent)),api.data.on.load($scope,addEventName("data.on.load",logDataEvent)),api.data.on.clear($scope,addEventName("data.on.clear",logDataEvent)),api.data.on.change($scope,addEventName("data.on.change",logDataEvent)),api.tasks.on.add($scope,addEventName("tasks.on.add",logTaskEvent)),api.tasks.on.change($scope,addEventName("tasks.on.change",logTaskEvent)),api.tasks.on.rowChange($scope,addEventName("tasks.on.rowChange",logTaskEvent)),api.tasks.on.remove($scope,addEventName("tasks.on.remove",logTaskEvent)),api.tasks.on.moveBegin&&(api.tasks.on.moveBegin($scope,addEventName("tasks.on.moveBegin",logTaskEvent)),api.tasks.on.moveEnd($scope,addEventName("tasks.on.moveEnd",logTaskEvent)),api.tasks.on.resizeBegin($scope,addEventName("tasks.on.resizeBegin",logTaskEvent)),api.tasks.on.resizeEnd($scope,addEventName("tasks.on.resizeEnd",logTaskEvent))),api.rows.on.add($scope,addEventName("rows.on.add",logRowEvent)),api.rows.on.change($scope,addEventName("rows.on.change",logRowEvent)),api.rows.on.move($scope,addEventName("rows.on.move",logRowEvent)),api.rows.on.remove($scope,addEventName("rows.on.remove",logRowEvent)),api.side.on.resizeBegin($scope,addEventName("labels.on.resizeBegin",logLabelsEvent)),api.side.on.resizeEnd($scope,addEventName("labels.on.resizeEnd",logLabelsEvent)),api.timespans.on.add($scope,addEventName("timespans.on.add",logTimespanEvent)),api.columns.on.generate($scope,logColumnsGenerateEvent),api.rows.on.filter($scope,logRowsFilterEvent),api.tasks.on.filter($scope,logTasksFilterEvent),api.directives.on.new($scope,function(directiveName,directiveScope,element){"ganttTask"===directiveName?(element.bind("click",function(event){event.stopPropagation(),logTaskEvent("task-click",directiveScope.task)}),element.bind("mousedown touchstart",function(event){event.stopPropagation(),$scope.live.row=directiveScope.task.row.model,void 0!==directiveScope.task.originalModel?$scope.live.task=directiveScope.task.originalModel:$scope.live.task=directiveScope.task.model,$scope.$digest()})):"ganttRow"===directiveName?(element.bind("click",function(event){event.stopPropagation(),logRowEvent("row-click",directiveScope.row)}),element.bind("mousedown touchstart",function(event){event.stopPropagation(),$scope.live.row=directiveScope.row.model,$scope.$digest()})):"ganttRowLabel"===directiveName&&(element.bind("click",function(){logRowEvent("row-label-click",directiveScope.row)}),element.bind("mousedown touchstart",function(){$scope.live.row=directiveScope.row.model,$scope.$digest()}))}),api.tasks.on.rowChange($scope,function(task){$scope.live.row=task.row.model})})}},$scope.handleTaskIconClick=function(taskModel){alert("Icon from "+taskModel.name+" task has been clicked.")},$scope.handleRowIconClick=function(rowModel){alert("Icon from "+rowModel.name+" row has been clicked.")},$scope.expandAll=function(){$scope.api.tree.expandAll()},$scope.collapseAll=function(){$scope.api.tree.collapseAll()},$scope.$watch("options.sideMode",function(newValue,oldValue){newValue!==oldValue&&($scope.api.side.setWidth(void 0),$timeout(function(){$scope.api.columns.refresh()}))}),$scope.canAutoWidth=function(scale){return!scale.match(/.*?hour.*?/)&&!scale.match(/.*?minute.*?/)},$scope.getColumnWidth=function(widthEnabled,scale,zoom){if(widthEnabled||!$scope.canAutoWidth(scale))return scale.match(/.*?week.*?/)?150*zoom:scale.match(/.*?month.*?/)?300*zoom:scale.match(/.*?quarter.*?/)?500*zoom:scale.match(/.*?year.*?/)?800*zoom:40*zoom},$scope.clear=function(){$scope.data=[]},$scope.live={},$scope.$watchCollection("live.task",function(task){$scope.live.taskJson=angular.toJson(task,!0),$scope.live.rowJson=angular.toJson($scope.live.row,!0)}),$scope.$watchCollection("live.row",function(row){$scope.live.rowJson=angular.toJson(row,!0),void 0!==row&&void 0!==row.tasks&&row.tasks.indexOf($scope.live.task)<0&&($scope.live.task=row.tasks[0])}),$scope.$watchCollection("live.row.tasks",function(){$scope.live.rowJson=angular.toJson($scope.live.row,!0)});var logScrollEvent=function(left,date,direction){void 0!==date&&$log.info("[Event] api.on.scroll: "+left+", "+(void 0===date?"undefined":date.format())+", "+direction)},logDataEvent=function(eventName){},logTaskEvent=function(eventName,task){},logRowEvent=function(eventName,row){},logTimespanEvent=function(eventName,timespan){},logLabelsEvent=function(eventName,width){},logColumnsGenerateEvent=function(columns,headers){},logRowsFilterEvent=function(rows,filteredRows){},logTasksFilterEvent=function(tasks,filteredTasks){},logReadyEvent=function(){},addEventName=function(eventName,func){return function(data){return func(eventName,data)}};projectModel.getGantt($scope),project.returnGo=function(){1==project.position?projectModel.returnList($scope):1==project.type?$state.go("main.project.mycreatepro.prodetail",{pro_id:project_param.pro_id}):2==project.type?$state.go("main.project.myinvoepro.prodetail",{pro_id:project_param.pro_id}):$state.go("main.project.openpro.prodetail",{pro_id:project_param.pro_id})},project.prowork=function(pro_id,type,position){$state.go("main.project.prowork",{pro_id:pro_id,type:type,position:position})}});
ProjectMod.controller("ProDetailLogCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$stateParams,$state,$location){var project=$scope.project={};$location.path().indexOf("/progress")>0||$("#masklayer1").show(),project.param_pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project.param_pro_id&&$state.go("^"),project.proLog=[],project.pageLength=0,projectModel.getProLog($scope),project.returnGo=function(){$state.go("^"),$location.path().indexOf("/progress")>0||$("#masklayer1").show()}});
ProjectMod.controller("ProMemReportCtrl",function($scope,$http,$rootScope,Publicfactory,projectModel,$stateParams,$state,$location){var project=$scope.project={},param_project=$scope.param_project={};param_project.pro_id=$stateParams.pro_id?$stateParams.pro_id:0,0==project.pro_id&&$state.go("^"),1!=$stateParams.type&&2!=$stateParams.type&&3!=$stateParams.type&&(alert("参数错误"),$state.go("^")),project.type=$stateParams.type,1!=$stateParams.position&&2!=$stateParams.position&&(alert("参数错误"),$state.go("^")),project.position=$stateParams.position,param_project.date="",param_project.page=1,project.reportInfo="",$scope.page={curPage:1,tempcurPage:1,sumPage:0},projectModel.getProMemWorkReport($scope),project.getReport=function(){$scope.page={curPage:1,tempcurPage:1,sumPage:0},param_project.page=1,projectModel.getProMemWorkReport($scope)},$scope.page_fun=function(){param_project.page=$scope.page.tempcurPage,projectModel.getProMemWorkReport($scope)},project.returnGo=function(){1==project.type?$state.go("main.project.mycreatepro.gantt",{pro_id:param_project.pro_id,type:project.type,position:project.position,isInit:0,list_status:0}):2==project.type?$state.go("main.project.myinvoepro.gantt",{pro_id:param_project.pro_id,type:project.type,position:project.position,isInit:0,list_status:0}):$state.go("main.project.openpro.gantt",{pro_id:param_project.pro_id,type:project.type,position:project.position,isInit:0,list_status:0})}});
ProjectMod.factory("projectModel",function($http,$state,$cookieStore,$location,filtersModel,util){var service={};return service.getPro=function($scope,status){$http.post("/index.php?r=project/project/getpro",{public:status,page:$scope.param_project.page,type:$scope.param_project.type,status:$scope.param_project.search_status,begin_time:$scope.param_project.search_begin_time,end_time:$scope.param_project.search_end_time,pro_name:$scope.param_project.search_pro_name}).success(function(data,status){$scope.project.projectlist=data.data.proList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage})},service.getProProgressHead=function($scope){$http.post("/index.php?r=project/project/pro-progress-head",{pro_id:$scope.project_param.pro_id}).success(function(data,status){if(1==data.code){if($scope.chartData=new Array,$scope.chartData[0]=data.data.taskInfo.count-data.data.taskInfo.fcount,$scope.chartData[1]=data.data.taskInfo.fcount,$scope.chartData[2]=data.data.taskInfo.count,0==data.data.taskInfo.count)var temp="";else var temp=100;$scope.colors=["#ff6c60","#57c8f2","#63de6a"],$scope.chartConfig={series:[{data:[{y:parseInt(((data.data.taskInfo.count-data.data.taskInfo.fcount)/data.data.taskInfo.count*100).toFixed(2)),color:$scope.colors[0]},{y:100-parseInt(((data.data.taskInfo.count-data.data.taskInfo.fcount)/data.data.taskInfo.count*100).toFixed(2)),color:$scope.colors[1]},{y:temp,color:$scope.colors[2]}],dataLabels:{enabled:!0,formatter:function(){return this.y+"%"}}}],options:{exporting:{enabled:!1},chart:{type:"bar"},tooltip:{enabled:!1},legend:{enabled:!1}},title:{text:""},yAxis:{currentMax:100,currentMin:0,title:{text:""}},size:{width:975,height:220},xAxis:{categories:[]}},$scope.project.proInfo=data.data.proInfo}else $state.go("^")})},service.getProProgressList=function($scope){$http.post("/index.php?r=project/project/pro-progress-list",{pro_id:$scope.project_param.pro_id}).success(function(data,status){1==data.code?($scope.project.proMember=data.data.proMember,$scope.project.proInfo=data.data.proInfo):$state.go("^")})},service.getProProgressTask=function($scope){$http.post("/index.php?r=project/project/get-pro-mem-status-task",JSON.stringify($scope.project_param)).success(function(data,status){1==data.code?(angular.element.each(data.data.list,function(key,val){$scope.project.proTask.push(val)}),$scope.project_param.page=$scope.project.proTask.length,$scope.project.isTaskWin=!0):$state.go("^")})},service.getProTaskListInfo=function($scope){$http.post("/index.php?r=project/project/pro-task-list-info",JSON.stringify($scope.project_param)).success(function(data,status){1==data.code?($scope.project.taskInfo=data.data.list,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage):$state.go("^")})},service.getProLog=function($scope){$http.post("/index.php?r=project/project/pro-log",{pro_id:$scope.project.param_pro_id,page:$scope.project.pageLength}).success(function(data,status){1==data.code?(angular.element.each(data.data.proLog,function(key,val){var temp=[];temp.date="",temp.week="",temp.subCon=[];var tempCon=[];tempCon.time="",tempCon.u_id="",tempCon.real_name="",tempCon.content="";var is_set=1;angular.element.each($scope.project.proLog,function(key1,val1){val1.date==val.date&&(tempCon.time=val.time,tempCon.u_id=val.u_id,tempCon.real_name=val.real_name,tempCon.content=val.content,tempCon.head_img_path=val.head_img_path+"?"+Date.now(),$scope.project.proLog[key1].subCon.push(tempCon),is_set=0)}),1==is_set&&(temp.date=val.date,temp.week=val.week,tempCon.time=val.time,tempCon.u_id=val.u_id,tempCon.real_name=val.real_name,tempCon.content=val.content,tempCon.head_img_path=val.head_img_path+"?"+Date.now(),temp.subCon.push(tempCon),$scope.project.proLog.push(temp))}),$scope.project.pageLength=$scope.project.pageLength+data.data.proLog.length):$state.go("^")})},service.getProDetail=function($scope){$http.post("/index.php?r=project/project/pro-detail",{pro_id:$scope.project.param_pro_id}).success(function(data,status){1==data.code?(data.data.proMember=util.setImgRand(data.data.proMember),$scope.project.proInfo=data.data.proInfo,$scope.project.proMember=data.data.proMember):(alert(data.msg),$state.go("^"))})},service.addPro=function($scope){$http.post("/index.php?r=project/project/create-pro",JSON.stringify($scope.paramobj)).success(function(data,status){1==data.code?($scope.project.pro_id=data.pro_id,$scope.project.isCreateProSuccessWin=!0,$("#masklayer2").show()):alert(data.msg)})},service.getProDetailSimp=function($scope){$http.post("/index.php?r=project/project/pro-detail-simp",{pro_id:$scope.project.param_pro_id}).success(function(data,status){1==data.code?($scope.paramobj.pro_id=data.data.proInfo.pro_id,$scope.paramobj.pro_name=data.data.proInfo.pro_name,$scope.paramobj.public_type=data.data.proInfo.public_type,$scope.paramobj.begin_time=data.data.proInfo.begin_time_f,$scope.paramobj.end_time=data.data.proInfo.end_time_f,1!=data.data.proInfo.status&&($scope.project.isEditTime=!0),$scope.project.status=data.data.proInfo.status,angular.element.each(data.data.proMember,function(key,val){var temp={};temp.u_id=val.u_id,temp.real_name=val.real_name,temp.head_img=val.head_img_path,temp.owner=val.owner,$scope.paramobj.proMember.push(temp)}),service.getWorkDay($scope)):$state.go("^")})},service.editPro=function($scope){$http.post("/index.php?r=project/project/edit-pro",JSON.stringify($scope.paramobj)).success(function(data,status){1==data.code?($state.go("main.project.mycreatepro",{isInit:0}),alert(data.msg)):alert(data.msg)})},service.delPro=function($scope){$http.post("/index.php?r=project/project/del-pro",{pro_id:$scope.project.param_pro_id}).success(function(data,status){1==data.code?($state.go("main.project.mycreatepro",{isInit:0},{reload:!0}),alert(data.msg)):alert(data.msg)})},service.CompletePro=function($scope){$http.post("/index.php?r=project/project/complete-pro",{pro_id:$scope.project.param_pro_id}).success(function(data,status){1==data.code?($scope.project.isCompleteWin=!1,$("#masklayer2").hide(),service.getProDetail($scope),alert(data.msg)):alert(data.msg)})},service.delayPro=function($scope){$http.post("/index.php?r=project/project/delay-pro",{pro_id:$scope.project.param_pro_id,delay_time:$scope.project.param_delay_time,delay_reason:$scope.project.param_delay_reason}).success(function(data,status){1==data.code?($scope.project.proInfo.delay_time_f=data.data.delay_time_f,$scope.project.proInfo.delay_time=data.data.delay_time,$scope.project.isDelayWin=!1,$("#masklayer2").hide(),alert(data.msg)):alert(data.msg)})},service.getGantt=function($scope){$http.post("/index.php?r=project/project/gantt",{pro_id:$scope.project_param.pro_id}).success(function(data,status){if(1==data.code){for(var i=0,len=data.data.proTask.length;i<len;i++)temp1=data.data.proTask[i].tasks[0].from.split("-"),temp2=data.data.proTask[i].tasks[0].to.split("-"),(temp2[0]-temp1[0]>=1||temp2[1]-temp1[1]>=2)&&($scope.options.width=!0),data.data.proTask[i].tasks[0].from=new Date(temp1[0],temp1[1]-1,temp1[2],temp1[3],temp1[4],temp1[5]),data.data.proTask[i].tasks[0].to=new Date(temp2[0],temp2[1]-1,temp2[2],temp2[3],temp2[4],temp2[5]);$scope.data=data.data.proTask,$scope.project.proInfo=data.data.proInfo}else $state.go("^")})},service.getProCreateMemInfo=function($scope){$scope.$broadcast("loadOpt","block"),$http.post("/index.php?r=project/project/pro-create-mem-info",{}).success(function(data,status,headers,config){data.data=util.setImgRand(data.data),data.data.owner=1,$scope.paramobj.proMember.push(data.data)})},service.getMembers=function($scope){$scope.$broadcast("loadOpt","block"),$http.post("/index.php?r=task/task/allgroupmember",{search:$scope.project.search_mem,lately:$cookieStore.get("lately")}).success(function(data,status,headers,config){$scope.project.allMember=data.data})},service.getWorkDay=function($scope){$scope.$broadcast("loadOpt","block"),$http.post("/index.php?r=project/project/workday",{begin_time:$scope.paramobj.begin_time,end_time:$scope.paramobj.end_time}).success(function(data,status,headers,config){$scope.project.workDay=data.count})},service.setInit=function($scope){var ProList={};ProList.search_status=$scope.param_project.search_status,ProList.search_begin_time=$scope.param_project.search_begin_time,ProList.search_end_time=$scope.param_project.search_end_time,ProList.search_pro_name=$scope.param_project.search_pro_name,ProList.page=$scope.param_project.page,ProList.type=$scope.param_project.type,$cookieStore.put("ProList",ProList)},service.setInit1=function($scope){var ProList={};ProList.search_status=0,ProList.search_begin_time="",ProList.search_end_time="",ProList.search_pro_name="",ProList.page=1,ProList.type=1,$cookieStore.put("ProList",ProList)},service.setTab=function($scope){angular.element(".abtn a").eq(0).removeClass("selected"),angular.element(".abtn a").eq(1).removeClass("selected"),angular.element(".abtn a").eq(2).removeClass("selected"),angular.element(".abtn a").eq($scope.project_param.status-1).addClass("selected")},service.getProInfo=function($scope,pro_id){$http.post("/index.php?r=project/project/pro-per",{pro_id:pro_id}).success(function(data,status,headers,config){$scope.project.proInfo=data.data})},service.getProMemWorkReport=function($scope){$http.post("/index.php?r=project/project/pro-mem-work-report",JSON.stringify($scope.param_project)).success(function(data,status,headers,config){$scope.project.reportInfo=data.data.list,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage,$scope.param_project.date=data.data.date})},service.getProMemReport=function($scope){$http.post("/index.php?r=project/project/pro-mem-report",JSON.stringify($scope.project.paramPreMenReport)).success(function(data,status,headers,config){if(1==data.code){for(var i=0;i<data.data.list.length;i++)data.data.list[i].commit_time_format=filtersModel.filterDateTime(1e3*data.data.list[i].commit_time);$scope.project.proMemReportList=data.data.list,$scope.project.isPreMenReport=!0}else alert(data.msg)})},service.returnList=function($scope){$location.path().indexOf("/mycreatepro")>0?$state.go("main.project.mycreatepro",{isInit:0,list_status:0}):$location.path().indexOf("/myinvoepro")>0?$state.go("main.project.myinvoepro",{isInit:0,list_status:0}):$location.path().indexOf("/openpro")>0&&$state.go("main.project.openpro",{isInit:0,list_status:0})},service});
ProjectMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/project/view/";$stateProvider.state("main.project",{url:"/project",module:"private",data:{css:["css/project.css","css/task.css","css/lib/datetimepicker.css","appnews/lib/angular-gantt/dist/angular-gantt.css","appnews/lib/angular-gantt/dist/angular-gantt-plugins.css","appnews/lib/angular-ui-tree/dist/angular-ui-tree.min.css"]},views:{"projectContent@main":{templateUrl:basePath+"project_content.html"}}}).state("main.project.mycreatepro",{url:"/mycreatepro/:isInit/:list_status",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"prolist.html",controller:"ProListCtrl"}}}).state("main.project.mycreatepro.prodetail",{url:"/prodetail/:pro_id",module:"private",views:{"prodetail@main.project":{templateUrl:basePath+"prodetail.html",controller:"ProDetailCtrl"}}}).state("main.project.mycreatepro.prodetail.prolog",{url:"/prolog/:pro_id",module:"private",views:{"prolog@main.project":{templateUrl:basePath+"prodetaillog.html",controller:"ProDetailLogCtrl"}}}).state("main.project.mycreatepro.gantt",{url:"/gantt/:pro_id/:type/:position",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"progantt.html",controller:"ProGanttCtrl"}}}).state("main.project.myinvoepro",{url:"/myinvoepro/:isInit/:list_status",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"prolist.html",controller:"ProListCtrl"}}}).state("main.project.myinvoepro.prodetail",{url:"/prodetail/:pro_id",module:"private",views:{"prodetail@main.project":{templateUrl:basePath+"prodetail.html",controller:"ProDetailCtrl"}}}).state("main.project.myinvoepro.prodetail.prolog",{url:"/prolog/:pro_id",module:"private",views:{"prolog@main.project":{templateUrl:basePath+"prodetaillog.html",controller:"ProDetailLogCtrl"}}}).state("main.project.myinvoepro.gantt",{url:"/gantt/:pro_id/:type/:position",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"progantt.html",controller:"ProGanttCtrl"}}}).state("main.project.myinvoepro.progress",{url:"/progress/:pro_id/:type/:position",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"proprogress.html",controller:"ProProgressCtrl"}}}).state("main.project.openpro",{url:"/openpro/:isInit/:list_status",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"prolist.html",controller:"ProListCtrl"}}}).state("main.project.openpro.prodetail",{url:"/prodetail/:pro_id",module:"private",views:{"prodetail@main.project":{templateUrl:basePath+"prodetail.html",controller:"ProDetailCtrl"}}}).state("main.project.openpro.prodetail.prolog",{url:"/prolog/:pro_id",module:"private",views:{"prolog@main.project":{templateUrl:basePath+"prodetaillog.html",controller:"ProDetailLogCtrl"}}}).state("main.project.openpro.gantt",{url:"/gantt/:pro_id/:type/:position",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"progantt.html",controller:"ProGanttCtrl"}}}).state("main.project.createpro",{url:"/createpro",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"createpro.html",controller:"CreateProCtrl"}}}).state("main.project.editpro",{url:"/editpro/:pro_id/:type",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"editpro.html",controller:"EditProCtrl"}}}).state("main.project.progress",{url:"/progress/:pro_id/:type/:position",module:"private",views:{"progress_head@main.project":{templateUrl:basePath+"proprogress_head.html",controller:"ProProgressHeadCtrl"},"progress_list@main.project":{templateUrl:basePath+"proprogress_list.html",controller:"ProProgressListCtrl"}}}).state("main.project.progress.list",{url:"/list/:pro_id",module:"private",views:{"progress_list@main.project":{templateUrl:basePath+"proprogress_list.html",controller:"ProProgressListCtrl"}}}).state("main.project.progress.list.log",{url:"/log/:pro_id",module:"private",views:{"progress_list_log@main.project":{templateUrl:basePath+"proprogress_log.html",controller:"ProDetailLogCtrl"}}}).state("main.project.protasklist",{url:"/protasklist/:pro_id/:status/:type/:position",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"protasklist.html",controller:"ProTaskListCtrl"}}}).state("main.project.prowork",{url:"/prowork/:pro_id/:type/:position",module:"private",views:{"mycreatepro@main.project":{templateUrl:basePath+"prowork.html",controller:"ProMemReportCtrl"}}})}]);
var TaskMod=angular.module("TaskMod",[]);TaskMod.controller("taskCtrl",function($scope,$http,$rootScope,Publicfactory,taskModel,$timeout){function taskupdown(){var taskhight=parseInt($(".taskcreatewin").css("height"))-107,iclass=$(".taskcreatewin .morebtn.ischange");iclass.length?$(".taskcreatewin .btnbor").css({top:taskhight+"px",height:"100%"}):$(".taskcreatewin .btnbor").css({top:"395px",height:"100%"})}var task=$scope.task={};task.querymember="",task.querymemberok="",task.member=[{name:"a刘新宇"},{name:"b刘静b"},{name:"吴京"},{name:"成龙1"},{name:"成龙2"},{name:"杨亮"}],task.taskType=[{label:"指派任务",nums:1},{label:"悬赏任务",nums:2}],task.taskTypeDefaultSelect=task.taskType[0],task.datestart="",task.dateend="",task.title="",task.taskDesc="",task.point=1e3,task.addfiles=[],task.addfilesbtn=function(){task.addfiles=["232343.png"]};var taskpointReg=($(".taskpoint").val().replace(/(^\s*)/g,""),/^[0-9]*$/);task.pointkeyup=function(){if(console.log($(".taskpoint").val()),!taskpointReg.test($(".taskpoint").val()))return alert("积分只能是大于0的整整数，最大值为自己的总积分!"),$(".taskpoint").val(""),!1},task.caogao=function(){return task.title=task.title.replace(/(^\s*)/g,""),""==task.title?(alert("请填写任务标题!"),!1):Publicfactory.checkEnCnstrlen(task.title)>100?(alert("任务标题长度不能大于50个字"),!1):void 0},$(".taskcreatewin .morebtn").click(function(){var taskhight=parseInt($(".taskcreatewin").css("height"))-107,iclass=$(".taskcreatewin .morebtn.ischange");iclass.length?($(this).removeClass("ischange").find("i").removeClass("rotate180"),$(this).find("span").css({left:"30px"}).html("点击补充更多任务信息"),$(".scrollbor").removeClass("scroll"),$(".hidebor").stop().slideUp(),$(".taskcreatewin .btnbor").css({top:"395px",height:"100%"})):($(this).addClass("ischange").find("i").addClass("rotate180"),$(this).find("span").css({left:"73px"}).html("收起"),$(".scrollbor").addClass("scroll"),$(".hidebor").stop().slideDown(),$(".taskcreatewin .btnbor").css({top:taskhight+"px",height:"100%"}))}),$(window).resize(function(){taskupdown()})});
var TaskMod=angular.module("TaskMod",[]);TaskMod.controller("myTaskCtr",function($scope,$http,myTaskModel,doTaskModel,$cookieStore,$state,$stateParams,Publicfactory,permissionService){if(!permissionService.checkPermission("TaskMytask"))return $state.go("main.index",{},{reload:!1}),!1;var taskObj=$scope.taskobj={};taskObj.cookieUid=$cookieStore.get("userInfo").u_id,taskObj.operationLogList=[],taskObj.operationLog=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.proId="",taskObj.taskType="",taskObj.btime="",taskObj.etime="",taskObj.taskTypeName="类型",taskObj.taskProCtr=!1,taskObj.taskStatusName="状态",taskObj.taskProName="项目",taskObj.status="",taskObj.taskTitle="",taskObj.overtime="",taskObj.pagesize="",taskObj.current="",$scope.myTaskList=[],$scope.taskDetail=[],$scope.myObject=[],$scope.taskDetail.workNoteFiles=[],taskObj.taskDetailWin=!1,$scope.temp_task_type=1,taskObj.starArr=[1,2,3,4,5],$scope.taskDetail.work_note="",myTaskModel.getProjectInfo($scope,2),myTaskModel.getMyTaskList($scope,taskObj.proId,taskObj.taskType,taskObj.status,taskObj.btime,taskObj.etime,taskObj.taskTitle,taskObj.overtime,taskObj.pagesize,taskObj.current),taskObj.taskDetail=function(taskId){myTaskModel.getTaskDetailInfo($scope,taskId)},taskObj.taskDetailPopup=function(){$("#masklayer1").hide(),taskObj.taskDetailWin=!1},taskObj.operationLogPopup=function(taskId){taskObj.operationLog=!0,myTaskModel.getOperationTask($scope,taskId,1)},void 0!=$stateParams.task_id&&""!=$stateParams.task_id&&taskObj.taskDetail($stateParams.task_id),taskObj.showTaskTypeis=!0,taskObj.showTaskType=function($event){$("#taskStatus,#projectInfo").hide(),angular.element("#taskType").is(":hidden")?angular.element("#taskType").show():angular.element("#taskType").hide()},taskObj.selectTaskType=function(taskTypeName,taskType){taskObj.taskTypeName=taskTypeName,taskObj.taskType=taskType,angular.element("#taskType").hide()},taskObj.showStatusNameis=!0,taskObj.showStatusName=function(){$("#taskType,#projectInfo").hide(),angular.element("#taskStatus").is(":hidden")?angular.element("#taskStatus").show():angular.element("#taskStatus").hide()},taskObj.selectStatusName=function(taskStatusName,status){taskObj.taskStatusName=taskStatusName,taskObj.status=status,angular.element("#taskStatus").hide()},taskObj.proStatusCtr=function(){taskObj.taskProCtr=!1,angular.element("#taskType").hide(),angular.element("#taskStatus").hide()},taskObj.showStatus=function(){$("#taskStatus,#taskType").hide(),angular.element("#projectInfo").is(":hidden")?angular.element("#projectInfo").show():angular.element("#projectInfo").hide()},taskObj.getSelectPro=function(proId,proName){taskObj.proId=proId,taskObj.taskProName=proName,angular.element("#projectInfo").hide()},taskObj.selectProWin=function(a){taskObj.aaa=[{a:1,b:"ceshi"},{a:2,b:"sdfsdfsd"}]},taskObj.taskSearch=function(){return $scope.taskobj.searchstarttime?taskObj.btime=Date.parse($scope.taskobj.searchstarttime)/1e3:taskObj.btime="",$scope.taskobj.searchendtime?taskObj.etime=Date.parse($scope.taskobj.searchendtime)/1e3:taskObj.etime="",taskObj.btime>taskObj.etime&&taskObj.btime&&taskObj.etime?void alert("开始时间不能大于结束时间","success",2e3):($scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.taskTitle=$scope.taskobj.taskTitle,7==taskObj.status&&(taskObj.overtime=7,taskObj.status=""),void myTaskModel.getMyTaskList($scope,taskObj.proId,taskObj.taskType,taskObj.status,taskObj.btime,taskObj.etime,taskObj.taskTitle,taskObj.overtime,taskObj.num,taskObj.current))},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&angular.element(".selectbor  ul").hide()}),angular.element(".selecttimebor").bind("click",function(event){$(".selectbor ul").hide()}),$scope.taskPaging=function(){taskObj.currentPage=$scope.page.tempcurPage,myTaskModel.getMyTaskList($scope,taskObj.proId,taskObj.taskType,taskObj.status,taskObj.btime,taskObj.etime,taskObj.taskTitle,taskObj.overtime,taskObj.pagesize,taskObj.currentPage)},taskObj.acceptTask=function(taskId){doTaskModel.acceptTask(taskId,$scope)},taskObj.refuseTaskPop=function(show){taskObj.refuse_reason="",$scope.showRefuse=show,$("#masklayer2").show(),show||$("#masklayer2").hide()},taskObj.refuse_reason="",$scope.showRefuse=!1,taskObj.refuseTask=function(taskId){return Publicfactory.checkEnCnstrlen(taskObj.refuse_reason)>100||taskObj.refuse_reason.length<=0||""==taskObj.refuse_reason.trim()||"undefined"==typeof taskObj.refuse_reason?(alert("拒绝理由不能为空且长度不能大于50个字"),!1):(taskObj.refuse_reason=taskObj.refuse_reason.replace(/\n/g,"<br/>"),taskObj.refuse_reason=taskObj.refuse_reason.replace(/\s/g,"&nbsp;"),doTaskModel.refuseTask(taskId,taskObj.refuse_reason,$scope),taskObj.refuseTaskPop(!1),void 0)},$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=task/task/upload&type=2&taskType="+$scope.temp_task_type+"&taskId="+$scope.taskDetail.task_id,uploader.onCompleteItem=function(fileItem,response,status,headers){return 2e4!=response.code&&response.msg?(alert(response.msg,"success",2e3),!1):void(void 0==response.data&&void 0==response.data.name||$scope.taskDetail.workNoteFiles.push(response.data))}},taskObj.delFiles=function(index,attId){$http.get("/index.php?r=task/task/del-att&attId="+attId).success(function(data){2e4==data.code&&$scope.taskDetail.workNoteFiles&&$scope.taskDetail.workNoteFiles.splice(index,1)})},$scope.taskDetail.work_note="",taskObj.auditTask=function(taskId){return null!=$scope.taskDetail.work_note&&Publicfactory.checkEnCnstrlen($scope.taskDetail.work_note)>2e3?(alert("工作笔记内容不能超过1000字！"),!1):void doTaskModel.auditTask(taskId,$scope.taskDetail.work_note,$scope)}}),TaskMod.controller("myClaimRecordCtr",function($scope,$http,$state,myClaimRecordModel){var taskObj=$scope.taskobj={};taskObj.myClaimRecorList=[],taskObj.task_id="",taskObj.pageSize="",taskObj.curPage="",$scope.page={curPage:1,tempcurPage:1,sumPage:0},myClaimRecordModel.getMyClaimRecordList($scope,taskObj.pageSize,taskObj.curPage),$scope.taskPaging=function(){taskObj.currentPage=$scope.page.tempcurPage,myClaimRecordModel.getMyClaimRecordList($scope,taskObj.pageSize,taskObj.currentPage)},taskObj.myClaimRecordDetail=function(taskId){taskObj.task_id=taskId,taskObj.taskDetailWin=!0},taskObj.taskDetailPopup=function(){taskObj.taskDetailWin=!1}});
TaskMod.controller("myReleaseTaskCtr",function($scope,$rootScope,$cookieStore,$stateParams,$timeout,$http,myReleaseTaskModel,myTaskModel,taskModel,doTaskModel,$state,Publicfactory,noticeService){function starpj(item,str,$event){var parentdiv;parentdiv="quality"==str?angular.element("#qualityStar"):angular.element("#speedStar");for(var i=0;i<item;i++)parentdiv.find("li").eq(i).find("i").addClass("selected");for(var i=item;i<5;i++)parentdiv.find("li").eq(i).find("i").removeClass("selected");"quality"==str&&(taskObj.quality_score=item),"speed"==str&&(taskObj.speed_score=item)}var taskObj=$scope.taskobj={};taskObj.cookieUid=$cookieStore.get("userInfo").u_id,taskObj.charge="",taskObj.operationLogList=[],taskObj.operationLog=!1,taskObj.proId="",taskObj.taskType="",taskObj.status="",taskObj.btime="",taskObj.etime="",taskObj.taskTitle="",taskObj.overtime="",taskObj.taskTypeName="类型",taskObj.taskStatusName="状态",taskObj.taskProName="项目",taskObj.taskProCtr=!1,taskObj.num="",taskObj.current="",taskObj.currentPage="",taskObj.noticeService=noticeService,$scope.myReleaseTaskList=[],$scope.taskDetail=[],$scope.myObject=[],$scope.refuse_reason="",$scope.showPass=!0,$scope.showCheck=!1,$scope.isShow=!0,$scope.detailPopWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.starArr=[1,2,3,4,5],taskObj.is_quality_select=!1,taskObj.is_speed_select=!1,taskObj.quality_score=0,taskObj.speed_score=0,myReleaseTaskModel.getProjectInfo($scope,2),myReleaseTaskModel.getReleaseTaskList($scope,taskObj.proId,taskObj.taskType,taskObj.status,taskObj.btime,taskObj.etime,taskObj.taskTitle,taskObj.overtime,taskObj.num,taskObj.current),taskObj.selectProWin=function(a){taskObj.aaa=[{a:1,b:"ceshi"},{a:2,b:"sdfsdfsd"}]},taskObj.timestamp3=(new Date).getTime(),taskObj.operationLogPopup=function(taskId){taskObj.operationLog=!0,myTaskModel.getOperationTask($scope,taskId,1)},taskObj.releaseTaskSearch=function(){return $scope.taskobj.searchstarttime?taskObj.btime=Date.parse($scope.taskobj.searchstarttime)/1e3:taskObj.btime="",$scope.taskobj.searchendtime?taskObj.etime=Date.parse($scope.taskobj.searchendtime)/1e3:taskObj.etime="",taskObj.btime>taskObj.etime&&taskObj.etime&&taskObj.btime?void alert("开始时间不能大于结束时间！"):($scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.taskTitle=$scope.taskobj.taskTitle,7==taskObj.status&&(taskObj.overtime=7,taskObj.status=""),void myReleaseTaskModel.getReleaseTaskList($scope,taskObj.proId,taskObj.taskType,taskObj.status,taskObj.btime,taskObj.etime,taskObj.taskTitle,taskObj.overtime,taskObj.num,taskObj.current))},taskObj.getSelectPro=function(proId,proName){taskObj.proId=proId,taskObj.taskProName=proName,angular.element("#projectInfo").hide()},taskObj.showStatus=function(){$("#releaseTaskStatus,#releaseTaskStatus").hide(),angular.element("#projectInfo").is(":hidden")?angular.element("#projectInfo").show():angular.element("#projectInfo").hide()},$scope.taskPaging=function(){taskObj.currentPage=$scope.page.tempcurPage,myReleaseTaskModel.getReleaseTaskList($scope,taskObj.proId,taskObj.taskType,taskObj.status,taskObj.btime,taskObj.etime,taskObj.taskTitle,taskObj.overtime,taskObj.num,taskObj.currentPage)},taskObj.taskDetail=function(taskId){myReleaseTaskModel.getReleaseTaskDetailInfo($scope,taskId),$scope.detailPopWin=!0,$scope.showCheck=!1,$("#masklayer1").show()},void 0!=$stateParams.task&&""!=$stateParams.task&&taskObj.taskDetail($stateParams.task),taskObj.taskDetailPopup=function(){$scope.detailPopWin=!1,$scope.showCheck=!1,$("#masklayer1").hide()},taskObj.showReleaseTaskType=function(){$("#releaseTaskStatus,#projectInfo").hide(),angular.element("#releaseTaskType").is(":hidden")?angular.element("#releaseTaskType").show():angular.element("#releaseTaskType").hide()},taskObj.selectReleaseTaskType=function(taskTypeName,taskType){taskObj.taskTypeName=taskTypeName,taskObj.taskType=taskType,angular.element("#releaseTaskType").hide()},taskObj.showReleaseStatusName=function(){$("#releaseTaskType,#projectInfo").hide(),angular.element("#releaseTaskStatus").is(":hidden")?angular.element("#releaseTaskStatus").show():angular.element("#releaseTaskStatus").hide()},taskObj.selectReleaseStatusName=function(taskStatusName,status){taskObj.taskStatusName=taskStatusName,taskObj.status=status,angular.element("#releaseTaskStatus").hide()},taskObj.selectPass=function(){$scope.showPass=!0,angular.element("#show_not_pass").removeClass("selected"),angular.element("#show_pass").addClass("selected")},taskObj.selectNotPass=function(){$scope.showPass=!1,taskObj.refuse_reason="",angular.element("#show_not_pass").addClass("selected"),angular.element("#show_pass").removeClass("selected")},taskObj.mouseoverhand=function(item,str,$event){0==taskObj.is_quality_select&&starpj(item,str,$event)},taskObj.mouseoverhand2=function(item,str,$event){0==taskObj.is_speed_select&&starpj(item,str,$event)},taskObj.mleavequality=function(str){0==taskObj.is_quality_select&&(taskObj.quality_score=0,angular.element("#qualityStar li").find("i").removeClass("selected"))},taskObj.mleavequality2=function(str){0==taskObj.is_speed_select&&(taskObj.speed_score=0,angular.element("#speedStar li").find("i").removeClass("selected"))},taskObj.selectedhand=function(item,str,$event){starpj(item,str,$event),"quality"==str&&(taskObj.is_quality_select=!0),"speed"==str&&(taskObj.is_speed_select=!0)},taskObj.refuse_reason="";var redo=function(taskId){if(Publicfactory.checkEnCnstrlen(taskObj.refuse_reason)>100||taskObj.refuse_reason.length<=0||""==taskObj.refuse_reason.trim()||"undefined"==typeof taskObj.refuse_reason)return alert("拒绝通过理由不能大于50个字且不能为空"),!1;taskObj.refuse_reason=taskObj.refuse_reason.replace(/\n/g,"<br/>"),taskObj.refuse_reason=taskObj.refuse_reason.replace(/\s/g,"&nbsp;");var rePointer="";void 0!=$scope.selectedMember.u_id&&(rePointer=$scope.selectedMember.u_id),doTaskModel.redoTask(taskId,taskObj.refuse_reason,rePointer,$scope)};taskObj.check=function(isShow){$scope.selectedMember={},$scope.showCheck=isShow,$timeout(function(){var scrollTopH=$("#taskDetailPopup .scrollbor");scrollTopH.scrollTop(5e3)}),taskObj.quality_score=0,taskObj.speed_score=0,angular.element(".taskdetailwin .revieweditbor li i").removeClass("selected")},taskObj.submitViews=function(taskId){var scrollborgo=angular.element(".taskdetailwin .scrollbor");if(scrollborgo.scrollTop(scrollborgo.height()+1e3),!$scope.showPass)return void redo(taskId);var data={};if($scope.taskobj.cookieUid!=$scope.taskobj.charge){if(!taskObj.quality_score||!taskObj.speed_score)return angular.element("#qualityStar").focus(),void alert("请选择质量和速度评分");data.quality=taskObj.quality_score,data.speed=taskObj.speed_score}else data.quality=0,data.speed=0;doTaskModel.doneTask(taskId,data,2,$scope),taskObj.quality_score=0,taskObj.speed_score=0,angular.element(".taskdetailwin .revieweditbor li i").removeClass("selected")};$scope.task={};$scope.task.groupMembers=[],taskObj.searchMemberRealName="",$scope.selectedMember={},$scope.task.selectedMember={},taskObj.openSelectedP=function(){$(".menbersearchbor").show(),0==$scope.task.groupMembers.length&&taskModel.getMembers($scope,"")},taskObj.closeSelectedP=function(){$(".menbersearchbor").hide(),$scope.searchMemberRealName=""};var timer="";taskObj.allott=function(issearch){clearTimeout(timer),timer=setTimeout(function(){var search="";1==issearch&&(search=taskObj.searchMemberRealName),1!=issearch&&(search=""),taskModel.getMembers($scope,search)},500)},taskObj.selectMember=function($selecedMember){$scope.selectedMember=$selecedMember,taskObj.closeSelectedP()},taskObj.delmember=function(){$scope.selectedMember={}},taskObj.editeTask=function(taskId,taskType){$state.go("main.task.myReleaseTask.edite",{task_id:taskId,task_type:1,taskType:taskType},{reload:!0})},$scope.pointcloseWin=!1,taskObj.shutDownTask=function(taskId){$("#masklayer2").show(),$scope.pointcloseWin=!0},taskObj.shutDownTaskCloseWin=function(){$("#masklayer2").hide(),$scope.pointcloseWin=!1},taskObj.shutDownTaskdata=function(taskId){$("#masklayer2").hide(),$scope.pointcloseWin=!1,doTaskModel.closeTask(taskId,1,$scope)},$scope.deletecloseWin=!1,$scope.deletecloseWinindex="",taskObj.deleteTask=function(taskId){$("#masklayer2").show(),$scope.deletecloseWin=!0,$scope.deletecloseWinindex=taskId},taskObj.deleteTaskgo=function(){doTaskModel.deleteTask($scope.deletecloseWinindex,1,$scope),$("#masklayer2").hide(),$scope.deletecloseWin=!1},taskObj.deleteTaskexit=function(){$("#masklayer2").hide(),$scope.deletecloseWin=!1},$scope.showDelay=!1,$scope.delay_reason="",$scope.delaytime="",taskObj.showDelay=function(show){$scope.showDelay=show,show?$("#masklayer2").show():$("#masklayer2").hide(),$scope.delaytime="",$scope.delay_reason=""},taskObj.delayTask=function(taskId){var delayTime=angular.element("#delaytime").val(),timestamp=Date.parse(new Date(delayTime));return timestamp/=1e3,void 0==delayTime||""==delayTime?(alert("请选择延迟时间"),!1):timestamp<$scope.taskDetail.end_time?(alert("延期操作时间必须大于原定结束时间"),!1):timestamp<$scope.taskDetail.delay_time?(alert("延期操作时间必须大于上次延期时间"),!1):Publicfactory.checkEnCnstrlen($scope.delay_reason)<=0?(alert("延期原因不能为空"),!1):Publicfactory.checkEnCnstrlen($scope.delay_reason)>100?(alert("延期任务原因长度不能大于50个字"),!1):void doTaskModel.delayTask(taskId,1,$scope.delaytime,$scope.delay_reason,$scope)},taskObj.publishTask=function(taskId){doTaskModel.publishTask(taskId,1,$scope)},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&angular.element(".selectbor  ul").hide()}),angular.element(".selecttimebor").bind("click",function(event){$(".selectbor ul").hide()})});
TaskMod.controller("rewardTaskCtr",function($scope,$http,rewardTaskModel,doTaskModel,$cookieStore,myTaskModel,$state,$stateParams){var taskObj=$scope.taskobj={};$scope.rewardList=[],$scope.taskDetail=[],taskObj.operationLogList=[],taskObj.operationLog=!1,taskObj.rewardPoupeCtr=!1,taskObj.applicationRecord="ui-widget-winbor tablelistwin of minscroll none",taskObj.status="",taskObj.task_id="",taskObj.statusName="状态",taskObj.taskTitle="",taskObj.num="",taskObj.current="",taskObj.type=1,taskObj.userInfo=$cookieStore.get("userInfo"),taskObj.orgId=taskObj.userInfo.org.org_id,$scope.detailPopWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.operationLogPopup=function(taskId){taskObj.operationLog=!0,myTaskModel.getOperationTask($scope,taskId,2)},taskObj.taskStatusClick=function(){angular.element("#taskStatusClickbor").is(":hidden")?angular.element("#taskStatusClickbor").show():angular.element("#taskStatusClickbor").hide()},rewardTaskModel.getRewardTaskList($scope,taskObj.status,taskObj.taskTitle,taskObj.num,taskObj.current,taskObj.orgId),taskObj.rewardSearch=function(){$scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.taskTitle=$scope.taskobj.taskTitle,rewardTaskModel.getRewardTaskList($scope,taskObj.status,taskObj.taskTitle,taskObj.num,taskObj.current,taskObj.orgId)},$scope.taskPaging=function(){taskObj.currentPage=$scope.page.tempcurPage,rewardTaskModel.getRewardTaskList($scope,taskObj.status,taskObj.taskTitle,taskObj.num,taskObj.currentPage,taskObj.orgId)},taskObj.selectStatus=function(statusName,status){taskObj.statusName=statusName,taskObj.status=status,angular.element("#taskStatusClickbor").hide()},taskObj.getRewardDetail=function(taskId){rewardTaskModel.getRewardDetailList($scope,taskId),$("#masklayer1").show(),$scope.detailPopWin=!0},void 0!=$stateParams.task&&""!=$stateParams.task&&taskObj.getRewardDetail($stateParams.task),taskObj.taskDetailPopup=function(){taskObj.pointer="",taskObj.pointerName="",$("#masklayer1").hide(),$("#masklayer2").hide(),$scope.detailPopWin=!1},taskObj.claimTask=function(taskId){taskObj.task_id=taskId,doTaskModel.claimTask(taskId,$scope)},taskObj.cancelTask=function(taskId){doTaskModel.cancelTask(taskId,$scope)},taskObj.pointer="",taskObj.pointerName="",taskObj.selectPointer=function(pointer,pointerName,$event){var el=$event.target;$scope.taskobj.taskId>0?(taskObj.pointer=pointer,taskObj.pointerName=pointerName,angular.element(el).addClass("select"),angular.element(el).prevAll().removeClass("select"),angular.element(el).nextAll().removeClass("select")):alert("请选择任务！")},taskObj.pointTask=function(type){return console.log(type),2==type?(angular.element("#pointTaskPop").hide(),$("#masklayer1").hide(),void $("#masklayer2").hide()):void(2!=$scope.taskobj.taskDetail.status&&(taskObj.pointer>0?doTaskModel.pointTask($scope.taskobj.taskId,pointer,$scope):alert("请选择任务！")))},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&angular.element(".selectbor  ul").hide()})}),TaskMod.controller("myRewardTaskCtr",function($scope,$http,$cookieStore,myRewardTaskModel,doTaskModel,myTaskModel,$state,$timeout,$stateParams){var taskObj=$scope.taskobj={};$scope.rewardList=[],$scope.myRewardDetailList=[],taskObj.operationLogList=[],taskObj.operationLog=!1,taskObj.applicationRecord="ui-widget-winbor tablelistwin of minscroll none",taskObj.status="",taskObj.task_id="",taskObj.statusCtr=!1,taskObj.statusName="状态",taskObj.taskTitle="",taskObj.pageSize="",taskObj.curPage="",taskObj.type=2,$scope.detailPopWin=!1,$scope.pointWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.userInfo=$cookieStore.get("userInfo"),myRewardTaskModel.getMyRewardTaskList($scope,taskObj.status,taskObj.taskTitle,taskObj.pageSize,taskObj.curPage),taskObj.operationLogPopup=function(taskId){taskObj.operationLog=!0,myTaskModel.getOperationTask($scope,taskId,2)},taskObj.myRewardSearch=function(){$scope.page={curPage:1,tempcurPage:1,sumPage:0},taskObj.taskTitle=$scope.taskobj.taskTitle,myRewardTaskModel.getMyRewardTaskList($scope,taskObj.status,taskObj.taskTitle,taskObj.pageSize,taskObj.curPage)},taskObj.taskSearchPopupCtr=function(){angular.element("#taskSearchPopupCtr").is(":hidden")?angular.element("#taskSearchPopupCtr").show():angular.element("#taskSearchPopupCtr").hide()},taskObj.selectStatus=function(statusName,status){taskObj.statusName=statusName,taskObj.status=status,angular.element("#taskSearchPopupCtr").hide()},$scope.taskPaging=function(){taskObj.currentPage=$scope.page.tempcurPage,myRewardTaskModel.getMyRewardTaskList($scope,taskObj.status,taskObj.taskTitle,taskObj.pageSize,taskObj.currentPage)},taskObj.getMyRewardDetail=function(taskId){myRewardTaskModel.getMyRewardDetailList($scope,taskId),$scope.detailPopWin=!0,$("#masklayer1").show()},void 0!=$stateParams.task&&""!=$stateParams.task&&taskObj.getMyRewardDetail($stateParams.task),taskObj.taskDetailPopup=function(){taskObj.pointer="",taskObj.pointerName="",$scope.detailPopWin=!1,$("#masklayer1").hide()},taskObj.pointer="",taskObj.pointerName="",taskObj.selectPointer=function(pointer,pointerName,$event){var el=$event.target;angular.element(el).hasClass("pointer")||(el=angular.element(el).parents("li").eq(0)),$scope.taskDetail.task_id>0?(taskObj.pointer=pointer,taskObj.pointerName=pointerName,el.addClass("selected"),el.prevAll().removeClass("selected"),el.nextAll().removeClass("selected")):alert("请先选择任务！")},taskObj.pointTask=function(type){return 2==type?(taskObj.pointer="",taskObj.pointerName="",$scope.pointWin=!1,void $("#masklayer2").hide()):void(2!=$scope.taskDetail.status&&(taskObj.pointer>0?doTaskModel.pointTask($scope.taskDetail.task_id,taskObj.pointer,$scope):alert("请先选择认领人！")))},taskObj.conffirm=function(){return""==taskObj.pointer?void alert("请先选择认领人","success",2e3):($scope.pointWin=!0,void $("#masklayer2").show())},taskObj.cancel=function(){taskObj.pointer="",taskObj.pointerName="",$scope.pointWin=!1,$("#masklayer2").hide()},$scope.deletecloseWin=!1,$scope.deletecloseWinindex="",taskObj.deleteTask=function(taskId){$("#masklayer2").show(),$scope.deletecloseWin=!0,$scope.deletecloseWinindex=taskId},taskObj.deleteTaskgo=function(){doTaskModel.deleteTask($scope.deletecloseWinindex,2,$scope),$("#masklayer2").hide(),$scope.deletecloseWin=!1},taskObj.deleteTaskexit=function(){$("#masklayer2").hide(),$scope.deletecloseWin=!1},$scope.pointcloseWin=!1,taskObj.shutDownTask=function(taskId){$("#masklayer2").show(),$scope.pointcloseWin=!0},taskObj.shutDownTaskCloseWin=function(){$("#masklayer2").hide(),$scope.pointcloseWin=!1},taskObj.shutDownTaskdata=function(taskId){$("#masklayer2").hide(),$scope.pointcloseWin=!1,doTaskModel.closeTask(taskId,2,$scope)},taskObj.editeTask=function(taskId){$state.go("main.task.myRewardTask.editer",{task_id:taskId,task_type:2,taskType:2},{reload:!0})},taskObj.publishTask=function(taskId){doTaskModel.publishTask(taskId,2,$scope)},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&angular.element(".selectbor  ul").hide()}),angular.element(".selecttimebor").bind("click",function(event){$(".selectbor ul").hide()})});
TaskMod.factory("myTaskModel",function($http,$state,util){var service={};return service.getProjectInfo=function($scope,status){$http.post("/index.php?r=task/task/getmyproject",{public:status,type:5,complete:1}).success(function(data){$scope.myObject=data.data.proList})},service.getMyTaskList=function($scope,proId,taskType,status,beginTime,endTime,taskTitle,overtime,num,current){$http.post("/index.php?r=task/task-list/my-task-list",{proId:proId,taskType:taskType,status:status,beginTime:beginTime,endTime:endTime,taskTitle:taskTitle,overtime:overtime,num:num,current:current}).success(function(data){$scope.myTaskList=data.data.taskListData,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},service.getTaskDetailInfo=function($scope,taskId){$http.post("/index.php?r=task/task-list/task-details",{taskId:taskId,type:1}).success(function(data){return 20005==data.code?void alert(data.msg):(data.data=util.setImgRand(data.data),$scope.temp_task_type=data.temp_task_type,$scope.taskDetail=data.data,$("#masklayer1").show(),$scope.taskobj.taskDetailWin=!0,void 0)})},service.getOperationTask=function($scope,taskId,type){$http.post("/index.php?r=task/task-list/get-operation-task",{taskId:taskId,taskType:type}).success(function(data){data.data=util.setImgRand(data.data),1==type?$scope.taskobj.operationLogList=data.data:2==type&&($scope.taskobj.operationLogList=data.data)})},service}),TaskMod.factory("myReleaseTaskModel",function($http,util){var service={};return service.getProjectInfo=function($scope,status){$http.post("/index.php?r=task/task/getmyproject",{public:status,type:5,complete:1}).success(function(data){$scope.myObject=data.data})},service.getReleaseTaskList=function($scope,proId,taskType,status,beginTime,endTime,taskTitle,overtime,num,current){$http.post("/index.php?r=task/task-list/my-release-list",{proId:proId,taskType:taskType,status:status,beginTime:beginTime,endTime:endTime,taskTitle:taskTitle,overtime:overtime,num:num,current:current}).success(function(data){$scope.myReleaseTaskList=data.data.taskListData,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},service.getReleaseTaskDetailInfo=function($scope,taskId){$http.post("/index.php?r=task/task-list/task-details",{taskId:taskId,type:2}).success(function(data){data.data=util.setImgRand(data.data),$scope.taskDetail=data.data,$scope.taskobj.charge=data.data.charger})},service}),TaskMod.factory("rewardTaskModel",function($http,util){var service={};return service.getRewardTaskList=function($scope,status,taskTitle,num,current,orgId){$http.post("/index.php?r=task/task-list/reward-list",{status:status,taskTitle:taskTitle,num:num,current:current,orgId:orgId}).success(function(data){$scope.rewardList=data.data.rewardData,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},service.getRewardDetailList=function($scope,taskId){$http.post("/index.php?r=task/task-list/reward-list-details",{taskId:taskId}).success(function(data){data.data.applicant=util.setImgRand(data.data.applicant),$scope.taskDetail=data.data})},service}),TaskMod.factory("myRewardTaskModel",function($http,util){var service={};return service.getMyRewardTaskList=function($scope,status,taskTitle,pageSize,curPage){$http.post("/index.php?r=task/task-list/my-reward",{taskTitle:taskTitle,status:status,pageSize:pageSize,curPage:curPage}).success(function(data){$scope.myRewardDetailList=data.data.myReData,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},service.getMyRewardDetailList=function($scope,taskId){$http.post("/index.php?r=task/task-list/reward-list-details",{taskId:taskId}).success(function(data){data.data.applicant=util.setImgRand(data.data.applicant),$scope.taskDetail=data.data})},service}),TaskMod.factory("myClaimRecordModel",function($http,util){var service={};return service.getMyClaimRecordList=function($scope,pageSize,curPage){$http.post("/index.php?r=task/task-list/application-record",{pageSize:pageSize,curPage:curPage}).success(function(data){data.data.rewardAppRe=util.setImgRand(data.data.rewardAppRe),$scope.taskobj.myClaimRecorList=data.data.rewardAppRe,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},service.getRewardDetailList=function($scope,taskId){$http.post("/index.php?r=task/task-list/reward-list-details",{taskId:taskId}).success(function(data){$scope.rewardDetailList=data.data.rewardAppRe})},service.operationLogData=function($scope,taskId){$http.post("/index.php?r=task/task-list/get-operation-task",{taskId:taskId}).success(function(data){})},service});
TaskMod.controller("taskCreateCtrl",function($scope,$http,$state,$cookieStore,$cookies,$stateParams,$rootScope,$document,taskModel,Publicfactory,permissionService,$timeout){function taskupdown(){var taskhight=parseInt($(".taskcreatewin").css("height"))-107,iclass=$(".taskcreatewin .morebtn.ischange");iclass.length?$(".taskcreatewin .btnbor").css({top:taskhight+"px",height:"100%"}):$(".taskcreatewin .btnbor").css({top:"335px",height:"100%"})}if(!permissionService.checkPermission("TaskCreate"))return $state.go("main.index"),!1;var system=$scope.system={};system.random=(new Date).getTime(),$rootScope.user=$cookieStore.get("userInfo");var taskFunc=$scope.task={},task=$scope.task;$scope.taskNotice=!1,$scope.taskNoticesave=!1,task.leavePoints="",task.taskProjectSelectName="",task.taskProjectSelect={},taskModel.getLeavePoints($scope),task.init_pro_id=$stateParams.pro_id?$stateParams.pro_id:0,taskModel.getProject($scope,1),task.setTaskTimeRange=function(){task.taskProjectSelect.length>0&&(task.taskStarttimeRange=task.taskProjectSelect.begin_time,task.taskEndtimeRange=task.taskProjectSelect.end_time)},task.taskType=[{label:"指派任务",nums:1},{label:"悬赏任务",nums:2}],task.taskTypeDefaultSelect=task.taskType[0],task.taskLevel=[{label:"低",nums:3},{label:"中",nums:2},{label:"高",nums:1}],task.levelDefaultSelect=task.taskLevel[0],task.begin_time="",task.end_time="",task.task_title="",task.task_desc="",task.point="";var taskpointReg=($(".taskpoint").val().replace(/(^\s*)/g,""),/^[0-9]*$/);task.pointkeyup=function(){if(!taskpointReg.test($(".taskpoint").val()))return alert("积分只能是大于0的整数，最大值为自己的总积分!"),$(".taskpoint").val(""),!1},$(".taskcreatewin .morebtn").click(function(){var taskhight=parseInt($(".taskcreatewin").css("height"))-107,iclass=$(".taskcreatewin .morebtn.ischange");iclass.length?($(this).removeClass("ischange").find("i").removeClass("rotate180"),$(this).find("span").css({left:"30px"}).html("点击补充更多任务信息"),$(".scrollbor").removeClass("scroll"),$(".hidebor").stop().slideUp(),$(".taskcreatewin .btnbor").css({top:"335px",height:"100%"})):($(this).addClass("ischange").find("i").addClass("rotate180"),$(this).find("span").css({left:"73px"}).html("收起"),$(".scrollbor").addClass("scroll"),$(".hidebor").stop().slideDown(),$(".taskcreatewin .btnbor").css({top:taskhight+"px",height:"100%"}))}),$(window).resize(function(){taskupdown()}),task.windowselect=function(){},task.groupMembers=[],task.selectedMember={},task.openSelectedP=function(){$(".menbersearchbor").show(),0==$scope.task.groupMembers.length&&taskModel.getMembers($scope,"")},task.closeSelectedP=function(){$(".menbersearchbor").hide(),$scope.task.searchMemberRealName=""};var timer="";task.allott=function(issearch){clearTimeout(timer),timer=setTimeout(function(){var search="";1==issearch&&(search=$scope.task.searchMemberRealName),1!=issearch&&($scope.task.searchMemberRealName=""),taskModel.getMembers($scope,$scope.task.searchMemberRealName)},500)},task.selectMember=function($selecedMember){task.selectedMember=$selecedMember,task.closeSelectedP()},task.delmember=function(){task.selectedMember={}},task.files=[],task.upload={},task.attId=[],$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=task/task/upload&type=1&taskType="+task.taskTypeDefaultSelect.nums,uploader.onCompleteItem=function(fileItem,response,status,headers){if(2e4!=response.code&&response.msg)return alert(response.msg),!1;if(void 0!=response.data||void 0!=response.data.name){task.attId.push(response.data.task_att_id);var temporary_att={};temporary_att.task_att_id=response.data.task_att_id,temporary_att.real_name=response.data.real_name,temporary_att.file_type=response.data.file_type,temporary_att.file_size=response.data.file_size,task.files.push(temporary_att)}}},task.delFiles=function(index,attId){$http.get("/index.php?r=task/task/del-att&attId="+attId).success(function(data){if(2e4==data.code){$scope.attr&&$scope.attr.splice(index,1);$scope.task.files[index];$scope.task.files&&($scope.task.files.splice(index,1),$scope.task.attId.splice(index,1))}})},taskFunc.skillList=task.skillList=[],task.selecteSkill=[],task.openSelecteSkill=function(){$(".skillbor").show();var elem=$(".taskcreatewin .scrollbor"),elemmath=Math.max(elem.prop("scrollHeight"),elem.prop("offsetHeight"));$(".taskcreatewin .scrollbor").scrollTop(700+elemmath),0==task.skillList.length&&(taskModel.getAllSkillList($scope),$(".taskcreatewin .scrollbor").scrollTop(700+elemmath))},task.closeSelecteSkill=function(){$(".skillbor").hide()},task.selectSkill=function($skill){task.selecteSkill.push($skill)},task.delSkill=function(index){task.selecteSkill.splice(index,1)},task.showList=function(index,isShow){task.skillList[index].show=isShow};var updateSelected=function(action,id){"add"==action&&task.selecteSkill.indexOf(id)==-1&&task.selecteSkill.push(id),"remove"==action&&task.selecteSkill.indexOf(id)!=-1&&task.selecteSkill.splice(task.selecteSkill.indexOf(id),1)};task.updateSelection=function($event,id){var checkbox=$event.target,action=checkbox.checked?"add":"remove";updateSelected(action,id)},task.isSelected=function(id){return task.selecteSkill.indexOf(id)>=0},task.allGroupsTree=[],task.selectedGroup=[],task.openSelecteGroup=function(){$(".offerbor").show(),0==$scope.task.allGroupsTree.length&&taskModel.getAllGroupTree($scope)},task.closeSelecteGroup=function(){$(".offerbor").hide()},task.getAllGroup=function(){task.offerRange=!task.offerRange,taskModel.getAllGroupTree($scope)},task.selectAll=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().parent(".nbors").nextAll("div").find(":checkbox").prop("checked",!1):angular.element(checkbox).parent().parent().parent(".nbors").nextAll("div").find(":checkbox").prop("checked",!0)};var isSelectedAll=function(){var c=!0;task.selectedGroup=[],angular.element(".nbors").find(".title").find(":checkbox").each(function(){if($(this).prop("checked")){var tmp={org_id:$(this).attr("gid"),org_name:$(this).attr("gname")};task.selectedGroup.push(tmp)}}),angular.element(".nbors").find("ul").find(":checkbox").each(function(){if(0==$(this).prop("checked"))c=c&&!1;else{var tmp=($(this).attr("gid"),{org_id:$(this).attr("gid"),org_name:$(this).attr("gname")});task.selectedGroup.push(tmp)}}),c&&angular.element(".nbors").eq(0).find(":checkbox").prop("checked",!0)},selectAllsub=function(el){var c2=!0;angular.element(el).parents(".second_li").find("ul").find(":checkbox").each(function(){0==$(this).prop("checked")&&(c2=!1)}),c2&&angular.element(el).parents(".second_li").find(".cbox2").prop("checked",!0)},recursionEl=function(el){var li=!0;angular.element(el).parents(".child_li").eq(0).parent("ul").find(":checkbox").length>0&&(angular.element(el).parent().parent("li").parent("ul").find(":checkbox").each(function(){if(0==$(this).prop("checked"))return li=!1,!1}),li?(angular.element(el).parents(".child_li").eq(1).find(":checkbox").eq(0).prop("checked",!0),angular.element(el).parent().parent("li").parent("ul").prevAll(":checkbox").length>0&&recursionEl(angular.element(el).parent().parent("li").parent("ul").prevAll(":checkbox"))):angular.element(el).parents(".child_li").eq(1).find(":checkbox").eq(0).prop("checked",!1))};task.selectAllSubGroup=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().next().find(":checkbox").prop("checked",!0):(angular.element(checkbox).parent().parent().next().find(":checkbox").prop("checked",!1),angular.element(".nbors").eq(0).find(":checkbox").prop("checked",!1)),isSelectedAll()},task.selectAllSubGroup2=function($event){var checkbox=$event.target;checkbox.checked?(angular.element(checkbox).parent().next().find(":checkbox").prop("checked",!0),angular.element(".nbors").find("ul").find(":checkbox").each(function(){recursionEl(this)})):angular.element(checkbox).parent().next().find(":checkbox").prop("checked",!1),selectAllsub(checkbox),isSelectedAll()},task.selectGroup=function($event){selectAllsub($event.target),isSelectedAll()},task.showGroupList=function(index,isShow){task.allGroupsTree[index].show=isShow},$scope.$watchCollection("task.selectedGroup",function(newVal,oldVal){var listNode=angular.element(".taskxsbor .xslistbor");setTimeout(function(){listNode.length>0&&listNode[0].clientHeight>57&&($(".taskcreatewin .scroll").length||$(".taskcreatewin .morebtn").click())},100)}),task.createTask=function(isPublish){if("undefined"==typeof task.task_title||0==task.task_title.length)return alert("请设置任务标题"),void $scope.$broadcast("error","请设置任务标题");if(task.task_title=task.task_title.replace(/(^\s*)/g,""),Publicfactory.checkEnCnstrlen(task.task_title)>100)return void alert("任务标题不能超过50个字!");if("undefined"!=typeof task.task_desc&&Publicfactory.checkEnCnstrlen(task.task_desc)>1e3)return alert("任务内容长度不能大于500个字"),!1;if("undefined"==typeof task.begin_time||""==task.begin_time||""==task.end_time||"undefined"==typeof task.end_time)return void alert("请选择任务时间");if(task.point>0&&task.leavePoints-task.point<0)return task.point=0,void alert("可分配纳米币不足");if((!task.selectedMember||void 0==task.selectedMember.u_id)&&1==task.taskTypeDefaultSelect.nums)return void alert("请选择指派人");var Today_date=new Date,year_date=Today_date.getFullYear(),month_date=Today_date.getMonth()+1,day_date=Today_date.getDate(),hour_date=Today_date.getHours(),minute_date=Today_date.getMinutes();month_date<10?month_date="0"+month_date:month_date,day_date<10?day_date="0"+day_date:day_date,hour_date<10?hour_date="0"+hour_date:hour_date,minute_date<10?minute_date="0"+minute_date:minute_date;var Today_date_s=year_date+"-"+month_date+"-"+day_date+" "+hour_date+":"+minute_date;if(task.begin_time=$("#task_datestart").val(),task.end_time=$("#task_dateend").val(),task.begin_time>=task.end_time)return void alert("结束时间不能小于等于开始时间！");if(task.taskProjectSelect&&Today_date_s>task.taskEndtimeRange)return void alert("项目时间已过期，无法创建任务！");if($scope.task.point>1e5)return void alert("积分不能大于100000");if(task.point<0)return void alert("积分不能为负数");if(task.point||(task.point=0),2==task.taskTypeDefaultSelect.nums&&0==task.selectedGroup.length)return void alert("请选择悬赏范围");var postData={attr:task.attId,title:task.task_title,desc:task.task_desc,startTime:task.begin_time,endTime:task.end_time,skills:task.selecteSkill,group:task.selectedGroup,point:task.point,task_level:task.levelDefaultSelect.nums,type:task.taskTypeDefaultSelect.nums,pro_id:task.taskProjectSelect.pro_id,is_publish:isPublish,charger:task.selectedMember};$http.post("/index.php?r=task/task/createtask",postData).success(function(data){return 2e4!=data.code?void alert(data.msg):void(2e4==data.code&&(task.attId=[],task.files=[],task.selectedGroup1=[],task.startLabel="",task.task_desc="",task.title="",task.point>0&&task.updateCookie(),$("#masklayer2").show(),1==isPublish?$scope.taskNotice=!0:$scope.taskNoticesave=!0))})},task.updateCookie=function(){task.leavePoints=task.leavePoints-task.point,task.point=""},task.goOnCreate=function(){task.attId=[],task.files=[],task.point="",task.selectedGroup1=[],task.selectedGroup=[],task.selecteSkill=[],task.taskProjectSelect={},task.startLabel="",task.task_desc="",task.title="",task.levelDefaultSelect=task.taskLevel[0],task.begin_time="",task.end_time="",task.task_title="",task.task_desc="",task.point="",task.selectedMember={},$("#masklayer2").hide(),$state.go("main.task.create",{},{reload:!0})},task.toMyList=function(){2==task.taskTypeDefaultSelect.nums?$state.go("main.task.myRewardTask",{task_status:3},{reload:!0}):$state.go("main.task.myReleaseTask",{task_status:1},{reload:!0})}});
TaskMod.controller("taskEditeCtrl",function($scope,$http,$state,$cookieStore,$cookies,$stateParams,$rootScope,$document,taskModel,Publicfactory){var system=$scope.system={};if(system.random=(new Date).getTime(),$rootScope.user=$cookieStore.get("userInfo"),$("#masklayer1").show(),!$stateParams.task_id||!$stateParams.task_type)return $state.go("^"),!1;var task=$scope.task={};$scope.leavePoints=0,task.point=0,task.temp_task_type=1,$scope.tempPoint=0;var taskFunc=$scope.taskFunc={};taskModel.getTaskDetail($scope,$stateParams.task_id,$stateParams.task_type,$state),$http.get("/index.php?r=task/task/get-leave-points").success(function(data){$scope.leavePoints=parseInt(data.data)}),taskFunc.setTaskTimeRange=function(project){},$scope.task.taskType=[{label:"指派任务",nums:1},{label:"悬赏任务",nums:2}],$scope.task.taskLevel=[{label:"低",nums:3},{label:"中",nums:2},{label:"高",nums:1}],taskFunc.back=function(){$("#masklayer1").hide(),$(".taskeditwin").hide(),$state.go("^")};var taskpointReg=($(".taskpoint").val().replace(/(^\s*)/g,""),/^[0-9]*$/);taskFunc.pointkeyup=function(){if(!taskpointReg.test($(".taskpoint").val()))return alert("积分只能是大于0的正整数，最大值为自己的总积分!"),$(".taskpoint").val(""),!1},taskFunc.isSkillSelected=function(id){return null!=$scope.task.selecteSkill&&void angular.forEach($scope.task.selecteSkill,function(value,key){if(value.skill_id==id)return!0})},taskFunc.isGroupSelected=function(id){return null!=$scope.task.selectedGroup&&void angular.forEach($scope.task.selectedGroup,function(value,key){if(value.org_id==id)return!0})},taskModel.getMembers($scope,""),taskFunc.openSelectedP=function(){$(".menbersearchbor").show(),0==$scope.task.groupMembers.length&&taskModel.getMembers($scope,"")},taskFunc.closeSelectedP=function(){$(".menbersearchbor").hide(),$scope.task.searchMemberRealName=""};var timer="";taskFunc.allott=function(issearch){clearTimeout(timer),timer=setTimeout(function(){var search="";1==issearch&&(search=$scope.task.searchMemberRealName),1!=issearch&&($scope.task.searchMemberRealName=""),taskModel.getMembers($scope,$scope.task.searchMemberRealName)},500)},taskFunc.selectMember=function($selecedMember){$scope.task.selectedMember=$selecedMember,taskFunc.closeSelectedP()},taskFunc.delmember=function(){$scope.task.selectedMember={}},$scope.addFileBtn=function(uploader){console.log($scope.task.temp_task_type),uploader.url="/index.php?r=task/task/upload&type=1&taskType="+$scope.task.temp_task_type+"&taskId="+$scope.task.task_id,uploader.onCompleteItem=function(fileItem,response,status,headers){if(2e4!=response.code&&response.msg)return alert(response.msg),!1;if(void 0!=response.data){var temporary_att={};temporary_att.task_att_id=response.data.task_att_id,temporary_att.name=response.data.name,temporary_att.real_name=response.data.real_name,temporary_att.file_type=response.data.file_type,temporary_att.file_size=response.data.file_size,$scope.task.files.push(response.data)}}},taskFunc.delFiles=function(index,attId){$http.get("/index.php?r=task/task/del-att&attId="+attId).success(function(data){2e4==data.code?$scope.task.files&&$scope.task.files.splice(index,1):alert(data.msg)})},taskFunc.openSelecteSkill=function(){$(".skillbor").show(),$(".taskeditwin .scrollbor").scrollTop(700),0==$scope.task.skillList.length&&(taskModel.getAllSkillList($scope),$(".taskeditwin .scrollbor").scrollTop(700))},taskFunc.closeSelecteSkill=function(){$(".skillbor").hide()},taskFunc.selectSkill=function($skill){$scope.task.selecteSkill.push($skill)},taskFunc.delSkill=function(index){$scope.task.selecteSkill.splice(index,1)},taskFunc.showList=function(index,isShow){$scope.task.skillList[index].show=isShow};var updateSelected=function(action,id){if("add"==action){var temp=-1;angular.element.each($scope.task.selecteSkill,function(key,val){val.skill_id==id.skill_id&&(temp=1)}),temp==-1&&$scope.task.selecteSkill.push(id)}else for(var i=0;i<$scope.task.selecteSkill.length;i++)if($scope.task.selecteSkill[i].skill_id==id.skill_id){$scope.task.selecteSkill.splice(i,1);break}};$scope.taskFunc.isSkillModified=!1,taskFunc.updateSelection=function($event,id){var checkbox=$event.target,action=checkbox.checked?"add":"remove";$scope.taskFunc.isSkillModified=!0,updateSelected(action,id)},taskFunc.isSelected=function(id){return $scope.task.selecteSkill.indexOf(id)>=0},2==$scope.task.task_type&&($scope.task.allGroupsTree=[]),taskFunc.openSelecteGroup=function(){$(".offerbor").show(),0==$scope.task.allGroupsTree.length&&taskModel.getAllGroupTree($scope)},taskFunc.closeSelecteGroup=function(){$(".offerbor").hide()},taskFunc.getAllGroup=function(){$scope.task.offerRange=!$scope.task.offerRange,taskModel.getAllGroupTree($scope)},taskFunc.selectAll=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().parent(".nbors").nextAll("div").find(":checkbox").prop("checked",!0):angular.element(checkbox).parent().parent().parent(".nbors").nextAll("div").find(":checkbox").prop("checked",!1)},task.selectAll=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().parent(".nbors").nextAll("div").find(":checkbox").prop("checked",!1):angular.element(checkbox).parent().parent().parent(".nbors").nextAll("div").find(":checkbox").prop("checked",!0)},taskFunc.isGroupModified=!1;var isSelectedAll=function(){var c=!0;$scope.task.selectedGroup=[],taskFunc.isGroupModified=!0,angular.element(".nbors").find(".title").find(":checkbox").each(function(){if($(this).prop("checked")){var tmp={org_id:$(this).attr("gid"),org_name:$(this).attr("gname")};$scope.task.selectedGroup.push(tmp)}}),angular.element(".nbors").find("ul").find(":checkbox").each(function(){if(0==$(this).prop("checked"))c=c&&!1;else{var tmp=($(this).attr("gid"),{org_id:$(this).attr("gid"),org_name:$(this).attr("gname")});$scope.task.selectedGroup.push(tmp)}}),c&&angular.element(".nbors").eq(0).find(":checkbox").prop("checked",!0)},selectAllsub=function(el){var c2=!0;angular.element(el).parents(".second_li").find("ul").find(":checkbox").each(function(){0==$(this).prop("checked")&&(c2=!1)}),c2&&angular.element(el).parents(".second_li").find(".cbox2").prop("checked",!0)},recursionEl=function(el){var li=!0;angular.element(el).parents(".child_li").eq(0).parent("ul").find(":checkbox").length>0&&(angular.element(el).parent().parent("li").parent("ul").find(":checkbox").each(function(){if(0==$(this).prop("checked"))return li=!1,!1}),li?(angular.element(el).parents(".child_li").eq(1).find(":checkbox").eq(0).prop("checked",!0),angular.element(el).parent().parent("li").parent("ul").prevAll(":checkbox").length>0&&recursionEl(angular.element(el).parent().parent("li").parent("ul").prevAll(":checkbox"))):angular.element(el).parents(".child_li").eq(1).find(":checkbox").eq(0).prop("checked",!1))};taskFunc.selectAllSubGroup=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().next().find(":checkbox").prop("checked",!0):(angular.element(checkbox).parent().parent().next().find(":checkbox").prop("checked",!1),angular.element(".nbors").eq(0).find(":checkbox").prop("checked",!1)),isSelectedAll()},taskFunc.selectAllSubGroup2=function($event){var checkbox=$event.target;checkbox.checked?(angular.element(checkbox).parent().next().find(":checkbox").prop("checked",!0),angular.element(".nbors").find("ul").find(":checkbox").each(function(){recursionEl(this)})):angular.element(checkbox).parent().next().find(":checkbox").prop("checked",!1),selectAllsub(checkbox),isSelectedAll()},taskFunc.selectGroup=function($event){selectAllsub($event.target),isSelectedAll()},taskFunc.showGroupList=function(index,isShow){$scope.task.allGroupsTree[index].show=isShow},taskFunc.saveTask=function(){if((!$scope.task.selectedMember||void 0==$scope.task.selectedMember.u_id)&&1==$scope.task.taskTypeDefaultSelect.nums)return void alert("请选择指派人");if("undefined"==typeof $scope.task.task_title||0==$scope.task.task_title.length)return alert("请设置任务标题"),void $scope.$broadcast("error","请设置任务标题");if($scope.task.task_title=$scope.task.task_title.replace(/(^\s*)/g,""),Publicfactory.checkEnCnstrlen($scope.task.task_title)>100)return void alert("任务标题不能超过50个字!");if("undefined"!=typeof $scope.task.task_desc&&Publicfactory.checkEnCnstrlen($scope.task.task_desc)>1e3)return alert("任务内容长度不能大于500个字"),!1;if("undefined"==typeof $scope.task.begin_time||""==$scope.task.begin_time||""==$scope.task.end_time||"undefined"==typeof $scope.task.end_time)return void alert("请选择任务时间");var reg=/^([1-9]\d*|0)$/;if(!reg.test($scope.task.point))return $scope.task.point=0,void alert("请输入正确的纳米币");if($scope.task.point>0&&parseInt($scope.leavePoints)+parseInt($scope.tempPoint)-parseInt($scope.task.point)<0)return $scope.task.point=0,void alert("纳米币不足");var Today_date=new Date,month_date=(Today_date.getFullYear(),Today_date.getMonth()+1),day_date=Today_date.getDate(),hour_date=Today_date.getHours(),minute_date=Today_date.getMinutes();month_date<10?month_date="0"+month_date:month_date,day_date<10?day_date="0"+day_date:day_date,hour_date<10?hour_date="0"+hour_date:hour_date,minute_date<10?minute_date="0"+minute_date:minute_date;if($scope.task.begin_time=$("#task_datestart").val(),$scope.task.end_time=$("#task_dateend").val(),$scope.task.begin_time>=$scope.task.end_time)return void alert("结束时间不能少于等于开始时间！");if($scope.task.point>1e4)return void alert("积分不能大于10000");if(task.point<0)return void alert("积分不能为负数");if(2==$scope.task.taskTypeDefaultSelect.nums&&$scope.task.status<2&&(void 0==$scope.task.selectedGroup.length||0==$scope.task.selectedGroup.length))return void alert("请选择悬赏范围");$scope.taskFunc.isGroupModified||($scope.task.selectedGroup=[]),$scope.task.status>=2&&($scope.task.task_type=1);var postData={task_id:$scope.task.task_id,task_title:$scope.task.task_title,task_desc:$scope.task.task_desc,begin_time:$scope.task.begin_time,end_time:$scope.task.end_time,skills:$scope.task.selecteSkill,group:$scope.task.selectedGroup,point:$scope.task.point,task_level:$scope.task.levelDefaultSelect.nums,type:$scope.task.task_type,pro_id:$scope.task.taskProjectSelect.pro_id,charger:$scope.task.selectedMember,taskType:$stateParams.taskType};$http.post("/index.php?r=task/task/update-task",postData).success(function(data){return 2e4!=data.code?(alert(data.msg),void $scope.$broadcast("error",data.msg)):void(2e4==data.code&&(alert(data.msg),$scope.leavePoints=parseInt(data.data),$scope.task.point=0,2==$scope.task.taskTypeDefaultSelect.nums?$state.go("^",{task_status:3},{reload:!0}):$state.go("^",{task_status:1},{reload:!0})))})}});
TaskMod.factory("taskModel",function($http,$timeout,$cookieStore,$cookies,$state,filtersModel,util){var service={};return service.getProject=function($scope,page){$http.post("/index.php?r=task/task/getmyproject",{type:5,public:2,page:page}).success(function(data){if($scope.task.allProject=data.data.proList,$scope.task.pro_id){for(var i=0;i<data.data.proList.length;i++)if($scope.task.pro_id==data.data.proList[i].pro_id){$scope.task.taskProjectSelect=data.data.proList[i];break}""==$scope.task.taskProjectSelect&&($scope.task.allProject.push({pro_name:$scope.task.pro_name,pro_id:$scope.task.pro_id}),$scope.task.taskProjectSelect=$scope.task.allProject[$scope.task.allProject.length-1])}if($scope.task.init_pro_id>0)for(var i=0;i<$scope.task.allProject.length;i++)if($scope.task.allProject[i].pro_id==$scope.task.init_pro_id){$scope.task.taskProjectSelect=$scope.task.allProject[i];break}})},service.getAllGroupTree=function($scope){$http.post("/index.php?r=workmate/workmate/all-group",{selected:$scope.task.selectedGroup}).success(function(data){$scope.task.allGroupsTree=data.data,angular.forEach($scope.task.allGroupsTree,function(group1,groupKey1){$scope.task.allGroupsTree[groupKey1].show=0}),$scope.task.allGroupsTree[0].show=1})},service.getMembers=function($scope,search){$scope.$broadcast("loadOpt","block");var issearch=0;search&&(issearch=1),$http.post("/index.php?r=task/task/allgroupmember",{search:search,lately:$cookieStore.get("lately")}).success(function(data,status,headers,config){data.data=util.setImgRand(data.data),$scope.task.groupMembers=data.data,0==data.data.length?$scope.is_member=!1:$scope.is_member=!0,1!=issearch&&($scope.searchMemberRealName="")})},service.getAllSkillList=function($scope){$http.get("/index.php?r=management/skill/skilllist").success(function(data,status){$scope.task.skillList=data.data;for(var i=0;i<data.data.length;i++)$scope.task.skillList[i].show=1,angular.forEach(data.data[i].children,function(skill,key){angular.forEach($scope.task.selecteSkill,function(value){value.skill_id==skill.skill_id&&void 0!=$scope.task.skillList[i].children[key]&&($scope.task.skillList[i].children[key].is_select=!0)})})})},service.getOfferTaskList=function($rootScope,order,title,page,task_status,$scope){$http.post("/index.php?r=tasklist/offertasklist",{order:order,title:title,page:page,task_status:task_status}).success(function(data,status){for(var i=0;i<data.data.length;i++)$rootScope.OfferTask.push(data.data[i]);$scope.loadTips=!1})},service.getTask=function($scope,projectId,name){$scope.$broadcast("loadOpt","block"),$http.get("/index.php?r=task/gettask&projectid="+projectId+"&name="+encodeURI(name)).success(function(data){$scope.mainTask.allTask=data.data,$scope.$broadcast("loadOpt","none")})},service.getOwner=function(taskId,$scope){$http.get("/index.php?r=tasklist/get-task-member&task_id="+taskId).success(function(data){$scope.charger_name=data.real_name,$scope.charger_uid=data.u_id})},service.getCreateUser=function(uid,$scope){$http.get("/index.php?r=members/userinfo&uid="+uid).success(function(data){$scope.CreateUser=data.items})},service.getTaskDetail=function($scope,task_id,type,$state){$http.get("/index.php?r=task/task/task-detail&taskId="+task_id+"&type="+type).success(function(data){if(2e4!=data.code)return alert(data.msg),$state.go("^"),!1;switch($scope.task=data.data,$scope.tempPoint=parseInt(data.data.point),$scope.task.temp_task_type=data.temp_task_type,$scope.task.pro_id&&($scope.task.taskProjectSelect={pro_name:$scope.task.pro_name,pro_id:$scope.task.pro_id}),service.getProject($scope,1),$scope.task.taskType=[{label:"指派任务",nums:1},{label:"悬赏任务",nums:2}],1==$scope.task.task_type?$scope.task.taskTypeDefaultSelect=$scope.task.taskType[0]:$scope.task.taskTypeDefaultSelect=$scope.task.taskType[1],$scope.task.taskLevel=[{label:"低",nums:3},{label:"中",nums:2},{label:"高",nums:1}],$scope.task.task_level){case"1":$scope.task.levelDefaultSelect=$scope.task.taskLevel[2];break;case"2":$scope.task.levelDefaultSelect=$scope.task.taskLevel[1];break;case"3":$scope.task.levelDefaultSelect=$scope.task.taskLevel[0]}$scope.task.selectedMember={u_id:$scope.task.charger,real_name:$scope.task.real_name,head_img:$scope.task.head_img},$scope.task.groupMembers=[],$scope.task.taskProjectSelect="",$scope.task.skillList=[],$scope.task.allGroupsTree=[],$scope.task.isSkillModified=!1,$scope.task.isGroupModified=!1,void 0==$scope.task.task_desc&&($scope.task.task_desc="")})},service.getLeavePoints=function($scope){$http.get("/index.php?r=task/task/get-leave-points").success(function(data){$scope.task.leavePoints=data.data})},service});
TaskMod.factory("doTaskModel",function($http,$timeout,$state,filtersModel,myReleaseTaskModel,myRewardTaskModel,myTaskModel,rewardTaskModel){var service={};return service.getTaskDetail=function($scope,task_id,type,$state){timeNumber="",$http.get("/index.php?r=tasklist/taskdetail&task_id="+task_id+"&type="+type).success(function(data){return data.code==-1?($scope.taskFunc.noticeService(data.msg),$state.go("^"),!1):0==data.code?($scope.taskFunc.noticeService(data.msg,"",0,{url:"^",params:{},params2:{reload:!1}}),$state.go("^"),!1):($scope.task=data.data,service.getCreateUser(data.data.create_uid,$scope),$scope.clearcuontdown=function(){var qzchaoshi=angular.element(".detailbox-content-left .task-grant-apply");qzchaoshi.addClass("chaoshi").find(".grant-over").remove(),qzchaoshi.find(".grant-apply-title").after('<span class="chaoshis">已超时</span>')},void $timeout(function(){if(angular.element("#days").length>0){$scope.cuontdown={interval:1e3,around:function(years,months,days,hours,minutes,seconds){var num=window.setInterval(function(){var timespan=countdown(new Date,new Date(years,months,days,hours,minutes,seconds),countdown.DAYS|countdown.HOURS|countdown.MINUTES|countdown.SECONDS);document.getElementById("days").innerHTML=timespan.days,document.getElementById("hours").innerHTML=timespan.hours,document.getElementById("minutes").innerHTML=timespan.minutes,document.getElementById("seconds").innerHTML=timespan.seconds;var nowDateClear=Date.parse(new Date);1e3*parseInt($scope.task.task_end_time)-nowDateClear==0&&(window.clearInterval(num),$scope.clearcuontdown())},this.interval);return num}},$scope.getnewtime=function(endTime){var s1=new Date(1e3*endTime),s2=new Date,days=s2.getTime()-s1.getTime(),day=(parseInt(days/864e5),Math.floor(days/864e5)),hour=Math.floor(days/36e5)%24,minute=Math.floor(days/6e4)%60,second=Math.floor(days/1e3)%60;angular.element("#days").html(day),angular.element("#hours").html(hour),angular.element("#minutes").html(minute),angular.element("#seconds").html(second)};var nowDate=Date.parse(new Date),myDate="";""!=timeNumber&&(timeNumber=window.clearInterval(timeNumber)),$scope.task.task_start_time>0&&$scope.task.task_end_time>0&&($scope.isbegin=!0,1e3*parseInt($scope.task.task_end_time)-nowDate>0?(myDate=new Date(1e3*$scope.task.task_end_time),$scope.grantOver=!0,$scope.timeOut=2,timeNumber=$scope.cuontdown.around(myDate.getFullYear(),myDate.getMonth(),myDate.getDate(),myDate.getHours(),myDate.getMinutes(),myDate.getSeconds())):nowDate-1e3*parseInt($scope.task.task_end_time)>0?($scope.isdelay=!0,$scope.grantOver=!0,$scope.timeOut=2):($scope.grantOver=!1,$scope.days=0,$scope.hours=0,$scope.minutes=0,$scope.seconds=0,$scope.timeOut=1))}$scope.tm.Taskdetails_Starttime=filtersModel.filterTime(1e3*$scope.task.task_start_time),$scope.tm.Taskdetails_Endtime=filtersModel.filterTime(1e3*$scope.task.task_end_time),$scope.tm.Taskdetails_StarttimeHHmm=filtersModel.filterTimeHHmm(1e3*$scope.task.task_start_time),$scope.tm.Taskdetails_EndtimeHHmm=filtersModel.filterTimeHHmm(1e3*$scope.task.task_end_time),angular.element("#Taskdetails_start_time").val($scope.tm.Taskdetails_StarttimeHHmm),angular.element("#Taskdetails_end_time").val($scope.tm.Taskdetails_EndtimeHHmm)},1e3))})},service.backList=function($scope){$scope.detailPopWin=!1,$scope.showCheck=!0,$("#masklayer1").hide(),$("#masklayer2").hide(),myReleaseTaskModel.getReleaseTaskList($scope,$scope.taskobj.proId,$scope.taskobj.taskType,$scope.taskobj.status,$scope.taskobj.btime,$scope.taskobj.etime,$scope.taskobj.taskTitle,$scope.taskobj.overtime,$scope.taskobj.num,$scope.page.curPage)},service.backToMytask=function($scope){$scope.taskobj.taskDetailWin=!1,$scope.showDelay=!1,$("#masklayer1").hide(),$("#masklayer2").hide(),myTaskModel.getMyTaskList($scope,$scope.taskobj.proId,$scope.taskobj.taskType,$scope.taskobj.status,$scope.taskobj.btime,$scope.taskobj.etime,$scope.taskobj.taskTitle,$scope.taskobj.overtime,$scope.taskobj.pagesize,$scope.page.curPage)},service.backToRewardList=function($scope){$scope.detailPopWin=!1,$("#masklayer1").hide(),$("#masklayer2").hide(),rewardTaskModel.getRewardTaskList($scope,$scope.taskobj.status,$scope.taskobj.taskTitle,$scope.taskobj.pageSize,$scope.page.curPage,$scope.taskobj.orgId)},service.backToMyRewardList=function($scope){$scope.detailPopWin=!1,$scope.pointWin=!1,$("#masklayer1").hide(),$("#masklayer2").hide(),myRewardTaskModel.getMyRewardTaskList($scope,$scope.taskobj.status,$scope.taskobj.taskTitle,$scope.taskobj.pageSize,$scope.page.curPage)},service.acceptTask=function(taskId,$scope){$http.get("/index.php?r=task/dotask/accept-task&taskId="+taskId).success(function(data){2e4==data.code?(alert(data.msg),service.backToMytask($scope)):alert(data.msg)})},service.refuseTask=function(taskId,reason,$scope){$http.post("/index.php?r=task/dotask/refuse-task",{task_id:taskId,reason:reason}).success(function(data){2e4==data.code?(alert(data.msg),service.backToMytask($scope)):alert(data.msg)})},service.redoTask=function(taskId,reason,rePoint,$scope){$http.post("/index.php?r=task/dotask/done-task",{task_id:taskId,reason:reason,pointer:rePoint,type:1}).success(function(data){2e4==data.code?(alert(data.msg),service.backList($scope),$scope.selectedMember={},$scope.taskobj.refuse_reason=""):alert(data.msg)})},service.submitRepoint=function(taskId,uid,$scope){$http.post("/index.php?r=task/dotask/submit-repoint",{task_id:taskId,uid:uid}).success(function(data){2e4==data.code?(alert(data.msg),service.backList($scope)):alert(data.msg)})},service.doneTask=function(taskId,doneData,type,$scope){$http.post("/index.php?r=task/dotask/done-task",{task_id:taskId,type:type,data:doneData}).success(function(data){2e4==data.code?(alert(data.msg),service.backList($scope)):alert(data.msg)})},service.getTaskSkill=function($scope,taskId){$http.post("/index.php?r=task/dotask/get-task-skill",{task_id:taskId}).success(function(data){$scope.skills=data.data})},service.auditTask=function(taskId,workNote,$scope){$http.post("/index.php?r=task/dotask/commit-task",{task_id:taskId,work_note:workNote}).success(function(data){2e4==data.code?(alert(data.msg),service.backToMytask($scope)):alert(data.msg)})},service.claimTask=function(taskId,$scope){$http.post("/index.php?r=task/rewardtask/claim-task",{task_id:taskId}).success(function(data){2e4==data.code?(alert(data.msg),service.backToRewardList($scope)):alert(data.msg)})},service.cancelTask=function(taskId,$scope){$http.post("/index.php?r=task/rewardtask/cancel-task&task_id="+taskId).success(function(data){2e4==data.code?(alert(data.msg),service.backToRewardList($scope)):alert(data.msg)})},service.pointTask=function(taskId,uid,$scope){$http.post("/index.php?r=task/rewardtask/point-task",{task_id:taskId,point_uid:uid}).success(function(data){2e4==data.code?(alert(data.msg),$scope.pointWin=!1,$("#masklayer2").hide(),service.backToMyRewardList($scope)):alert(data.msg)})},service.deleteTask=function(taskId,taskType,$scope){$http.post("/index.php?r=task/dotask/delete-task",{task_id:taskId,task_type:taskType}).success(function(data){2e4==data.code?(alert(data.msg),1==taskType?service.backList($scope):($scope.detailPopWin=!1,$("#masklayer1").hide(),$("#masklayer2").hide(),myRewardTaskModel.getMyRewardTaskList($scope,$scope.taskobj.status,$scope.taskobj.taskTitle,$scope.taskobj.pageSize,$scope.taskobj.curPage))):alert(data.msg)})},service.closeTask=function(taskId,taskType,$scope){$http.post("/index.php?r=task/dotask/close-task",{task_id:taskId,task_type:taskType}).success(function(data){2e4==data.code?(alert(data.msg),1==taskType?service.backList($scope):service.backToMyRewardList($scope)):alert(data.msg)})},service.delayTask=function(taskId,taskType,delayTime,delayReason,$scope){$http.post("/index.php?r=task/dotask/delay-task",{task_id:taskId,task_type:taskType,delay_time:delayTime,reason:delayReason}).success(function(data){2e4==data.code?(alert(data.msg),$scope.showDelay=!1,1==taskType?service.backList($scope):service.backToMyRewardList($scope)):alert(data.msg)})},service.publishTask=function(taskId,taskType,$scope){$http.post("/index.php?r=task/dotask/publish",{task_id:taskId,task_type:taskType}).success(function(data){2e4==data.code?(alert(data.msg),1==taskType?service.backList($scope):service.backToMyRewardList($scope)):alert(data.msg)})},service});
TaskMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/task/view/";$stateProvider.state("main.task",{url:"/task",module:"private",data:{css:["css/task.css","css/lib/datetimepicker.css"]},views:{"taskContent@main":{templateUrl:basePath+"task_content.html"}}}).state("main.task.create",{url:"/create/:pro_id",module:"private",views:{"task_create@main.task":{templateUrl:basePath+"task_create.html",controller:"taskCreateCtrl"}}}).state("main.task.myTask",{url:"/myTask/:task_id",module:"private",views:{"task_myTask@main.task":{templateUrl:basePath+"task_myTask.html",controller:"myTaskCtr"}}}).state("main.task.myReleaseTask",{url:"/myReleaseTask/:task",module:"private",views:{"task_myReleaseTask@main.task":{templateUrl:basePath+"task_myReleaseTask.html",controller:"myReleaseTaskCtr"}}}).state("main.task.rewardTask",{url:"/rewardTask/:task",module:"private",views:{"task_rewardTask@main.task":{templateUrl:basePath+"task_rewardTask.html",controller:"rewardTaskCtr"}}}).state("main.task.myRewardTask",{url:"/myRewardTask/:task",module:"private",views:{"task_myRewardTask@main.task":{templateUrl:basePath+"task_myRewardTask.html",controller:"myRewardTaskCtr"}}}).state("main.task.myClaimRecord",{url:"/myClaimRecord",module:"private",views:{"task_myClaimRecord@main.task":{templateUrl:basePath+"task_myClaimRecord.html",controller:"myClaimRecordCtr"}}}).state("main.task.demo",{url:"/demo/:task_status",module:"private",views:{"task_demo@main.task":{templateUrl:basePath+"task_demo.html",controller:"rewardTaskCtr"}}}).state("main.task.myRewardTask.editer",{url:"/editer/:task_id/:task_type/:taskType",module:"private",views:{"task_edite@main.task":{templateUrl:basePath+"task_edite.html",controller:"taskEditeCtrl"}}}).state("main.task.myReleaseTask.edite",{url:"/edite/:task_id/:task_type/:taskType",module:"private",views:{"task_edite@main.task":{templateUrl:basePath+"task_edite.html",controller:"taskEditeCtrl"}}})}]);
var AttendanceMod=angular.module("AttendanceMod",["commonMod"]);AttendanceMod.controller("MyAttendCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,attendanceModel,permissionService){if(!permissionService.checkPermission("AttendanceMine"))return $state.go("main.index"),!1;var attend=$scope.attend={},param_attend=$scope.param_attend={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},attend.status=0,attend.begin_time="",attend.end_time="",attend.isStatusWin=!1,attend.arrSearchStatus=[{status:0,statusstr:"状态"},{status:1,statusstr:"正常"},{status:2,statusstr:"异常"}],param_attend.status=0,param_attend.begin_time="",param_attend.end_time="",param_attend.page=1,$scope.attend.attendList=[],attendanceModel.getMyAttend($scope),attend.searchButton=function(){return""!=attend.end_time&&""!=attend.begin_time&&attend.end_time-attend.begin_time<=0?void alert("结束时间必须大于开始时间"):($scope.page={curPage:1,tempcurPage:1,sumPage:0},param_attend.page=1,param_attend.status=attend.status,param_attend.begin_time=attend.begin_time,param_attend.end_time=attend.end_time,void attendanceModel.getMyAttend($scope))},attend.statusWinButton=function(){$("#sta").toggle()},attend.selectSearchStatus=function(status){attend.status=status,angular.element.each(attend.arrSearchStatus,function(key,val){val.status==status&&angular.element("#status").html(val.statusstr)}),$("#sta").hide()},$scope.page_fun=function(){$scope.param_attend.page=$scope.page.tempcurPage,attendanceModel.getMyAttend($scope)},$(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&$("#sta").hide()})});
AttendanceMod.controller("AllAttendCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,attendanceModel){var attend=$scope.attend={},param_attend=$scope.param_attend={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},attend.search_org_id="",attend.search_u_id="",attend.begin_time="",attend.end_time="",attend.search_org_name="",attend.search_org_name_temp="",attend.search_real_name="",attend.search_real_name_temp="",attend.isOrgWin=!1,attend.isMemWin=!1,param_attend.search_org_id="",param_attend.search_u_id="",param_attend.begin_time="",param_attend.end_time="",param_attend.page=1,attend.attendList=[],attend.orgInfo=[],attend.userInfo=[],attendanceModel.getAllAttend($scope),attend.searchButton=function(){return""!=attend.end_time&&""!=attend.begin_time&&attend.end_time-attend.begin_time<=0?void alert("结束时间必须大于开始时间"):(attend.isOrgWin=!1,attend.isMemWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},param_attend.page=1,""==attend.search_org_id&&(attend.search_org_name="",attend.search_org_name_temp=""),""==attend.search_u_id&&(attend.search_real_name="",attend.search_real_name_temp=""),param_attend.search_org_id=attend.search_org_id,param_attend.search_u_id=attend.search_u_id,param_attend.begin_time=attend.begin_time,param_attend.end_time=attend.end_time,void attendanceModel.getAllAttend($scope))},attend.getSearchAllOrgInfo=function(){attend.search_org_name="",attend.search_org_id="",attend.isMemWin=!1,attendanceModel.getOrgInfo($scope,1)},attend.searchOrgInfo=function(){attend.isMemWin=!1,attend.search_org_name!=attend.search_org_name_temp&&(attendanceModel.getOrgInfo($scope,0),attend.search_org_name_temp=attend.search_org_name)},attend.selectOrg=function(obj){attend.search_org_id=obj.value,attend.search_org_name=obj.label,attend.search_u_id="",attend.search_real_name="",attend.isOrgWin=!1},attend.searchAllUserInfo=function(){attend.isOrgWin=!1,attend.search_u_id="",attend.search_real_name="",attendanceModel.getUserInfo($scope)},attend.searchUserInfo=function(){attend.isOrgWin=!1,attend.search_real_name!=attend.search_real_name_temp&&(attendanceModel.getUserInfo($scope),attend.search_real_name_temp=attend.search_real_name)},attend.selectUser=function(obj){attend.search_u_id=obj.value,attend.search_real_name=obj.label,attend.isMemWin=!1},$scope.page_fun=function(){$scope.param_attend.page=$scope.page.tempcurPage,attendanceModel.getAllAttend($scope)},attend.leave=function(i){1==i&&(attend.isOrgWin=!1),2==i&&(attend.isMemWin=!1)}});
AttendanceMod.controller("AttendSetCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,attendanceModel){var attend=$scope.attend={};attend.begin_time="",attend.end_time="",attend.workday_time="",attend.workday_lose="",attend.unworkday_time="",attendanceModel.getAttenSet($scope),$scope.saveAttenSet=function(){attendanceModel.saveAttenSet($scope)},$scope.resetButton=function(){attend.begin_time="",attend.end_time="",attend.workday_time="",attend.workday_lose="",attend.unworkday_time=""}});
AttendanceMod.controller("vacationStat",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,attendanceModel){var attend=$scope.attend={},param_attend=$scope.param_attend={},vacation=$scope.vacation={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},attend.search_org_id="",attend.search_u_id="",attend.begin_time="",attend.end_time="",attend.search_org_name="",attend.search_org_name_temp="",attend.search_real_name="",attend.search_real_name_temp="",attend.isOrgWin=!1,attend.isMemWin=!1,param_attend.org_id="",param_attend.search_u_id="",param_attend.begin_time="",param_attend.end_time="",param_attend.search_name="",param_attend.page=1,attend.attendList=[],attend.orgInfo=[],attend.userInfo=[],$scope.vacation.vacationList=[],attendanceModel.getVacationStat($scope),attend.searchButton=function(){return""!=attend.end_time&&""!=attend.begin_time&&attend.end_time-attend.begin_time<=0?void alert("结束时间必须大于开始时间"):(attend.isOrgWin=!1,attend.isMemWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},param_attend.page=1,""==attend.search_org_id&&(attend.search_org_name="",attend.search_org_name_temp=""),""==attend.search_u_id&&(attend.search_real_name="",attend.search_real_name_temp=""),param_attend.org_id=attend.search_org_id,param_attend.search_u_id=attend.search_u_id,param_attend.search_name=attend.search_real_name,param_attend.begin_time=attend.begin_time,param_attend.end_time=attend.end_time,void attendanceModel.getVacationStat($scope))},attend.getSearchAllOrgInfo=function(){attend.search_org_name="",attend.search_org_id="",attend.isMemWin=!1,attendanceModel.getOrgInfo($scope,1)},attend.searchOrgInfo=function(){attend.isMemWin=!1,attend.search_org_name!=attend.search_org_name_temp&&(attendanceModel.getOrgInfo($scope,0),attend.search_org_name_temp=attend.search_org_name)},attend.selectOrg=function(obj){attend.search_org_id=obj.value,attend.search_org_name=obj.label,attend.search_u_id="",attend.search_real_name="",attend.isOrgWin=!1},attend.searchAllUserInfo=function(){attend.isOrgWin=!1,attend.search_u_id="",attend.search_real_name="",attendanceModel.getUserInfo($scope)},attend.searchUserInfo=function(){attend.isOrgWin=!1,attend.search_real_name!=attend.search_real_name_temp&&(attendanceModel.getUserInfo($scope),attend.search_real_name_temp=attend.search_real_name)},attend.selectUser=function(obj){attend.search_u_id=obj.value,attend.search_real_name=obj.label,attend.isMemWin=!1},$scope.page_fun=function(){$scope.param_attend.page=$scope.page.tempcurPage,attendanceModel.getVacationStat($scope)},attend.leave=function(i){1==i&&(attend.isOrgWin=!1),2==i&&(attend.isMemWin=!1)},vacation.export=function(){if(attend.start_time){var endM=attend.start_time.getMonth()+6,endY=attend.start_time.getFullYear();endM>12&&(endM-=12,endY++);var afterSixMonth=new Date(attend.start_time);afterSixMonth.setFullYear(endY),afterSixMonth.setMonth(endM)}0==attend.start_time||0==attend.end_time?alert("导出excel必须输入开始时间与结束时间"):attend.end_time>afterSixMonth?alert("只能导出时间跨度为6个月内的数据"):attend.end_time-attend.start_time<0?alert("结束时间必须大于开始时间"):(attend.search_name=attend.search_real_name,attend.org_id=attend.search_org_id,$http.get("/index.php?r=vacation/vacation/has-content&args="+JSON.stringify(attend)).success(function(data){0==data.code?alert(data.msg):window.location.href="/index.php?r=vacation/vacation/exportexcel&args="+JSON.stringify(attend)}))}});
AttendanceMod.controller("AttendCountCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,attendanceModel){var attend=$scope.attend={},param_attend=$scope.param_attend={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},attend.search_org_id="",attend.search_u_id="",attend.begin_time="",attend.end_time="",attend.search_org_name="",attend.search_org_name_temp="",attend.search_real_name="",attend.search_real_name_temp="",attend.isOrgWin=!1,attend.isMemWin=!1,param_attend.search_org_id="",param_attend.search_u_id="",param_attend.begin_time="",param_attend.end_time="",param_attend.page=1,attend.attendList=[],attend.orgInfo=[],attend.userInfo=[],attendanceModel.getAttendCount($scope),attend.searchButton=function(){return attend.isOrgWin=!1,attend.isMemWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},param_attend.page=1,""==attend.search_org_id&&(attend.search_org_name="",attend.search_org_name_temp=""),""==attend.search_u_id&&(attend.search_real_name="",attend.search_real_name_temp=""),param_attend.search_org_id=attend.search_org_id,param_attend.search_u_id=attend.search_u_id,param_attend.begin_time=attend.begin_time,param_attend.end_time=attend.end_time,""!=param_attend.end_time&&""!=param_attend.begin_time&&param_attend.end_time-param_attend.begin_time<=0?void alert("结束时间必须大于开始时间"):void attendanceModel.getAttendCount($scope)},attend.getSearchAllOrgInfo=function(){attend.search_org_name="",attend.search_org_id="",attend.isMemWin=!1,attendanceModel.getOrgInfo($scope,1)},attend.searchOrgInfo=function(){attend.isMemWin=!1,attend.search_org_name!=attend.search_org_name_temp&&(attendanceModel.getOrgInfo($scope,0),attend.search_org_name_temp=attend.search_org_name)},attend.selectOrg=function(obj){attend.search_org_id=obj.value,attend.search_org_name=obj.label,attend.search_u_id="",attend.search_real_name="",attend.isOrgWin=!1},attend.searchAllUserInfo=function(){attend.isOrgWin=!1,attend.search_u_id="",attend.search_real_name="",attendanceModel.getUserInfo($scope)},attend.searchUserInfo=function(){attend.isOrgWin=!1,attend.search_real_name!=attend.search_real_name_temp&&(attendanceModel.getUserInfo($scope),attend.search_real_name_temp=attend.search_real_name)},attend.selectUser=function(obj){attend.search_u_id=obj.value,attend.search_real_name=obj.label,attend.isMemWin=!1},$scope.page_fun=function(){$scope.param_attend.page=$scope.page.tempcurPage,attendanceModel.getAttendCount($scope)},attend.expExcel=function(){if(attend.begin_time){var endM=attend.begin_time.getMonth()+6,endY=attend.begin_time.getFullYear();endM>12&&(endM-=12,endY++);var afterSixMonth=new Date(attend.begin_time);afterSixMonth.setFullYear(endY),afterSixMonth.setMonth(endM)}0==attend.begin_time||0==attend.end_time?alert("导出excel必须输入开始时间与结束时间"):attend.end_time>afterSixMonth?alert("只能导出时间跨度为6个月内的数据"):attend.end_time-attend.begin_time<0?alert("结束时间必须大于开始时间"):(attend.is_check=1,$http.get("index.php?r=attendance/attendance/attend-count-exp&args="+JSON.stringify(attend)).success(function(data){"没有需要导出的内容"==data||"导出数据超过限制,请输入查询条件，再导出数据"==data?alert(data):(attend.is_check=0,window.location.href="index.php?r=attendance/attendance/attend-count-exp&args="+JSON.stringify(attend))}))},attend.leave=function(i){1==i&&(attend.isOrgWin=!1),2==i&&(attend.isMemWin=!1)}});
AttendanceMod.factory("attendanceModel",function($http,$state){var service={};return service.getMyAttend=function($scope){$http.post("/index.php?r=attendance/attendance/my-attend",JSON.stringify($scope.param_attend)).success(function(data,status){$scope.attend.attendList=data.data.myattendList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage})},service.getAllAttend=function($scope){$http.post("/index.php?r=attendance/attendance/all-attend",JSON.stringify($scope.param_attend)).success(function(data,status){$scope.attend.attendList=data.data.attendList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage})},service.getAttendCount=function($scope){$http.post("/index.php?r=attendance/attendance/attend-count",JSON.stringify($scope.param_attend)).success(function(data,status){$scope.attend.attendList=data.data.attendList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage})},service.getAttenSet=function($scope){$http.post("/index.php?r=attendance/attendance/get-attend-set",{}).success(function(data,status){$scope.attend.begin_time=data.data.begin_time,$scope.attend.end_time=data.data.end_time,$scope.attend.workday_time=data.data.workday_time,$scope.attend.workday_lose=data.data.workday_lose,$scope.attend.unworkday_time=data.data.unworkday_time})},service.saveAttenSet=function($scope){$http.post("/index.php?r=attendance/attendance/attend-set",JSON.stringify($scope.attend)).success(function(data,status){1==data.code?alert(data.msg):data.code==-1&&(alert(data.msg),$state.go("main.attendance.attendset",{},{reload:!0}))})},service.getOrgInfo=function($scope,type){$http.post("/index.php?r=attendance/attendance/org-info",{search_org_name:$scope.attend.search_org_name}).success(function(data,status){if($scope.attend.orgInfo=data.data,1==type){var temp=[];temp.org_id=0,temp.org_name="部门",$scope.attend.orgInfo.unshift(temp)}$scope.attend.isOrgWin=!0})},service.getUserInfo=function($scope){$http.post("/index.php?r=attendance/attendance/member-info",{search_org_id:$scope.attend.search_org_id,search_real_name:$scope.attend.search_real_name}).success(function(data,status){$scope.attend.userInfo=data.data,$scope.attend.isMemWin=!0})},service.getVacationStat=function($scope){$http.post("/index.php?r=vacation/vacation/statistic",JSON.stringify($scope.param_attend)).success(function(data,status){$scope.vacation.vacationList=data.data.vacation_list,$scope.page.curPage=data.data.page,$scope.page.sumPage=data.data.total_page})},service});
AttendanceMod.controller("VacationMgnCtrl",function($scope,$http,$state,VacationMgnModel,noticeService,Publicfactory,permissionService){function isInteger(obj){return Math.floor(obj)==obj}if(!permissionService.checkPermission("AttendanceVacationmgn"))return $state.go("main.index"),!1;var vacation=$scope.vacationMgn={};vacation.popupVacationCtr=!1,vacation.popupVacationChangeCtr=!1,vacation.popupTuneCtr=!1,vacation.searchOrgName="",vacation.vacationLeave="",vacation.vacationLeaveReason="",vacation.orgName="部门",vacation.valueBefore="",vacation.orgId="",vacation.filterOrgName="",vacation.searchName="",vacation.uid="",vacation.name="成员",vacation.pageType="",vacation.logType="",vacation.statusCtr=!1,vacation.userStatusCtr=!1,vacation.currentPage="",vacation.vacationSet="",vacation.showVacationSet=!1,vacation.noticeService=noticeService,$scope.department=[],$scope.memberListInfo=[],$scope.vacationDataList=[],$scope.changeRecordList=[],$scope.page={curPage:1,tempcurPage:1,sumPage:0},VacationMgnModel.getDepartmentInfo($scope,vacation.searchOrgName),VacationMgnModel.getVacationDataInfo($scope,vacation.orgId,vacation.searchName),$scope.taskPaging=function(){vacation.currentPage=$scope.page.tempcurPage,VacationMgnModel.getVacationDataInfo($scope,vacation.orgId,vacation.searchName,"",vacation.currentPage)},vacation.searchOrg=function(){vacation.searchOrgName=$scope.vacationMgn.searchOrgName,VacationMgnModel.getDepartmentInfo($scope,vacation.searchOrgName),vacation.statusCtr=!0},vacation.departmentSelectPopup=function(){vacation.statusCtr=!vacation.statusCtr},vacation.memberSelectPopup=function(){vacation.userStatusCtr=!vacation.userStatusCtr,VacationMgnModel.getMemberListInfo($scope,vacation.orgId,vacation.searchName)},vacation.selectOrgName=function(obj){vacation.searchOrgName=obj.label,vacation.orgId=obj.value,vacation.name="成员",vacation.uid="",vacation.statusCtr=!1,VacationMgnModel.getMemberListInfo($scope,vacation.orgId)},vacation.selectUserName=function(obj){vacation.searchName=obj.label,vacation.uid=obj.value,vacation.userStatusCtr=!1},vacation.searchUserName=function(){vacation.userStatusCtr=!0,vacation.searchName=$scope.vacationMgn.searchName,VacationMgnModel.getMemberListInfo($scope,vacation.orgId,vacation.searchName)},vacation.searchVacation=function(){$scope.page={curPage:1,tempcurPage:1,sumPage:0},VacationMgnModel.getVacationDataInfo($scope,vacation.orgId,vacation.searchName)},vacation.outVacationData=function(){VacationMgnModel.outGetVacationData($scope,vacation.orgId,vacation.searchName)},vacation.modifyLeavePopup=function(uid,valueBefore){vacation.uid=uid,vacation.valueBefore=valueBefore,vacation.popupCtr=!0,vacation.pageType=1,$("#masklayer1").show()},vacation.hidePopupCtr=function(){$scope.vacationMgn.vacationLeave="",$scope.vacationMgn.tuneVacation="",$scope.vacationMgn.vacationLeaveReason="",vacation.popupCtr=!1,$("#masklayer1").hide()},vacation.modifyPopup=function(uid,valueBefore){vacation.uid=uid,vacation.valueBefore=valueBefore,vacation.popupTuneCtr=!0,vacation.pageType=2,$("#masklayer1").show()},vacation.hidePopupTuneCtr=function(){$scope.vacationMgn.tuneVacation="",$scope.vacationMgn.vacationLeave="",$scope.vacationMgn.vacationLeaveReason="",vacation.popupTuneCtr=!1,$("#masklayer1").hide()},vacation.modifyVacationLeave=function(valueBefore){return vacation.vacationLeave=$scope.vacationMgn.vacationLeave,vacation.vacationLeaveReason=$scope.vacationMgn.vacationLeaveReason,vacation.vacationLeave>15||vacation.vacationLeave<-15?void alert("输入不能超过15天，请输入年假天数！"):vacation.vacationLeave%.5!=0||0==vacation.vacationLeave.length?void alert("输入天数不是0.5的整数倍，请输入年假天数！"):Publicfactory.checkEnCnstrlen(vacation.vacationLeaveReason)<=0||Publicfactory.checkEnCnstrlen(vacation.vacationLeaveReason)>60?void alert("请输入修改原因,且不能超过30个字！"):void VacationMgnModel.modifyVacationLeave($scope,vacation.uid,vacation.vacationLeave,vacation.valueBefore,vacation.vacationLeaveReason)},vacation.modifyTuneVacation=function(){return vacation.vacationLeave=$scope.vacationMgn.tuneVacation,vacation.vacationLeaveReason=$scope.vacationMgn.vacationLeaveReason,vacation.vacationLeave%.5!=0||0==vacation.vacationLeave?void alert("输入天数不是0.5的整数倍，请输入调休天数！"):Publicfactory.checkEnCnstrlen(vacation.vacationLeaveReason)<=0||Publicfactory.checkEnCnstrlen(vacation.vacationLeaveReason)>60?void alert("请输入修改原因,且不能超过30个字！"):void VacationMgnModel.modifyTuneVacation($scope,vacation.uid,vacation.vacationLeave,vacation.valueBefore,vacation.vacationLeaveReason)},vacation.getChangeRecord=function(uid,logType){vacation.uid=uid,vacation.logType=logType,VacationMgnModel.getChangeRecord($scope,vacation.uid,vacation.logType),vacation.popupVacationChangeCtr=!0,$("#masklayer1").show()},vacation.closeChangeRecord=function(){vacation.popupVacationChangeCtr=!1,$("#masklayer1").hide()},vacation.setVacation=function(){VacationMgnModel.getVacationSet($scope),vacation.showVacationSet=!0,$("#masklayer1").show()},vacation.saveSet=function(){return""==vacation.vacationSet.ini_annual_vacation||""==vacation.vacationSet.overtime_expire?void alert("假期设置数据不能为空"):!isInteger(vacation.vacationSet.ini_annual_vacation)||vacation.vacationSet.ini_annual_vacation<0?void alert("初始年假只能为非负整数"):!isInteger(vacation.vacationSet.overtime_expire)||vacation.vacationSet.overtime_expire<0?void alert("调休假失效时间只能为非负整数"):void VacationMgnModel.saveVacationSet($scope,vacation.vacationSet.ini_annual_vacation,vacation.vacationSet.overtime_expire)},vacation.reSet=function(){vacation.vacationSet.ini_annual_vacation="",vacation.vacationSet.overtime_expire=""},vacation.back=function(){vacation.showVacationSet=!1,$("#masklayer1").hide()}});
AttendanceMod.factory("VacationMgnModel",function($http,$state){var vacationService={};return vacationService.getDepartmentInfo=function($scope,orgName){$http.post("/index.php?r=attendance/attendance/org-info",{search_org_name:orgName}).success(function(data){$scope.department=data.data})},vacationService.getMemberListInfo=function($scope,orgId,searchName){$http.post("/index.php?r=attendance/attendance/member-info",{search_org_id:orgId,search_real_name:searchName}).success(function(data){$scope.memberListInfo=data.data})},vacationService.getVacationDataInfo=function($scope,orgId,userName,pageSize,curPage){$http.post("/index.php?r=attendance/vacation-mgn/annual-vacations",{orgId:orgId,userName:userName,pageSize:pageSize,curPage:curPage}).success(function(data){$scope.vacationDataList=data.data.vacationData,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},vacationService.outGetVacationData=function($scope,orgId,userName){window.location.href="/index.php?r=attendance/vacation-mgn/vacation-excel&orgId="+orgId+"&userName="+userName},vacationService.modifyVacationLeave=function($scope,uid,increment,valueBefore,reason){$http.post("/index.php?r=attendance/vacation-mgn/edit-annual-vacation",{uid:uid,increment:increment,valueBefore:valueBefore,reason:reason,p_code:"AttendanceVacationmgn"}).success(function(data){return 0==data.code?void alert(data.msg):void(2e4==data.code&&(alert(data.msg),$scope.vacationMgn.vacationLeave="",$scope.vacationMgn.vacationLeaveReason="",$scope.vacationMgn.popupCtr=!1,$("#masklayer1").hide(),1==$scope.vacationMgn.pageType?vacationService.getVacationDataInfo($scope,$scope.vacationMgn.orgId,$scope.vacationMgn.searchName,"",$scope.page.tempcurPage):(vacationService.getVacationDataInfo($scope,$scope.vacationMgn.orgId,$scope.vacationMgn.searchName),$scope.page={curPage:1,tempcurPage:1,sumPage:0})))})},vacationService.modifyTuneVacation=function($scope,uid,increment,valueBefore,reason){$http.post("/index.php?r=attendance/vacation-mgn/edit-tune-vacation",{uid:uid,increment:increment,valueBefore:valueBefore,reason:reason,p_code:"AttendanceVacationmgn"}).success(function(data){return 0==data.code?void alert(data.msg):void(2e4==data.code&&(alert(data.msg),$scope.vacationMgn.tuneVacation="",$scope.vacationMgn.vacationLeave="",$scope.vacationMgn.vacationLeaveReason="",$scope.vacationMgn.popupTuneCtr=!1,$("#masklayer1").hide(),2==$scope.vacationMgn.pageType?vacationService.getVacationDataInfo($scope,$scope.vacationMgn.orgId,$scope.vacationMgn.searchName,"",$scope.page.tempcurPage):(vacationService.getVacationDataInfo($scope,$scope.vacationMgn.orgId,$scope.vacationMgn.searchName),$scope.page={curPage:1,tempcurPage:1,sumPage:0})))})},vacationService.getChangeRecord=function($scope,uid,logType){$http.post("/index.php?r=attendance/vacation-mgn/change-record",{uid:uid,logType:logType}).success(function(data){$scope.changeRecordList=data.data.changeRecord})},vacationService.getVacationSet=function($scope){$http.get("/index.php?r=vacation/vacation/view-set").success(function(data){$scope.vacationMgn.vacationSet=data.data})},vacationService.saveVacationSet=function($scope,ini_annual_vacation,overtime_expire){$http.post("/index.php?r=vacation/vacation/vacation-set",{ini_annual_vacation:ini_annual_vacation,overtime_expire:overtime_expire}).success(function(data){2e4==data.code?($scope.vacationMgn.showVacationSet=!1,$("#masklayer1").hide()):alert(data.msg)})},vacationService});
AttendanceMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/attendance/view/";$stateProvider.state("main.attendance",{url:"/attendance",module:"private",data:{css:["css/attendance.css","css/lib/datetimepicker.css"]},views:{"attendanceContent@main":{templateUrl:basePath+"attendance_content.html"}}}).state("main.attendance.myattend",{url:"/myattend",module:"private",views:{"myattend@main.attendance":{templateUrl:basePath+"myattend.html",controller:"MyAttendCtrl"}}}).state("main.attendance.allattend",{url:"/allattend",module:"private",views:{"allattend@main.attendance":{templateUrl:basePath+"allattend.html",controller:"AllAttendCtrl"}}}).state("main.attendance.holidaySta",{url:"/holidaySta",module:"private",views:{"holidaySta@main.attendance":{templateUrl:basePath+"holidaySta.html",controller:"vacationStat"}}}).state("main.attendance.holidayManage",{url:"/holidayManage",module:"private",views:{"holidayManage@main.attendance":{templateUrl:basePath+"holidayManage.html",controller:"VacationMgnCtrl"}}}).state("main.attendance.attendset",{url:"/attendset",module:"private",views:{"attendset@main.attendance":{templateUrl:basePath+"attendset.html",controller:"AttendSetCtrl"}}}).state("main.attendance.attendcount",{url:"/attendcount",module:"private",views:{"attendSta@main.attendance":{templateUrl:basePath+"attendcount.html",controller:"AttendCountCtrl"}}})}]);
var NoticeMod=angular.module("NoticeMod",[]);NoticeMod.controller("NoticeListCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,$location,noticeModel,$stateParams,permissionService){if(!permissionService.checkPermission("NoticeView"))return $state.go("main.index",{},{reload:!1}),!1;var notice=$scope.notice={},search_notice=$scope.search_notice={},userInfo=$cookieStore.get("userInfo");if(notice.noticelist=[],notice.noticeDetail=[],notice.is_manage=!1,notice.isNoticeDetailWin=!1,notice.notice_id="",notice.title="",notice.begin_time="",notice.end_time="",notice.isDelConfirmWin=!1,notice.delTag=0,notice.delObj={},search_notice.title="",search_notice.begin_time="",search_notice.end_time="",search_notice.page=1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},notice.noticeDetailButton=function(notice_id){notice.notice_id=notice_id,notice.is_manage||angular.element.each($scope.notice.noticelist,function(key,val){val.notice_id!=notice.notice_id||val.notice_read_id||($scope.notice.noticelist[key].notice_read_id=userInfo.u_id)}),noticeModel.getNoticeDetail($scope)},notice.path=$location.path(),notice.path.indexOf("notice/noticeManage")>0)notice.is_manage=!0;else{var notice_id=$stateParams.notice_id?$stateParams.notice_id:0;notice_id>0&&notice.noticeDetailButton(notice_id)}noticeModel.getNoticeList($scope,!1),notice.searchButton=function(){return notice.title.length>40?void alert("公告标题长度最多支持40个字"):""!=notice.end_time&&""!=notice.begin_time&&notice.end_time-notice.begin_time<0?void alert("结束时间必须大于等于开始时间"):($scope.page={curPage:1,tempcurPage:1,sumPage:0},search_notice.title=notice.title,search_notice.begin_time=notice.begin_time,search_notice.end_time=notice.end_time,search_notice.page=1,void noticeModel.getNoticeList($scope,!1))},$scope.page_fun=function(){search_notice.page=$scope.page.tempcurPage,noticeModel.getNoticeList($scope,!1)},notice.noticeCloseDetail=function(){notice.isNoticeDetailWin=!1,$("#masklayer1").hide()},notice.openDelConfirmWin=function(obj,i){i<0?notice.delTag=-1:notice.delTag=1,notice.delObj=obj,notice.isDelConfirmWin=!0,$("#masklayer1").css("z-index",400),$("#masklayer1").show()},notice.closeDelConfirmWin=function(){notice.isDelConfirmWin=!1,$("#masklayer1").css("z-index",200),notice.delTag<0&&$("#masklayer1").hide()},notice.delNotice=function(obj){notice.isDelConfirmWin=!1,$("#masklayer1").css("z-index",200),notice.delTag<0&&$("#masklayer1").hide(),noticeModel.delNotice($scope,obj.notice_id)},notice.downFileBtn=function(obj){noticeModel.fileDownload($scope,obj.file_path,obj.real_name,obj.file_name,obj.file_size)}});
NoticeMod.controller("NoticeCreateCtrl",function($scope,$http,$rootScope,Publicfactory,$cookies,$cookieStore,$state,$location,noticeModel,FileUploader){var notice=$scope.notice={},paramobj=$scope.paramobj={};paramobj.title="",paramobj.content="",paramobj.att=[],$scope.att=[],notice.addButton=function(){paramobj.att=$scope.att;var ue=UE.getEditor("container");return paramobj.content=ue.getContent(),Publicfactory.checkEnCnstrlen(ue.getContentTxt())>1e4?(alert("公告内容不能超过5000字"),!1):void noticeModel.addNotice($scope)},$scope.addAttBtn=function(Uploader){Uploader.url="/index.php?r=notice/notice/upload",Uploader.onCompleteItem=function(fileItem,response,status,headers){console.log(response),1==response.code?$scope.att.push(response.data.data):0==response.code&&(fileItem.remove(),console.log(7899999),alert(response.msg))}},notice.delFileBtn=function(index){$scope.att.splice(index,1)},notice.resetButton=function(){paramobj.title="",paramobj.content="",paramobj.att=[],$scope.att=[],ue.setContent("")}});
NoticeMod.factory("noticeModel",function($http,$state,$sce){var service={};return service.getNoticeList=function($scope,isdel){$http.post("/index.php?r=notice/notice/get-notice",JSON.stringify($scope.search_notice)).success(function(data,status){$scope.notice.noticelist=data.data.notList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage,isdel&&alert("删除成功")})},service.getNoticeDetail=function($scope){var isSetRead=$scope.notice.is_manage?1:0;$http.post("/index.php?r=notice/notice/notice-detail",{notice_id:$scope.notice.notice_id,is_manager:isSetRead}).success(function(data,status){1==data.code?($scope.notice.noticeDetail=data.data,$scope.notice.noticeDetail.content=$sce.trustAsHtml($scope.notice.noticeDetail.content),$scope.notice.isNoticeDetailWin=!0,$("#masklayer1").show()):(service.getNoticeList($scope,!1),alert(data.msg))})},service.addNotice=function($scope){$http.post("/index.php?r=notice/notice/create-notice",JSON.stringify($scope.paramobj)).success(function(data,status){1==data.code?($state.go("main.notice.noticeManage"),alert(data.msg)):alert(data.msg)})},service.delNotice=function($scope,notice_id){$http.post("/index.php?r=notice/notice/del-notice",{notice_id:notice_id}).success(function(data,status){service.getNoticeList($scope,!0),$scope.notice.isNoticeDetailWin=!1,$("#masklayer1").hide()})},service.fileDownload=function($scope,file_path,real_name,file_name,file_size){window.location.href="/index.php?r=notice/notice/downfile&filepath="+encodeURI("/"+file_path+"/"+real_name)+"&file_name="+file_name+"&file_size="+file_size},service});
NoticeMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/notice/view/";$stateProvider.state("main.notice",{url:"/notice",module:"private",data:{css:["css/lib/datetimepicker.css","css/attendance.css","css/notice.css","css/task.css"]},views:{"noticeContent@main":{templateUrl:basePath+"notice_content.html"}}}).state("main.notice.noticeQuery",{url:"/noticeQuery/:notice_id",module:"private",views:{"noticeQuery@main.notice":{templateUrl:basePath+"noticeQuery.html",controller:"NoticeListCtrl"}}}).state("main.notice.noticeManage",{url:"/noticeManage",module:"private",views:{"noticeManage@main.notice":{templateUrl:basePath+"noticeManage.html",controller:"NoticeListCtrl"}}}).state("main.notice.noticecreate",{url:"/noticecreate",module:"private",views:{"noticecreate@main.notice":{templateUrl:basePath+"noticecreate.html",controller:"NoticeCreateCtrl"}}})}]);
var MeetingMod=angular.module("MeetingMod",[]);MeetingMod.controller("Reserve",function($scope,$http,$rootScope,ConferenceRoomModel,$state,$timeout,$cookieStore,$filter,permissionService){if(!permissionService.checkPermission("BoadroomBoad"))return $state.go("main.index"),!1;var conference=$scope.conferenceRoom={},dateFilter=$filter("date");if($scope.conferenceRoomList=[],conference.userInfoUid=$cookieStore.get("userInfo").u_id,conference.galleryId=$cookieStore.get("userInfo").gallery,conference.resId="",conference.firstBookTime="9:00",conference.lastBookTime="9:30",conference.popupStatusCtr=!1,conference.popupBookCtr=!1,conference.popupRoomCtr=!1,conference.isShowGuid=!1,conference.beginTime="",conference.weekAfterTime="",conference.selectedType=[],conference.myDate=new Date,conference.cancelTimeElement="",conference.searchTime=conference.myDate.valueOf(),conference.curTime=conference.myDate.getFullYear()+"-"+(conference.myDate.getMonth()+1)+"-"+conference.myDate.getDate(),conference.bookTime="",conference.popupStatusOneCtr=!1,conference.meetingName="",conference.meetingDesc="",conference.memberDropCtr=!1,conference.searchMemberName="",conference.allMemberList=[],conference.bookRoom_name="",conference.selectMemberSum=0,conference.cancelBookTime=[],conference.allMemberPageList=[],conference.typeFlag="",conference.roomArr=[],conference.reserveTime=[["9:00","9:30",0,{}],["9:30","10:00",0,{}],["10:00","10:30",0,{}],["10:30","11:00",0,{}],["11:00","11:30",0,{}],["11:30","12:00",0,{}],["13:30","14:00",0,{}],["14:00","14:30",0,{}],["14:30","15:00",0,{}],["15:00","15:30",0,{}],["15:30","16:00",0,{}],["16:00","16:30",0,{}],["16:30","17:00",0,{}],["17:00","17:30",0,{}],["17:30","18:00",0,{}]],conference.reserveTimeArr=[],ConferenceRoomModel.getConferenceRoomList($scope,conference.curTime),conference.getSelected=function(){conference.selectedType=[],conference.typeFlag="",angular.element(".reserve-bar .time-select").find("li").each(function(){if($(this).hasClass("reserve-green")){var tmp={timeId:$(this).attr("timeId"),roomId:$(this).attr("roomId")};conference.selectedType.push(tmp)}});var flag=conference.selectedType[0].timeId,flagOne=conference.selectedType[conference.selectedType.length-1].timeId;flagOne-flag!=conference.selectedType.length-1&&(conference.typeFlag=1)},conference.removeSelected=function(){conference.selectedType=[],angular.element(".reserve-bar .time-select").find("li").each(function(){0==$(this).hasClass("reserve-green")||$(this).removeClass("reserve-green").addClass("reserve-white")})},$("div.meeting").mousedown(function(){$("ul.time-select").delegate("li","mousemove",function(){$(this).hasClass("reserve-blue")||$(this).hasClass("reserve-gray")||$(this).removeClass("reserve-white").addClass("reserve-green")}),$("div.reserve-bar").mouseleave(function(){console.log($(this)),conference.getSelected(),conference.firstBookTime=conference.reserveTime[conference.selectedType[0].timeId][0],conference.lastBookTime=conference.reserveTime[conference.selectedType[conference.selectedType.length-1].timeId][1],conference.bookTime=dateFilter(conference.searchTime,"yyyy-MM-dd")+" "+conference.firstBookTime+"-"+conference.lastBookTime,conference.popupRoomCtr=!0,conference.popupRoomCtr=!0,$scope.$apply(),$("#masklayer1").show()}),$("div.reserve-bar").mouseup(function(e){$(this).find("li").hasClass("reserve-green")&&(conference.getSelected(),conference.firstBookTime=conference.reserveTime[conference.selectedType[0].timeId][0],conference.lastBookTime=conference.reserveTime[conference.selectedType[conference.selectedType.length-1].timeId][1],conference.bookTime=dateFilter(conference.searchTime,"yyyy-MM-dd")+" "+conference.firstBookTime+"-"+conference.lastBookTime,conference.popupRoomCtr=!0,$scope.$apply(),$("#masklayer1").show())})}),$("div.meeting-section").delegate(".reserve-bar li","click",function(){$(this).hasClass("reserve-blue")||$(this).hasClass("reserve-gray")||($(this).removeClass("reserve-white").addClass("reserve-green"),conference.getSelected(),conference.firstBookTime=conference.reserveTime[conference.selectedType[0].timeId][0],conference.lastBookTime=conference.reserveTime[conference.selectedType[conference.selectedType.length-1].timeId][1],conference.bookTime=dateFilter(conference.searchTime,"yyyy-MM-dd")+" "+conference.firstBookTime+"-"+conference.lastBookTime,conference.popupRoomCtr=!0,$scope.$apply(),$("#masklayer1").show())}),$(document).mouseup(function(){$("ul.time-select").undelegate(),$("div.reserve-bar").unbind("mouseleave"),$("div.reserve-bar").unbind("mouseup")}),$(".packUp").click(function(){$(".reserve-msg").slideToggle(function(){var span=$(".packUp span"),i=$(".packUp i");"收起"==span.html()?(span.html("编辑会议室详情"),i.html("&#xe609;"),$(".packUp").css("left","175px")):(span.html("收起"),i.html("&#xe608;"),$(".packUp").css("left","200px"))})}),conference.cancelBookRoom=function(){conference.meetingName="",conference.meetingDesc="",conference.allMemberPageList.splice(0,conference.allMemberPageList.length),conference.selectMemberSum=0,conference.popupRoomCtr=!1,conference.removeSelected(),$("#masklayer1").hide(),$(".reserve-msg").slideUp(function(){var span=$(".packUp span"),i=$(".packUp i");span.html("编辑会议室详情"),i.html("&#xe609;"),$(".packUp").css("left","175px")})},conference.sureReserve=function(event){return conference.beginTime=Date.parse(dateFilter(conference.searchTime,"yyyy-MM-dd")+" "+conference.firstBookTime),conference.beginTime/1e3>conference.weekAfterTime?void alert("可预订时间为一周内！"):1==conference.typeFlag?void alert("所选时间段不连续,请重新选择！"):conference.beginTime<(new Date).valueOf()?void alert("预定时间已过期！"):conference.meetingName.length>20?void alert("会议室名称不能超过20个字！"):conference.meetingDesc.length>50?void alert("会议室说明不能超过50个字！"):void ConferenceRoomModel.bookMeetingRoom($scope,conference.selectedType,dateFilter(conference.searchTime,"yyyy-MM-dd"),conference.bookRoom_name,conference.bookTime,$scope.conferenceRoom.meetingName,$scope.conferenceRoom.meetingDesc,conference.allMemberPageList)},conference.getReserveId=function(event,resId){conference.resId=resId,conference.selectedType=[];var el=window.event||event;conference.cancelBookTime=[],angular.element(el.target).parents(".time-select").eq(0).find("li").each(function(index,one){if(conference.resId&&$(this).attr("reserve_id")==conference.resId&&$(this).hasClass("reserve-blue")){$("#masklayer1").show();var pem=conference.reserveTime[index];conference.cancelBookTime.push(pem),conference.firstBookTime=conference.cancelBookTime[0][0],conference.lastBookTime=conference.cancelBookTime[conference.cancelBookTime.length-1][1],conference.bookTime=dateFilter(conference.searchTime,"yyyy-MM-dd")+" "+conference.firstBookTime+"-"+conference.lastBookTime}}),el=el.target,angular.element(el).parents("li").eq(0).hasClass("reserve-blue")&&(conference.cancelTimeElement=angular.element(el).parents("li").eq(0),conference.popupStatusCtr=!conference.popupStatusCtr)},conference.cancelReserve=function(event){if(conference.popupStatusCtr=!conference.popupStatusCtr,""!=conference.cancelTimeElement&&conference.cancelTimeElement.hasClass("reserve-blue")){if(Date.parse(dateFilter(conference.searchTime,"yyyy-MM-dd")+" "+conference.firstBookTime)<(new Date).valueOf())return alert("时间已过期！"),void $("#masklayer1").hide();ConferenceRoomModel.cancelReserve($scope,conference.resId)}},conference.cancelBookMt=function(){conference.popupStatusCtr=!1,$("#masklayer1").hide()},conference.mouseActionUpCtr=function(event){var el=window.event||event;el=el.target,angular.element(el).parents("li").eq(0).hasClass("reserve-gray")||angular.element(el).hasClass("reserve-gray")?(angular.element(el).parents("li").eq(0).parents("ul").eq(0).find(".reserved-msg").hide(),angular.element(el).parents("li").eq(0).find(".reserved-msg").show(),angular.element(el).find(".reserved-msg").show()):angular.element(el).parents("li").eq(0).parents("ul").eq(0).find(".reserved-msg").hide()},conference.mouseActionDownCtr=function(event,bookName){var el=window.event||event;el=el.target,angular.element(el).find(".reserved-msg").hide(),angular.element(el).parents("li").eq(0).find(".reserved-msg").hide(),conference.bookRoom_name=bookName},conference.searchTimeRoom=function(){ConferenceRoomModel.getConferenceRoomList($scope,dateFilter($scope.conferenceRoom.searchTime,"yyyy-MM-dd"))},conference.memberListCtr=function(){conference.memberDropCtr=!conference.memberDropCtr,ConferenceRoomModel.getAllMembers($scope)},conference.selectMemberList=function(hearImg,name,uid){conference.memberDropCtr=!1;var data={headImg:hearImg,realName:name,uid:uid};conference.allMemberPageList.push(data);for(var isRepeated,result=[],len=conference.allMemberPageList.length,i=0;i<len;i++){isRepeated=!1;for(var resultLen=result.length,j=0;j<resultLen;j++)if(conference.allMemberPageList[i].uid==result[j].uid){isRepeated=!0;break}isRepeated||result.push(conference.allMemberPageList[i])}conference.allMemberPageList=result,conference.selectMemberSum=conference.allMemberPageList.length},conference.delMember=function(index){conference.allMemberPageList.splice(index,1),conference.selectMemberSum=conference.allMemberPageList.length},conference.clearMember=function(){conference.allMemberPageList.splice(0,conference.allMemberPageList.length),conference.selectMemberSum=conference.allMemberPageList.length},conference.memMouseLeave=function(){conference.memberDropCtr=!1,conference.searchMemberName=""},conference.getInputMemberList=function(){ConferenceRoomModel.getAllMembers($scope,$scope.conferenceRoom.searchMemberName)},1==conference.galleryId){var section=angular.element(".meeting-section");section.one("mouseenter",function(){conference.isShowGuid=!0,$scope.$apply(),$("#masklayer1").show();var timer=setTimeout(function(){conference.isShowGuid=!1,$scope.$apply(),$("#masklayer1").hide(),clearTimeout(timer)},4e3)})}conference.hideGuid=function(){conference.isShowGuid=!1,$("#masklayer1").hide(),ConferenceRoomModel.updateGalleryId(conference.userInfoUid)}});
MeetingMod.controller("ReserveManage",function($scope,$http,$rootScope,Publicfactory,ConferenceRoomModel,$state){var meeting=$scope.meetIng={};meeting.addShow=!1,meeting.hot="",meeting.dec="",meeting.name="",meeting.floor="",meeting.roomId="",meeting.meetingRoomList=[],meeting.editMeetingRoomList="",meeting.delMeetingPopupCtr=!1,meeting.delMeetingName="",meeting.delRoomId="",meeting.judgeNage="",meeting.flag=1,meeting.addBtn=function(){meeting.addShow=!0,$("#masklayer1").show()},meeting.delMeetingPopup=function(meetingName,roomId){$("#masklayer1").show(),meeting.delMeetingPopupCtr=!0,meeting.delMeetingName=meetingName,meeting.delRoomId=roomId,$("#masklayer1").show()},meeting.cancelMeetingBtn=function(){$("#masklayer1").hide(),meeting.delMeetingPopupCtr=!1,$("#masklayer1").hide()},meeting.modifyShow=!1,meeting.modifyBtn=function(roomId){meeting.roomId=roomId,meeting.modifyShow=!0,$("#masklayer1").show(),ConferenceRoomModel.getMeetingRoom($scope,meeting.roomId)},meeting.delBtn=function(roomId){meeting.roomId=roomId},meeting.cancelBtn=function(){$scope.meetIng.hot="",$scope.meetIng.name="",$scope.meetIng.dec="",$scope.meetIng.floor="",meeting.addShow=!1,meeting.modifyShow=!1,$("#masklayer1").hide()},ConferenceRoomModel.getAllMeetingRoom($scope),meeting.editHot="",meeting.editName="",meeting.editDec="",meeting.editFloor="",meeting.reserveMeeting=function(){return meeting.hot=$scope.meetIng.hot,meeting.name=$scope.meetIng.name,meeting.dec=$scope.meetIng.dec,meeting.floor=$scope.meetIng.floor,Publicfactory.checkEnCnstrlen(meeting.name)<=0?void alert("请输入会议室名称！"):meeting.name.length>20?void alert("会议室名称不能超过20个字！"):Publicfactory.checkEnCnstrlen(meeting.dec)<=0?void alert("请输入会议室描述！"):Publicfactory.checkEnCnstrlen(meeting.floor)<=0?void alert("请输入会议室楼层！"):Publicfactory.checkEnCnstrlen(meeting.hot)<=0?void alert("请输入会议室排序！"):meeting.hot>=100||meeting.hot<=0||meeting.hot%1!=0?void alert("会议室排序为正整数且不能大于99！"):void ConferenceRoomModel.addMeetingRoom($scope,meeting.name,meeting.floor,meeting.dec,meeting.hot)},meeting.editMeetingRoom=function(){return meeting.editHot=$scope.meetIng.editHot,meeting.editName=$scope.meetIng.editName,meeting.editDec=$scope.meetIng.editDec,meeting.editFloor=$scope.meetIng.editFloor,Publicfactory.checkEnCnstrlen(meeting.editName)<=0?void alert("请输入会议室名称！"):meeting.editName.length>20?void alert("会议室名称不能超过20个字！"):Publicfactory.checkEnCnstrlen(meeting.editDec)<=0?void alert("请输入会议室描述！"):Publicfactory.checkEnCnstrlen(meeting.editFloor)<=0?void alert("请输入会议室楼层！"):Publicfactory.checkEnCnstrlen(meeting.editHot)<=0?void alert("请输入会议室排序！"):meeting.editHot%1!=0||meeting.editHot<0?void alert("会议室排序为正整数且不能大于99！"):meeting.editHot%1!=0||meeting.editHot>=100?void alert("会议室排序为正整数且不能大于99！"):(meeting.judgeNage!=meeting.editName&&(console.log(111),meeting.flag=2),void ConferenceRoomModel.editMeetingRoom($scope,meeting.roomId,meeting.editName,meeting.editDec,meeting.editFloor,meeting.editHot,meeting.flag))},meeting.delMeeting=function(roomId){meeting.roomId=roomId,ConferenceRoomModel.deleteMeetingRoom($scope,meeting.roomId)}});
MeetingMod.factory("ConferenceRoomModel",function($http,$state,$filter,$cookieStore){var conferenceRoom={},dateFilter=$filter("date");return conferenceRoom.getConferenceRoomList=function($scope,searchTime){$http.post("/index.php?r=boardroom/boardroom/room-reserve-list",{dataTime:searchTime}).success(function(data){2e4==data.code?($scope.conferenceRoomList=data.data.list,$scope.conferenceRoom.weekAfterTime=data.data.weekAfter,angular.forEach(data.data.list,function(one,index){$scope.conferenceRoom.reserveTimeArr[index]=[["9:00","9:30",0,{}],["9:30","10:00",0,{}],["10:00","10:30",0,{}],["10:30","11:00",0,{}],["11:00","11:30",0,{}],["11:30","12:00",0,{}],["13:30","14:00",0,{}],["14:00","14:30",0,{}],["14:30","15:00",0,{}],["15:00","15:30",0,{}],["15:30","16:00",0,{}],["16:00","16:30",0,{}],["16:30","17:00",0,{}],["17:00","17:30",0,{}],["17:30","18:00",0,{}]],angular.forEach(one.reserves,function(two,index2){one.reserves[index2].uid==$scope.conferenceRoom.userInfoUid?$scope.conferenceRoom.reserveTimeArr[index][two.time_type][2]=2:$scope.conferenceRoom.reserveTimeArr[index][two.time_type][2]=1,$scope.conferenceRoom.reserveTimeArr[index][two.time_type][3]=two})})):1==data.code&&alert(data.msg)})},conferenceRoom.bookMeetingRoom=function($scope,types,dataTime,meetingName,bookTime,meeting,meetingDesc,memberInfo){$http.post("/index.php?r=boardroom/boardroom/reserve",{types:types,dataTime:dataTime,meetingName:meetingName,bookTime:bookTime,meeting:meeting,meetingDesc:meetingDesc,memberInfo:memberInfo}).success(function(data){2e4==data.code?(alert(data.msg),$scope.conferenceRoom.meetingName="",$scope.conferenceRoom.meetingDesc="",$scope.conferenceRoom.allMemberPageList.splice(0,$scope.conferenceRoom.allMemberPageList.length),$scope.conferenceRoom.selectMemberSum=0,$(".reserve-msg").slideUp(function(){var span=$(".packUp span"),i=$(".packUp i");span.html("编辑会议室详情"),i.html("&#xe609;"),$(".packUp").css("left","175px")}),conferenceRoom.getConferenceRoomList($scope,dateFilter($scope.conferenceRoom.searchTime,"yyyy-MM-dd")),$scope.conferenceRoom.popupRoomCtr=!1,$("#masklayer1").hide()):1==data.code?alert(data.msg):2==data.code&&alert(data.msg)})},conferenceRoom.addMeetingRoom=function($scope,name,floor,desc,hot){$http.post("/index.php?r=boardroom/boardroom/add",{name:name,floor:floor,desc:desc,hot:hot}).success(function(data){2e4==data.code?(alert(data.msg),$scope.meetIng.addShow=!1,$("#masklayer1").hide(),conferenceRoom.getAllMeetingRoom($scope),$scope.meetIng.hot="",$scope.meetIng.name="",$scope.meetIng.dec="",$scope.meetIng.floor=""):data.code==-1&&alert(data.msg)})},conferenceRoom.getAllMeetingRoom=function($scope){$http.post("/index.php?r=boardroom/boardroom/select-all-meeting").success(function(data){$scope.meetingRoomList=data.data})},conferenceRoom.getMeetingRoom=function($scope,meetingId){$http.post("/index.php?r=boardroom/boardroom/get-meeting-info",{meetingId:meetingId}).success(function(data){$scope.meetIng.editMeetingRoomList=data.data,$scope.meetIng.editHot=$scope.meetIng.editMeetingRoomList.hot,$scope.meetIng.editName=$scope.meetIng.editMeetingRoomList.name,$scope.meetIng.judgeNage=$scope.meetIng.editMeetingRoomList.name,$scope.meetIng.editDec=$scope.meetIng.editMeetingRoomList.desc,$scope.meetIng.editFloor=$scope.meetIng.editMeetingRoomList.floor})},conferenceRoom.editMeetingRoom=function($scope,meetingId,name,desc,floor,hot,flag){$http.post("/index.php?r=boardroom/boardroom/edit-meeting-info",{meetingId:meetingId,name:name,desc:desc,floor:floor,hot:hot,flag:flag}).success(function(data){data.code==-1?alert(data.msg):(alert("修改成功！"),$scope.meetIng.modifyShow=!1,$("#masklayer1").hide(),$scope.meetIng.flag=1,conferenceRoom.getAllMeetingRoom($scope))})},conferenceRoom.deleteMeetingRoom=function($scope,meetingId){$http.post("/index.php?r=boardroom/boardroom/delete-meeting",{meetingId:meetingId}).success(function(data){$scope.meetIng.delMeetingPopupCtr=!1,$("#masklayer1").hide(),conferenceRoom.getAllMeetingRoom($scope)})},conferenceRoom.cancelReserve=function($scope,resId){$http.post("/index.php?r=boardroom/boardroom/cancel-reserve",{resId:resId}).success(function(data){2e4==data.code&&(alert("取消成功！"),conferenceRoom.getConferenceRoomList($scope,dateFilter($scope.conferenceRoom.searchTime,"yyyy-MM-dd")),$("#masklayer1").hide())})},conferenceRoom.getAllMembers=function($scope,realName){$http.post("/index.php?r=workmate/workmate/get-all-members",{realName:realName}).success(function(data){$scope.conferenceRoom.allMemberList=data.data})},conferenceRoom.sendEmail=function(meetingName,bookTime,meeting,meetingDesc,memberName){$http.post("/index.php?r=boardroom/boardroom/send-email",{meetingName:meetingName,bookTime:bookTime,meeting:meeting,meetingDesc:meetingDesc,memberName:memberName}).success(function(data){})},conferenceRoom.updateGalleryId=function(uid){$http.post("/index.php?r=boardroom/boardroom/update-gallery-id",{uid:uid}).success(function(data){var userInfo=$cookieStore.get("userInfo");userInfo.gallery=2,$cookieStore.put("userInfo",userInfo)})},conferenceRoom});
MeetingMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/meeting/view/";$stateProvider.state("main.meeting",{url:"/meeting",module:"private",data:{css:["css/meeting.css","css/lib/datetimepicker.css","css/notice.css","css/attendance.css"]},views:{"meetingContent@main":{templateUrl:basePath+"meeting_content.html"}}}).state("main.meeting.reserve",{url:"/reserve",module:"private",views:{"reserve@main.meeting":{templateUrl:basePath+"reserve.html",controller:"Reserve"}}}).state("main.meeting.reserveManage",{url:"/reserveManage",module:"private",views:{"reserve@main.meeting":{templateUrl:basePath+"reserveManage.html",controller:"ReserveManage"}}})}]);
var SurveyMod=angular.module("SurveyMod",[]);SurveyMod.controller("SurveyListCtrl",function($scope,$http,$rootScope,$timeout,$stateParams,$state,surveyModel,$cookieStore,permissionService){if(!permissionService.checkPermission("SurveyList"))return $state.go("main.index",{},{reload:!1}),!1;var survey=$scope.survey={};survey.isMySurveyList=!1,survey.surveyInfoList="";var survey_param=$scope.survey_param={};if(survey_param.page=1,survey.isCloseSurveyWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},survey.isInit=$stateParams.isInit?$stateParams.isInit:1,0==survey.isInit){var MyCreateListCookie=$cookieStore.get("MyCreateList");if("undefined"!=typeof MyCreateListCookie){survey_param.page=MyCreateListCookie.page?MyCreateListCookie.page:1,$scope.page.tempcurPage=survey_param.page;var MyCreateList={};MyCreateList.page=1,$cookieStore.put("MyCreateList",MyCreateList)}}surveyModel.getSurveyList($scope),$scope.page_fun=function(){$scope.survey_param.page=$scope.page.tempcurPage,surveyModel.getSurveyList($scope)},survey.detailGo=function(survey_id){surveyModel.setMyCreateListCookie($scope),$state.go("main.survey.surveylist.surveydetail",{survey_id:survey_id})}});
SurveyMod.controller("SurveyDetailCtrl",function($scope,$http,$rootScope,$timeout,surveyModel,$stateParams,$state,permissionService){if(!permissionService.checkPermission("SurveyList"))return $state.go("main.index",{},{reload:!1}),!1;var survey=$scope.survey={};survey.surveyInfo="";var survey_param=$scope.survey_param={};survey_param.survey_id=$stateParams.survey_id?$stateParams.survey_id:0,0==survey_param.survey_id&&(alert("参数错误"),$state.go("^")),survey_param.reply_content="",surveyModel.getSurveyDetail($scope),survey.replySurveyBtn=function(){1==survey.surveyInfo.status?surveyModel.setReplySurvey($scope):alert("该调研已经结束，无法回复！")},survey.returnGo=function(){$state.go("^",{isInit:0})}});
SurveyMod.controller("MyCreateListCtrl",function($scope,$http,$rootScope,$timeout,surveyModel,$cookieStore,$stateParams,$state){var survey=$scope.survey={};survey.isMySurveyList=!0,survey.surveyInfoList="";var survey_param=$scope.survey_param={};if(survey_param.page=1,survey.isCloseSurveyWin=!1,survey.closeSurveyId="",$scope.page={curPage:1,tempcurPage:1,sumPage:0},survey.isInit=$stateParams.isInit?$stateParams.isInit:1,0==survey.isInit){var MyCreateListCookie=$cookieStore.get("MyCreateList");survey_param.page=MyCreateListCookie.page?MyCreateListCookie.page:1,$scope.page.tempcurPage=survey_param.page;var MyCreateList={};MyCreateList.page=1,$cookieStore.put("MyCreateList",MyCreateList)}surveyModel.getMyCreateList($scope),$scope.page_fun=function(){$scope.survey_param.page=$scope.page.tempcurPage,surveyModel.getMyCreateList($scope)},survey.detailGo=function(survey_id){surveyModel.setMyCreateListCookie($scope),$state.go("main.survey.mycreatelist.mycreatedetail",{survey_id:survey_id})},survey.openSurveyWin=function(event,survey_id){survey.isCloseSurveyWin=!0,survey.closeSurveyId=survey_id,event.stopPropagation()},survey.closeSurveyWin=function(event){survey.isCloseSurveyWin=!1,survey.closeSurveyId="",event.stopPropagation()},survey.closeSurveyBtn=function(){surveyModel.closeSurvey($scope),survey.isCloseSurveyWin=!1}});
SurveyMod.controller("MyCreateDetailCtrl",function($scope,$http,$rootScope,$timeout,surveyModel,$stateParams,$state){var survey=$scope.survey={};survey.surveyInfo="",survey.surveyReplayList="";var survey_param=$scope.survey_param={};survey_param.survey_id=$stateParams.survey_id?$stateParams.survey_id:0,0==survey_param.survey_id&&(alert("参数错误"),$state.go("^")),survey_param.page=1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},surveyModel.getMyCreateDetail($scope),$scope.page_fun=function(){$scope.survey_param.page=$scope.page.tempcurPage,surveyModel.getMyCreateDetail($scope)},survey.returnGo=function(){$state.go("^",{isInit:0})}});
SurveyMod.controller("CreateSurveyCtrl",function($scope,$http,$rootScope,$timeout,surveyModel,Publicfactory){var survey=$scope.survey={},survey_param=$scope.survey_param={};survey_param.title="",survey_param.explain="",survey_param.content="",$scope.config={initialFrameWidth:"100%"},survey.createSurveyBtn=function(){var ue=UE.getEditor("container");return survey_param.content=ue.getContent(),Publicfactory.checkEnCnstrlen(ue.getContentTxt())>1e4?(alert("公告内容不能超过5000字"),!1):void surveyModel.createSurvey($scope)}});
SurveyMod.factory("surveyModel",function($http,$state,$cookieStore,$sce){var service={};return service.createSurvey=function($scope){$http.post("/index.php?r=survey/survey/create-survey",JSON.stringify($scope.survey_param)).success(function(data){1==data.code&&$state.go("main.survey.mycreatelist",{isInit:1}),alert(data.msg)})},service.getMyCreateList=function($scope){$http.post("/index.php?r=survey/survey/my-survey-list",JSON.stringify($scope.survey_param)).success(function(data){1==data.code?($scope.survey.surveyInfoList=data.data.surList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage):alert(data.msg)})},service.getMyCreateDetail=function($scope){$http.post("/index.php?r=survey/survey/my-survey-detail",JSON.stringify($scope.survey_param)).success(function(data){1==data.code?($scope.survey.surveyInfo=data.data.surveyInfo,$scope.survey.surveyInfo.content=$sce.trustAsHtml($scope.survey.surveyInfo.content),$scope.survey.surveyReplayList=data.data.replyInfo.repList,$scope.page.curPage=data.data.replyInfo.page.curPage,$scope.page.sumPage=data.data.replyInfo.page.sumPage):alert(data.msg)})},service.setMyCreateListCookie=function($scope){var MyCreateList={};MyCreateList.page=$scope.survey_param.page,$cookieStore.put("MyCreateList",MyCreateList)},service.closeSurvey=function($scope){$http.post("/index.php?r=survey/survey/close-survey",{survey_id:$scope.survey.closeSurveyId}).success(function(data){1==data.code?(angular.element.each($scope.survey.surveyInfoList,function(key,val){val.survey_id==$scope.survey.closeSurveyId&&($scope.survey.surveyInfoList[key].status=2)}),alert(data.msg),$scope.survey.closeSurveyId=""):alert(data.msg)})},service.getSurveyList=function($scope){$http.post("/index.php?r=survey/survey/survey-list",JSON.stringify($scope.survey_param)).success(function(data){1==data.code?($scope.survey.surveyInfoList=data.data.surList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage):alert(data.msg)})},service.getSurveyDetail=function($scope){$http.post("/index.php?r=survey/survey/survey-detail",JSON.stringify($scope.survey_param)).success(function(data){1==data.code?($scope.survey.surveyInfo=data.data,$scope.survey.surveyInfo.content=$sce.trustAsHtml($scope.survey.surveyInfo.content)):alert(data.msg)})},service.setReplySurvey=function($scope){$http.post("/index.php?r=survey/survey/survey-reply",JSON.stringify($scope.survey_param)).success(function(data){1==data.code?($state.go("^",{isInit:0}),alert(data.msg)):alert(data.msg)})},service});
SurveyMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/survey/view/";$stateProvider.state("main.survey",{url:"/survey",module:"private",data:{css:["css/userResearch.css","css/lib/datetimepicker.css"]},views:{"surveyContent@main":{templateUrl:basePath+"survey_content.html"}}}).state("main.survey.surveylist",{url:"/surveylist/:isInit",module:"private",views:{"survey@main.survey":{templateUrl:basePath+"mycreatelist.html",controller:"SurveyListCtrl"}}}).state("main.survey.surveylist.surveydetail",{url:"/surveydetail/:survey_id",module:"private",views:{"survey@main.survey":{templateUrl:basePath+"surveydetail.html",controller:"SurveyDetailCtrl"}}}).state("main.survey.mycreatelist",{url:"/mycreatelist/:isInit",module:"private",views:{"survey@main.survey":{templateUrl:basePath+"mycreatelist.html",controller:"MyCreateListCtrl"}}}).state("main.survey.mycreatelist.mycreatedetail",{url:"/mycreatedetail/:survey_id",module:"private",views:{"survey@main.survey":{templateUrl:basePath+"mycreatedetail.html",controller:"MyCreateDetailCtrl"}}}).state("main.survey.createsurvey",{url:"/createsurvey",module:"private",views:{"survey@main.survey":{templateUrl:basePath+"createsurvey.html",controller:"CreateSurveyCtrl"}}})}]);
var workStatementMod=angular.module("workStatementMod",[]);workStatementMod.controller("workStatementCtrl",function($scope,$http,$rootScope,workModel,$timeout){var work=$scope.work={},param_work=$scope.param_work={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},work.search_org_id="",work.search_u_id="",work.begin_time="",work.end_time="",work.search_org_name="",work.search_org_name_temp="",work.search_real_name="",work.search_real_name_temp="",work.isOrgWin=!1,work.isMemWin=!1,param_work.search_org_id="",param_work.search_u_id="",param_work.begin_time="",param_work.end_time="",param_work.page=1,work.workList=[],work.orgInfo=[],work.userInfo=[],workModel.getAllAttend($scope),work.searchButton=function(){work.isOrgWin=!1,work.isMemWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},param_work.page=1,""==work.search_org_id&&(work.search_org_name="",work.search_org_name_temp=""),""==work.search_u_id&&(work.search_real_name="",work.search_real_name_temp=""),work.end_time&&work.start_time>=work.end_time&&alert("结束时间必须大于开始时间"),param_work.search_org_id=work.search_org_id,param_work.search_u_id=work.search_u_id,param_work.begin_time=angular.element("#searchstarttime").val(),param_work.end_time=angular.element("#searchendtime").val(),workModel.getAllAttend($scope)},work.getSearchAllOrgInfo=function(){work.search_org_name="",work.search_org_id="",work.isMemWin=!1,workModel.getOrgInfo($scope)},work.searchOrgInfo=function(){work.isMemWin=!1,work.search_org_name!=work.search_org_name_temp&&(workModel.getOrgInfo($scope),work.search_org_name_temp=work.search_org_name)},work.selectOrg=function(obj){work.search_org_id=obj.org_id,work.search_org_name=obj.org_name,work.isOrgWin=!1},work.searchAllUserInfo=function(){work.isOrgWin=!1,work.search_u_id="",work.search_real_name="",workModel.getUserInfo($scope)},work.searchUserInfo=function(){work.isOrgWin=!1,work.search_real_name!=work.search_real_name_temp&&(workModel.getUserInfo($scope),work.search_real_name_temp=work.search_real_name)},work.selectUser=function(obj){work.search_u_id=obj.u_id,work.search_real_name=obj.real_name,work.isMemWin=!1},$scope.page_fun=function(){$scope.param_work.page=$scope.page.tempcurPage,workModel.getAllAttend($scope)}});
workStatementMod.controller("myWorkCtrl",function($scope,$http,$rootScope,workModel,$timeout,permissionService){var work=$scope.work={},param_work=$scope.param_work={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},work.status={status:"",statusstr:"状态"},work.type={status:"",statusstr:"类型"},work.begin_time="",work.end_time="",work.isStatusWin=!1,work.isTypeWin=!1,work.arrSearchStatus=[{status:-1,statusstr:"状态"},{status:0,statusstr:"未提交"},{status:1,statusstr:"待审阅"},{status:2,statusstr:"已审阅"}],work.arrSearchType=[{status:0,statusstr:"类型"},{status:1,statusstr:"日报"},{status:2,statusstr:"周报"}],param_work.status="",param_work.type="",param_work.begin_time="",param_work.end_time="",param_work.page=1,work.workList=[],workModel.getMyWorkList($scope),work.searchButton=function(){return param_work.begin_time=work.begin_time,param_work.end_time=work.end_time,""!=param_work.end_time&&param_work.begin_time>param_work.end_time?(alert("结束时间必须大于或者等于开始时间"),param_work.begin_time="",param_work.end_time="",work.begin_time="",void(work.end_time="")):(work.isStatusWin=!1,work.isTypeWin=!1,$scope.page={curPage:work.workList.page,tempcurPage:work.workList.page,sumPage:work.workList.total_page},param_work.page=1,param_work.status=work.status.status,param_work.type=work.type.status,void workModel.getMyWorkList($scope))},work.selectStatus=function(obj){work.status=obj,work.isStatusWin=!1,$("#workStatementStatus").hide()},work.selectType=function(obj){work.type=obj,work.isTypeWin=!1,$("#workStatementType").hide()},$scope.page_fun=function(){$scope.param_work.page=$scope.page.tempcurPage,workModel.getMyWorkList($scope)},work.workStatementStatusButton=function(){$("#workStatementType").hide(),angular.element("#workStatementStatus").is(":hidden")?angular.element("#workStatementStatus").show():angular.element("#workStatementStatus").hide()},work.workStatementTypeButton=function(){$("#workStatementStatus").hide(),angular.element("#workStatementType").is(":hidden")?angular.element("#workStatementType").show():angular.element("#workStatementType").hide()},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&angular.element(".selectbor  ul").hide()})});
workStatementMod.controller("approveWorkCtrl",function($scope,$http,$rootScope,workModel,$stateParams,$state,permissionService){if(!permissionService.checkPermission("WorkstateApprove"))return $state.go("main.index"),!1;var work=$scope.work={},param_work=$scope.param_work={};work.work_detail={},$scope.page={curPage:1,tempcurPage:1,sumPage:0},work.user={u_id:"",real_name:"提交者"},work.search_real_name_temp="",work.search_real_name="",work.status={status:"",statusstr:"状态"},work.type={status:"",statusstr:"类型"},work.begin_time="",work.end_time="",work.isMemWin=!1,work.isStatusWin=!1,work.isTypeWin=!1,work.showCheckWin=!1,work.arrSearchStatus=[{status:-1,statusstr:"状态"},{status:0,statusstr:"未提交"},{status:1,statusstr:"待审阅"},{status:2,statusstr:"已审阅"}],work.arrSearchType=[{status:0,statusstr:"类型"},{status:1,statusstr:"日报"},{status:2,statusstr:"周报"}],param_work.u_id="",param_work.status="",param_work.type="",param_work.begin_time="",param_work.end_time="",param_work.page=1,work.workList=[],workModel.getApproveList($scope),work.showDetail=function(workId){workModel.getWorkDetail(workId,!1,$scope),work.showCheckWin=!0,$("#masklayer1").show()},$stateParams.work_id&&work.showDetail($stateParams.work_id),work.searchButton=function(){return param_work.begin_time=$("#searchstarttime").val(),param_work.end_time=$("#searchendtime").val(),""!=param_work.end_time&&param_work.begin_time>param_work.end_time?(alert("结束时间必须大于或者等于开始时间"),param_work.begin_time="",param_work.end_time="",$("#searchendtime").val(""),void $("#searchstarttime").val("")):(work.isStatusWin=!1,work.isTypeWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},param_work.page=1,param_work.u_id=work.user.u_id,param_work.status=work.status.status,param_work.type=work.type.status,void workModel.getApproveList($scope))},work.userInfo=work.allMem=[],work.searchAllUserInfo=function(){return work.isOrgWin=!1,work.search_u_id="",work.search_real_name="",work.user={},work.allMem.length>0?(work.isMemWin=!0,void($scope.work.userInfo=work.allMem)):void workModel.getUserInfo($scope)};var timer="";work.searchUserInfo=function(){clearTimeout(timer),timer=setTimeout(function(){workModel.getUserInfo($scope)},500),work.search_real_name_temp=work.search_real_name,work.isMemWin=!0},work.selectUser=function(obj){work.user=obj,work.search_real_name=obj.real_name,work.isMemWin=!1,$("#submitter").hide()},work.selectStatus=function(obj){work.status=obj,work.isStatusWin=!1,$("#workStatus").hide()},work.selectType=function(obj){work.type=obj,work.isTypeWin=!1,$("#workType").hide()},work.approve=function(){workModel.approveWork(work.work_detail.work_id,$scope)},work.back=function(){$("#masklayer1").hide(),work.showCheckWin=!1},void 0!=$stateParams.work_id&&""!=$stateParams.work_id&&work.showDetail($stateParams.work_id),$scope.page_fun=function(){$scope.param_work.page=$scope.page.tempcurPage,workModel.getApproveList($scope)},work.workStatusButton=function(){$("#workType").hide(),angular.element("#workStatus").is(":hidden")?angular.element("#workStatus").show():angular.element("#workStatus").hide()},work.workTypeButton=function(){$("#workStatus").hide(),angular.element("#workType").is(":hidden")?angular.element("#workType").show():angular.element("#workType").hide()},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&angular.element(".selectbor  ul").hide()}),work.workSubmitterButton=function(){angular.element("#submitter").is(":hidden")?angular.element("#submitter").show():angular.element("#submitter").hide()},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".submitterBox ").length&&angular.element(".submitterBox  ul").hide()})});
workStatementMod.controller("workDetailCtrl",function($scope,$http,$rootScope,$state,$stateParams,workModel,$timeout){var work=$scope.work={};!$stateParams.work_id,work.work_detail={},work.work_id=$stateParams.work_id,$("#masklayer1").show(),workModel.getWorkDetail($stateParams.work_id,!1,$scope),work.approve=function(){workModel.approveWork(work.work_id,$state)},work.back=function(){$("#masklayer1").hide(),$state.go("^",{},{reload:!1})}});
workStatementMod.controller("writeWorkCtrl",function($scope,$http,$rootScope,$state,$stateParams,workModel,permissionService,Publicfactory){if(!permissionService.checkPermission("WorkstateMyWorkstateWrite"))return $state.go("main.index"),!1;var work=$scope.work={};if(!$stateParams.work_id)return $state.go("^"),!1;var param_work=$scope.param_work={};work.task_status=[{status:0,statusstr:"请选择完成状态"},{status:1,statusstr:"已完成"},{status:2,statusstr:"未完成"}],work.selected_task_status=[],work.tasks=[],work.work="",work.plan="",work.work_detail={},work.work_id=$stateParams.work_id,workModel.getWorkDetail($stateParams.work_id,!0,$scope),work.addSuccess=!1,work.addWork=function(){return param_work.work_data={work_content:work.work,plan_content:work.plan,status:1},param_work.work_id=work.work_id,null==work.work||0==Publicfactory.checkEnCnstrlen(work.work)?void alert("工作项不能为空"):Publicfactory.checkEnCnstrlen(work.work)>2e3?void alert("工作项不能超过1000个汉字"):null==work.plan||0==Publicfactory.checkEnCnstrlen(work.plan)?void alert("工作计划不能为空"):Publicfactory.checkEnCnstrlen(work.plan)>2e3?void alert("工作计划不能超过1000个汉字"):void workModel.addWork($scope,$state)},work.back=function(){$state.go("main.workStatement.myWorkStatementTable",{},{reload:!1})}});
workStatementMod.controller("editeWorkCtrl",function($scope,$http,$rootScope,$state,$stateParams,workModel,permissionService,Publicfactory){if(!permissionService.checkPermission("WorkstateMyWorkstateEdite"))return $state.go("^"),!1;var work=$scope.work={};!$stateParams.work_id,$("#masklayer1").show();var param_work=$scope.param_work={};work.task_status=[{status:0,statusstr:"请选择完成状态"},{status:1,statusstr:"已完成"},{status:2,statusstr:"未完成"}],work.selected_task_status=[],work.tasks=[],work.work="",work.plan="",work.work_detail={},work.work_id=$stateParams.work_id,workModel.getWorkDetail($stateParams.work_id,!0,$scope),work.editeSuccess=!1,work.updateWork=function(){return param_work.work_data={work_content:work.work,plan_content:work.plan},param_work.work_id=work.work_id,null==work.work||0==Publicfactory.checkEnCnstrlen(work.work)?void alert("工作项不能为空"):Publicfactory.checkEnCnstrlen(work.work)>2e3?void alert("工作项不能超过1000个汉字"):null==work.plan||0==Publicfactory.checkEnCnstrlen(work.plan)?void alert("工作计划不能为空"):Publicfactory.checkEnCnstrlen(work.plan)>2e3?void alert("工作计划不能超过1000个汉字"):void workModel.updateWork($scope,$state)},work.back=function(){$("#masklayer1").hide(),$state.go("main.workStatement.myWorkStatementTable",{},{reload:!1})}});
TaskMod.factory("workModel",function($http,$timeout,$cookieStore,$cookies,$state,filtersModel){var service={};return service.getMyWorkList=function($scope){$http.post("/index.php?r=work/work/my-work",JSON.stringify($scope.param_work)).success(function(data,status){$scope.work.workList=data.data.list,$scope.page.curPage=data.data.page,$scope.page.sumPage=data.data.total_page})},service.getApproveList=function($scope){$http.post("/index.php?r=work/work/work-approvelist",JSON.stringify($scope.param_work)).success(function(data,status){$scope.work.workList=data.data.list,$scope.page.curPage=data.data.page,$scope.page.sumPage=data.data.total_page})},service.getUserInfo=function($scope){$http.post("/index.php?r=work/work/member-list",{search_real_name:$scope.work.search_real_name}).success(function(data,status){$scope.work.search_real_name||($scope.work.allMem=data.data),$scope.work.userInfo=data.data,$scope.work.isMemWin=!0})},service.updateWork=function($scope,$state){$http.post("/index.php?r=work/work/update-work",JSON.stringify($scope.param_work)).success(function(data,status){2e4==data.code?($scope.work.editeSuccess=!0,$state.go("main.workStatement.myWorkStatementTable",{},{reload:!0})):alert(data.msg)})},service.addWork=function($scope,$state){$http.post("/index.php?r=work/work/add-work",JSON.stringify($scope.param_work)).success(function(data,status){if(2e4==data.code){$scope.work.addSuccess=!0;var timeout=setTimeout(function(){$state.go("main.workStatement.myWorkStatementTable",{},{reload:!0})},1e3);timeout&&$timeout.cancel(timeout)}else alert(data.msg)})},service.approveWork=function(workId,$scope){$http.post("/index.php?r=work/work/approve-work",{work_id:workId,commit_time:$scope.work.work_detail.commit_time}).success(function(data,status){2e4==data.code?(alert(data.msg),$scope.work.work_detail.status=2,service.getApproveList($scope)):(alert(data.msg),service.getWorkDetail(workId,!1,$scope))})},service.getWorkDetail=function(workId,isAdd,$scope){$http.post("/index.php?r=work/work/detail",{work_id:workId,is_add:isAdd}).success(function(data,status){$scope.work.work_detail=data.data,0!=data.data.status||isAdd||$state.go("main.workStatement.myWorkStatementTable.write",{work_id:data.data.work_id},{reload:!0}),$scope.work.work=data.data.work_content,$scope.work.plan=data.data.plan_content,$scope.work.work_id=data.data.work_id})},service});
workStatementMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/workStatement/view/";$stateProvider.state("main.workStatement",{url:"/workStatement",module:"private",data:{css:["css/workStatement.css","css/lib/datetimepicker.css"]},views:{"workStatementContent@main":{templateUrl:basePath+"workStatement_content.html"}}}).state("main.workStatement.checkTable",{url:"/checkTable/:work_id",module:"private",views:{"workStatement_checkTable@main.workStatement":{templateUrl:basePath+"workStatement_checkTable.html",controller:"approveWorkCtrl"}}}).state("main.workStatement.checkTable.checked",{url:"/checked/:work_id",module:"private",views:{"workStatement_checked@main.workStatement":{templateUrl:basePath+"workStatement_checked.html",controller:"workDetailCtrl"}}}).state("main.workStatement.myWorkStatementTable",{url:"/myWorkStatementTable",module:"private",views:{"workStatement_myWorkStatementTable@main.workStatement":{templateUrl:basePath+"workStatement_myWorkStatementTable.html",controller:"myWorkCtrl"}}}).state("main.workStatement.myWorkStatementTable.write",{url:"/write/:work_id",module:"private",views:{"workStatement_write@main.workStatement":{templateUrl:basePath+"workStatement_write.html",controller:"writeWorkCtrl"}}}).state("main.workStatement.myWorkStatementTable.edite",{url:"/edit/:work_id",module:"private",views:{"workStatement_edit@main.workStatement":{templateUrl:basePath+"workStatement_edit.html",controller:"editeWorkCtrl"}}}).state("main.workStatement.myWorkStatementTable.TabDetails",{url:"/TabDetails/:work_id",module:"private",views:{"workStatement_TabDetails@main.workStatement":{templateUrl:basePath+"workStatement_TabDetails.html",controller:"workDetailCtrl"}}})}]);
var systemMod=angular.module("systemMod",[]);systemMod.controller("systemCtrl",function($scope,$http,$rootScope,$timeout){});
systemMod.controller("EmployeeListCtrl",function($scope,$http,$rootScope,$timeout,employeeModel,attendanceModel,$cookieStore,$stateParams,$state){var employee=$scope.employee={},employee_param=$scope.employee_param={},attend=$scope.attend={};if(employee.perm_gourp_id="",employee.org_id="",employee.real_name="",employee.memList="",employee.allPerm="",attend.orgInfo="",employee.role_name="角色",employee.org_name="",attend.search_org_name="",attend.search_org_name_temp="",employee.isDelConfirmWin=!1,employee.u_id="",employee.isRoleWin=!1,attend.isOrgWin=!1,employee_param.perm_gourp_id="",employee_param.org_id="",employee_param.real_name="",employee_param.page=1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},employee.isInit=$stateParams.isInit?$stateParams.isInit:1,0==employee.isInit&&"undefined"!=typeof $cookieStore.get("EmployeeList")){var MyCreateListCookie=$cookieStore.get("EmployeeList");employee_param.page=MyCreateListCookie.page?MyCreateListCookie.page:1,$scope.page.tempcurPage=employee_param.page,attend.search_org_name=MyCreateListCookie.search_org_name,attend.search_org_name_temp=attend.search_org_name,employee.org_name=attend.search_org_name,employee_param.org_id=MyCreateListCookie.org_id,employee.org_id=employee_param.org_id,$scope.depart={value:MyCreateListCookie.org_id,label:MyCreateListCookie.search_org_name},employee.real_name=MyCreateListCookie.real_name,employee_param.real_name=MyCreateListCookie.real_name,employee_param.perm_gourp_id=MyCreateListCookie.perm_gourp_id,employee.perm_gourp_id=employee_param.perm_gourp_id,employee.role_name=MyCreateListCookie.role_name,angular.element("#role").html(employee.role_name)}employeeModel.setInitMyCreateListCookie($scope),employeeModel.getAllPerm($scope,!0),employeeModel.getEmployeeList($scope),employee.searchBtn=function(){return employee.real_name.length>20?(alert("员工姓名最长支持20个字"),!1):($scope.page={curPage:1,tempcurPage:1,sumPage:0},employee_param.perm_gourp_id=employee.perm_gourp_id,employee_param.org_id=employee.org_id,employee_param.real_name=employee.real_name,employee_param.page=1,void employeeModel.getEmployeeList($scope))},employee.roleWinButton=function(){angular.element("#roleList").is(":hidden")?angular.element("#roleList").show():angular.element("#roleList").hide()},employee.selectSearchRole=function(perm_gourp_id){employee.perm_gourp_id=perm_gourp_id,angular.element.each(employee.allPerm,function(key,val){val.group_id==perm_gourp_id&&(employee.role_name=val.group_name,angular.element("#role").html(val.group_name))}),employee.isRoleWin=!1,$("#roleList").hide()},attend.getSearchAllOrgInfo=function(){attend.search_org_name="",employee.org_id="",attendanceModel.getOrgInfo($scope,1)},attend.searchOrgInfo=function(){attend.search_org_name!=attend.search_org_name_temp&&(attendanceModel.getOrgInfo($scope,0),attend.search_org_name_temp=attend.search_org_name)},attend.selectOrg=function(obj){employee.org_id=obj.value,attend.search_org_name=obj.label,employee.org_name=obj.label,attend.isOrgWin=!1},employee.openDelEmpWin=function(u_id){employee.u_id=u_id,employee.isDelConfirmWin=!0,$("#masklayer1").show()},employee.closeDelEmpWin=function(){employee.u_id="",employee.isDelConfirmWin=!1,$("#masklayer1").hide()},employee.delEmp=function(){employee.isDelConfirmWin=!1,employeeModel.delEmp($scope),$("#masklayer1").hide()},$scope.page_fun=function(){$scope.employee_param.page=$scope.page.tempcurPage,employeeModel.getEmployeeList($scope)},employee.addEmp=function(){employeeModel.setMyCreateListCookie($scope),$state.go("main.system.employeelist.employeeadd"),$("#masklayer1").show()},employee.editEmp=function(u_id){employeeModel.setMyCreateListCookie($scope),$state.go("main.system.employeelist.employeeedit",{u_id:u_id}),$("#masklayer1").show()},employee.setPerm=function(u_id){employeeModel.setMyCreateListCookie($scope),$state.go("main.system.employeelist.employeepermission",{u_id:u_id,is_create:!1}),$("#masklayer1").show()},angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor ").length&&angular.element(".selectbor  ul").hide()})});
systemMod.controller("EmployeeAddCtrl",function($scope,$http,$rootScope,$timeout,employeeModel,$state,attendanceModel){var employee=$scope.employee={},employee_param=$scope.employee_param={},attend=$scope.attend={};employee.isSetManager=!1,employee.manager_real_name="",employee_param.type="add",employee_param.real_name="",employee_param.email="",employee_param.position="",employee_param.entry_time="",employee_param.is_formal="0",employee_param.org_id="",employee_param.is_manager=0,employee_param.card_no="",employee_param.phone="",employee_param.resumeId="",attend.search_org_name="",attend.search_org_name_temp="",attend.isOrgWin=!1,employee.isSavePer=!1,$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=management/employee/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){return 1!=response.code&&response.msg?(alert(response.msg),!1):(employee_param.resumeId=response.data,void uploader.clearQueue())}},attend.getSearchAllOrgInfo=function(){attend.search_org_name="",employee_param.org_id="",attendanceModel.getOrgInfo($scope,0)},attend.searchOrgInfo=function(){attend.search_org_name!=attend.search_org_name_temp&&(attendanceModel.getOrgInfo($scope,0),attend.search_org_name_temp=attend.search_org_name)},attend.selectOrg=function(obj){employee_param.org_id=obj.value,attend.search_org_name=obj.label,employee_param.is_manager=0,employeeModel.getOrgManagerInfo($scope),attend.isOrgWin=!1},employee.saveBtn=function(status){employee.isSavePer=status,employeeModel.addEmployee($scope)},employee.cancelBtn=function(){employeeModel.setInitMyCreateListCookie($scope),$state.go("^")},employee.fileDownload=function(obj){window.location.href="/index.php?r=management/employee/downfile&filepath="+encodeURI(obj.file_path+obj.save_name)+"&file_name="+obj.file_name}});
systemMod.controller("EmployeeEditCtrl",function($scope,$http,$rootScope,$timeout,employeeModel,$state,attendanceModel,$stateParams){var employee=$scope.employee={},employee_param=$scope.employee_param={},attend=$scope.attend={};employee.isSetManager=!1,employee.manager_real_name="",employee_param.u_id=$stateParams.u_id?$stateParams.u_id:0,0==employee_param.u_id&&(alert("参数错误"),$window.history.back()),employee_param.type="edit",employee_param.real_name="",employee_param.email="",employee_param.position="",employee_param.entry_time="",employee_param.is_formal="",employee_param.org_id="",employee_param.is_manager=0,employee_param.card_no="",employee_param.phone="",employee_param.resumeId="",employee_param.pwd="",attend.search_org_name="",attend.search_org_name_temp="",attend.isOrgWin=!1,employee.isSavePer=!1,employee.pwd="!!!******!!!",employeeModel.getEmpInfo($scope),$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=management/employee/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){return 1!=response.code&&response.msg?(alert(response.msg),!1):(employee_param.resumeId=response.data,void uploader.clearQueue())}},attend.getSearchAllOrgInfo=function(){attend.search_org_name="",employee_param.org_id="",attendanceModel.getOrgInfo($scope,0)},attend.searchOrgInfo=function(){attend.search_org_name!=attend.search_org_name_temp&&(attendanceModel.getOrgInfo($scope,0),attend.search_org_name_temp=attend.search_org_name)},attend.selectOrg=function(obj){employee_param.org_id=obj.value,attend.search_org_name=obj.label,employee_param.is_manager=0,employeeModel.getOrgManagerInfo($scope),attend.isOrgWin=!1},employee.saveBtn=function(status){"!!!******!!!"==employee.pwd?employee_param.pwd="":employee_param.pwd=employee.pwd,employee.isSavePer=status,employeeModel.addEmployee($scope)},employee.cancelBtn=function(){employeeModel.setInitMyCreateListCookie($scope),$state.go("^")},employee.fileDownload=function(obj){window.location.href="/index.php?r=management/employee/downfile&filepath="+encodeURI(obj.file_path+obj.save_name)+"&file_name="+obj.file_name}});
systemMod.controller("EmployeePermissionCtrl",function($scope,$http,$rootScope,$timeout,employeeModel,$state,$stateParams){function getArray(data){for(var i in data)employee.permissionstr.indexOf('"'+data[i].pid+'"')>0?data[i].is_selected=!0:data[i].is_selected=!1,getArray(data[i].children)}var employee=$scope.employee={},employee_param=$scope.employee_param={},roles=$scope.roles={};employee_param.u_id=$stateParams.u_id?$stateParams.u_id:0,employee.is_create=!!$stateParams.is_create&&$stateParams.is_create,0==employee_param.u_id&&(alert("参数错误"),$window.history.back()),employee.allPermission="",employee.memInfo="",employee.allPerm="",employee_param.userPermission="",employee_param.perm_groupid="",employee.permissionstr="",roles.selected=[],employeeModel.getAllPermission($scope),employeeModel.getAllPerm($scope,!1);var getSelected=function(){roles.selected=[],angular.element(".jurisdiction_table_box").find(":checkbox").each(function(){1==$(this).prop("checked")&&roles.selected.push($(this).attr("pid"))})},isSelectedAll=function(checkbox){var c=!1;roles.selected=[],angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").each(function(){1==$(this).prop("checked")&&(c=!0)}),c?angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",!0):angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",!1)};roles.selectAllPerm=function($event){var checkbox=$event.target;checkbox.checked?(angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").prop("checked",!0),angular.element(checkbox).parents(".jurisdiction_table").find(".td_two").find(":checkbox").prop("checked",!0)):(angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").prop("checked",!1),angular.element(checkbox).parents(".jurisdiction_table").find(".td_two").find(":checkbox").prop("checked",!1))},roles.selectAllPerm2=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().parent().find(".td_two").find(":checkbox").prop("checked",!0):angular.element(checkbox).parent().parent().parent().find(".td_two").find(":checkbox").prop("checked",!1),isSelectedAll(checkbox)},roles.updateSelection=function($event,id){var checkbox=$event.target;checkbox.checked&&(angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",checkbox.checked),angular.element(checkbox).parent().parent().parent().find(".td_one").find(":checkbox").prop("checked",checkbox.checked))},employee.selectRole=function(){roles.selected=[],angular.element.each($scope.employee.allPerm,function(key,val){val.group_id==employee.memInfo.perm_groupid&&(roles.selected=$scope.employee.allPerm[key].arrpermission,employee.permissionstr=$scope.employee.allPerm[key].permission)}),getArray(employee.allPermission)},employee.saveBtn=function(){getSelected(),employee_param.userPermission=roles.selected,employee_param.perm_groupid=employee.memInfo.perm_groupid,employeeModel.savePermission($scope)},employee.cancelBtn=function(){$state.go("main.system.employeelist",{isInit:0},{reload:!0})}});
systemMod.controller("skillCtrl",function($scope,$stateParams,$rootScope,skillModel,$http,$cookieStore,$cookies,$state,noticeService,Publicfactory){var skill=$scope.skill={},skill_param=$scope.skill_param={};skill.noticeService=noticeService,skill.addSkillWin=!1,skill.delSkillWin=!1,skill.editeSkillWin=!1,skill.skill_list=[],skill_param.skill_name="",skill_param.skill_id="",skill_param.group_id=0,skillModel.getSkillList($scope),skill.addSkill=function(parentId){skill_param.group_id=parentId,skill_param.skill_name="",skill.addSkillWin=!0,$("#masklayer1").show()},skill.cancelAddSkill=function(){skill_param.skill_id=skill_param.group_id="",$scope.skill_param.skill_name="",skill.addSkillWin=!1,$("#masklayer1").hide()},skill.saveAdd=function(){return"undefined"==typeof $scope.skill_param.skill_name||""==$scope.skill_param.skill_name?void(0==skill_param.group_id?alert("请填写类型名称！"):alert("请填写技能名称！")):Publicfactory.checkEnCnstrlen($scope.skill_param.skill_name)>40?(0==skill_param.group_id?alert("类型名称不能超过20个字！"):alert("技能名称不能超过20个字！"),!1):(skillModel.addSkill($scope,$state),skill.addSkillWin=!1,void $("#masklayer1").hide())},skill.editeSkill=function(skillName,skillId,groupId){skill_param.skill_id=skillId,skill_param.group_id=groupId,skill_param.skill_name=skillName,skill.editeSkillWin=!0,$("#masklayer1").show()},skill.cancelEditeSkill=function(){skill.editeSkillWin=!1,skill_param.skill_id="",skill_param.group_id=0,$("#masklayer1").hide()},skill.saveEdite=function(skill){return"undefined"==typeof skill_param.skill_name||""==skill_param.skill_name?void(0==skill_param.group_id?alert("请填写类型名称！"):alert("请填写技能名称！")):Publicfactory.checkEnCnstrlen(skill_param.skill_name)>40?(0==skill_param.group_id?alert("类型名称不能超过20个字！"):alert("技能名称不能超过20个字！"),!1):(skillModel.editSkill($scope,$state),$("#masklayer1").hide(),void($scope.skill.editeSkillWin=!1))},skill.isDelSkill=function(skillId,groupId){skill_param.skill_id=skillId,skill_param.group_id=groupId,skill.delSkillWin=!0,$("#masklayer1").show()},skill.cancelDelSkill=function(){skill_param.skill_id=skill_param.group_id="",skill.delSkillWin=!1,$("#masklayer1").hide()},skill.delSkill=function(){skill.delSkillWin=!1,skillModel.delSkill($scope,$state),$("#masklayer1").hide()}});
systemMod.controller("scoreCtrl",function($scope,$http,$state,scoreModel,noticeService,Publicfactory){function isInteger(obj){return Math.floor(obj)==obj}var score=$scope.score={},score_param=$scope.score_param={};score.noticeService=noticeService,$scope.page={curPage:1,tempcurPage:1,sumPage:0},score.search_org_name="",score.search_org_name_temp="",score.isOrgWin=!1,score.isLogWin=!1,score.isAdjustWin=!1,score_param.u_id=[],score.orgInfo=[],score.allOrgInfo=[],score_param.points=0,score_param.reason="",score_param.org_id="",score_param.uname="",score_param.page=score.page=1,$scope.score.scoreList=[],scoreModel.getScoreList($scope),score.searchButton=function(){""==score.search_org_name&&(score_param.org_id=""),score_param.page=score.page=1,score_param.org=score_param.org_id,$scope.page={curPage:1,tempcurPage:1,sumPage:score.total_page},scoreModel.getScoreList($scope),angular.element(".personalNano_table").find(":checkbox").prop("checked",!1)},score.getSearchAllOrgInfo=function(){return score.isMemWin=!1,score.search_org_name="",score.search_org_id="",score.allOrg.length>0?(score.isOrgWin=!0,void($scope.score.orgInfo=score.allOrg)):(scoreModel.getOrgInfo($scope),void(score.allOrg=$scope.score.orgInfo))};var timer="";score.searchOrgInfo=function(){clearTimeout(timer),timer=setTimeout(function(){scoreModel.getOrgInfo($scope)},500),score.isOrgWin=!0,score.search_org_name_temp=""},score.selectOrg=function(obj){score_param.org_id=score.search_org_id=obj.value,score.search_org_name=obj.label,score.isOrgWin=!1},score.getAllOrgInfo=function(){return score.isOrgWin=!0,score.search_org_name="",score.allOrgInfo.length>0?void($scope.score.orgInfo=score.allOrgInfo):(scoreModel.getOrgInfo($scope),void($scope.score.allOrgInfo=score.orgInfo))},score.selectAll=function($event){var checkbox=$event.target;checkbox.checked?angular.element(".system_list_status").find(":checkbox").prop("checked",!0):angular.element(".system_list_status").find(":checkbox").prop("checked",!1)},score.getSelected=function(){score_param.u_id=[],angular.element(".system_list_status").find(":checkbox").each(function(){$(this).prop("checked")&&score_param.u_id.push($(this).attr("uid"))})},score.increasePoint=function(){return $scope.score_param.points>=999999?void alert("不能再加了"):void $scope.score_param.points++},score.decreasePoint=function(){return $scope.score_param.points<=-1e3?void alert("不能再减了"):void $scope.score_param.points--},score.adjust=function(){return isInteger($scope.score_param.points)?$scope.score_param.points>999999?void alert("积分不能超过999999"):0==Publicfactory.checkEnCnstrlen($scope.score_param.reason)?(alert("请填写原因"),!1):void scoreModel.addScore($scope,$state):void alert("积分只能为整数")},score.hide=function(){$("#masklayer1").hide(),score.isAdjustWin=!1},score.addSingle=function(uid){score_param.u_id=[],score_param.reason="",score_param.u_id.push(uid),score.isAdjustWin=!0,$("#masklayer1").show()},score.addBatch=function(){return score_param.u_id=[],score.getSelected(),score_param.u_id.length<1?void alert("请选择调整项"):(score_param.reason="",score.isAdjustWin=!0,void $("#masklayer1").show())},score.viewDetail=function(uid){score_param.u_id=uid,scoreModel.viewLog($scope)},$scope.page_fun=function(){angular.element(".personalNano_table").find(":checkbox").prop("checked",!1),$scope.score_param.page=$scope.page.tempcurPage,scoreModel.getScoreList($scope)}}),systemMod.controller("scoreLogCtrl",function($scope,$http,$state,$stateParams,scoreModel,$window){if(!$stateParams.search_id)return $window.history.back(-1),!1;$("#masklayer1").show();var score=$scope.score={};score.logList=[];var score_param={};score_param.search_id=void 0==$stateParams.search_id?"":$stateParams.search_id,score_param.type=void 0==$stateParams.type?1:$stateParams.type,scoreModel.viewLog($scope,score_param),score.back=function(){$window.history.back(),$("#masklayer1").hide()}});
systemMod.controller("scoreCronCtrl",function($scope,$http,$state,$stateParams,scoreModel,$window,noticeService){function isInteger(obj){return Math.floor(obj)==obj}var score=$scope.score={};score.noticeService=noticeService,score.scoreCronlist=[];var score_param=$scope.score_param={},score_param2=$scope.score_param2={};score.cycle=[{label:"年",nums:1},{label:"半年",nums:2},{label:"季度",nums:3},{label:"月",nums:4},{label:"日",nums:5}],score.selectedCycle1=score.cycle[0],score.selectedCycle2=score.cycle[0],score_param.params="",score_param2.params="",scoreModel.viewSet($scope),score.saveEdite=function(){var score_max_limit=99999999;return!isInteger($scope.score.scoreCronlist[0].params)||!isInteger($scope.score.scoreCronlist[1].params)||$scope.score.scoreCronlist[0].params<0||$scope.score.scoreCronlist[1].params<0?void alert("调整数量必须为正整数"):$scope.score.scoreCronlist[0].params>score_max_limit||$scope.score.scoreCronlist[1].params>score_max_limit?void alert("调整数量不能大于"+score_max_limit):($scope.score.scoreCronlist[0].run_cycle=$scope.score.selectedCycle1.nums,$scope.score.scoreCronlist[1].run_cycle=$scope.score.selectedCycle2.nums,void scoreModel.saveEditeSet($scope,$scope.score.scoreCronlist))}});
systemMod.controller("groupScoreCtrl",function($scope,$http,$state,scoreModel,noticeService,Publicfactory){function isInteger(obj){return Math.floor(obj)==obj}var score=$scope.score={},score_param=$scope.score_param={};score.noticeService=noticeService,$scope.page={curPage:1,tempcurPage:1,sumPage:0},score.search_org_name="",score.search_org_name_temp="",score.isOrgWin=!1,score.isLogWin=!1,score.isAdjustWin=!1,score.isErrorWin=!1,score.error_info={},score_param.org_ids=[],score.orgInfo=[],score.allOrgInfo=[],score_param.org_name="",score_param.points=0,score_param.reason="",score_param.org_id="",score_param.page=score.page=1,$scope.score.scoreList=[],scoreModel.getGroupScoreList($scope),score.searchButton=function(){score_param.org_name=score.search_org_name,score_param.page=1,$scope.page={curPage:1,tempcurPage:1,sumPage:score.total_page},scoreModel.getGroupScoreList($scope),angular.element(".personalNano_table").find(":checkbox").prop("checked",!1)},score.getSearchAllOrgInfo=function(){score.isMemWin=!1,score.search_org_name="",score.search_org_id="",scoreModel.getOrgInfo($scope),score.allOrg=$scope.score.orgInfo};var timer="";score.searchOrgInfo=function(){clearTimeout(timer),timer=setTimeout(function(){scoreModel.getOrgInfo($scope)},500),score.isOrgWin=!0,score.search_org_name_temp=""},score.selectOrg=function(obj){score_param.org_id=score.search_org_id=obj.value,score.search_org_name=obj.label,$scope.score.isOrgWin=!1},score.getAllOrgInfo=function(){return score.isOrgWin=!0,score.search_org_name="",console.log(score.allOrgInfo.length),score.allOrgInfo.length>0?void($scope.score.orgInfo=score.allOrgInfo):(scoreModel.getOrgInfo($scope),void($scope.score.allOrgInfo=score.orgInfo))},score.selectAll=function($event){var checkbox=$event.target;checkbox.checked?angular.element(".system_list_status").find(":checkbox").prop("checked",!0):angular.element(".system_list_status").find(":checkbox").prop("checked",!1)},score.getSelected=function(){score_param.org_ids=[],angular.element(".system_list_status").find(":checkbox").each(function(){$(this).prop("checked")&&score_param.org_ids.push($(this).attr("org_id"))})},score.increasePoint=function(){return $scope.score_param.points>=999999?void alert("不能再加了"):void $scope.score_param.points++},score.decreasePoint=function(){return $scope.score_param.points<=-1e3?void alert("不能再减了"):void $scope.score_param.points--},score.adjust=function(){return isInteger($scope.score_param.points)?$scope.score_param.points>999999?void alert("积分不能超过999999"):void scoreModel.addGroupScore($scope,$state):void alert("积分只能为整数")},score.addSingle=function(orgId){score_param.org_ids=[],score_param.org_ids.push(orgId),score_param.points=0,score_param.reason="",score.isAdjustWin=!0,$("#masklayer1").show()},score.hide=function(){score.isAdjustWin=!1,$("#masklayer1").hide()},score.addBatch=function(){return score_param.org_ids=[],score.getSelected(),score_param.org_ids.length<1?void alert("请选择调整项"):(score_param.points=0,score_param.reason="",score.isAdjustWin=!0,void $("#masklayer1").show())},score.viewDetail=function(uid){score_param.u_id=uid,scoreModel.viewLog($scope)},score.closeError=function(){score.isErrorWin=!1,score.error_info={},$("#masklayer1").hide()},$scope.page_fun=function(){angular.element(".personalNano_table").find(":checkbox").prop("checked",!1),$scope.score_param.page=$scope.page.tempcurPage,scoreModel.getGroupScoreList($scope)}});
systemMod.controller("rolesCtrl",function($scope,$stateParams,$rootScope,$http,$cookieStore,$cookies,$state,rolesModel){var roles=$scope.roles={},roles_param=$scope.roles_param={};roles_param.page=1,roles.rolesList=[],roles.isDeleWin=!1,$scope.page={curPage:1,tempcurPage:1,sumPage:0},rolesModel.getAllRoles($scope),roles.del=function(gitem){roles_param.gid=gitem.group_id,roles_param.group_name=gitem.group_name,roles.isDeleWin=!0,$("#masklayer1").show()},roles.hide=function(){roles.isDeleWin=!1,$("#masklayer1").hide()},roles.delRole=function(){$http.post("/index.php?r=permission/permissiongroup/del",{group_id:roles_param.gid}).success(function(data,status){2e4==data.code?(roles.isDeleWin=!1,$("#masklayer1").hide(),rolesModel.getAllRoles($scope)):alert(data.msg)})},$scope.page_fun=function(){$scope.roles_param.page=$scope.page.tempcurPage,rolesModel.getAllRoles($scope)}});
systemMod.controller("rolesAddCtrl",function($scope,$stateParams,$rootScope,$http,$cookieStore,$cookies,$state,rolesModel,permissionModel){var roles=$scope.roles={},roles_param=$scope.roles_param={},permission=$scope.permission={};permission.permissionList=[],roles.selected=[],roles_param.group_name="",$("#masklayer1").show(),permissionModel.getAllPermission($scope),roles.addRoles=function(){getSelected(),roles_param.permission=roles.selected,rolesModel.addRoles($scope,$state)};var getSelected=function(){roles.selected=[],angular.element(".jurisdiction_table_box").find(":checkbox").each(function(){1==$(this).prop("checked")&&roles.selected.push($(this).attr("pid"))})},isSelectedAll=function(checkbox){var c=!1;roles.selected=[],angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").each(function(){1==$(this).prop("checked")&&(c=!0)}),c?angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",!0):angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",!1)};roles.selectAllPerm=function($event){var checkbox=$event.target;checkbox.checked?(angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").prop("checked",!0),angular.element(checkbox).parents(".jurisdiction_table").find(".td_two").find(":checkbox").prop("checked",!0)):(angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").prop("checked",!1),angular.element(checkbox).parents(".jurisdiction_table").find(".td_two").find(":checkbox").prop("checked",!1))},roles.selectAllPerm2=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().parent().find(".td_two").find(":checkbox").prop("checked",!0):angular.element(checkbox).parent().parent().parent().find(".td_two").find(":checkbox").prop("checked",!1),isSelectedAll(checkbox)},roles.updateSelection=function($event,id){var checkbox=$event.target;checkbox.checked&&(angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",checkbox.checked),angular.element(checkbox).parent().parent().parent().find(".td_one").find(":checkbox").prop("checked",checkbox.checked))}});
systemMod.controller("rolesEditeCtrl",function($scope,$stateParams,$rootScope,$http,$cookieStore,$cookies,$state,rolesModel){var roles_param=$scope.roles_param={},roles=$scope.roles={},permission=$scope.permission={};permission.permissionList=[],roles.selected=[],roles_param.group_name="",roles_param.group_id=$stateParams.group_id,$("#masklayer1").show(),rolesModel.getAllPermission($scope),roles.editeRoles=function(){getSelected(),roles_param.permission=roles.selected,rolesModel.editeRoles($scope,$state)};var getSelected=function(){roles.selected=[],angular.element(".jurisdiction_table_box").find(":checkbox").each(function(){1==$(this).prop("checked")&&roles.selected.push($(this).attr("pid"))})},isSelectedAll=function(checkbox){var c=!1;roles.selected=[],angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").each(function(){1==$(this).prop("checked")&&(c=!0)}),c?angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",!0):angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",!1)};roles.selectAllPerm=function($event){var checkbox=$event.target;checkbox.checked?(angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").prop("checked",!0),angular.element(checkbox).parents(".jurisdiction_table").find(".td_two").find(":checkbox").prop("checked",!0)):(angular.element(checkbox).parents(".jurisdiction_table").find(".td_one").find(":checkbox").prop("checked",!1),angular.element(checkbox).parents(".jurisdiction_table").find(".td_two").find(":checkbox").prop("checked",!1))},roles.selectAllPerm2=function($event){var checkbox=$event.target;checkbox.checked?angular.element(checkbox).parent().parent().parent().find(".td_two").find(":checkbox").prop("checked",!0):angular.element(checkbox).parent().parent().parent().find(".td_two").find(":checkbox").prop("checked",!1),isSelectedAll(checkbox)},roles.updateSelection=function($event){var checkbox=$event.target;checkbox.checked&&(angular.element(checkbox).parents(".jurisdiction_table").find(".th_one").find(":checkbox").prop("checked",checkbox.checked),angular.element(checkbox).parent().parent().parent().find(".td_one").find(":checkbox").prop("checked",checkbox.checked))}});
systemMod.controller("skillLevelLevelCtrl",function($scope,$stateParams,$rootScope,skillModel,$http,$cookieStore,$cookies,$state,noticeService,Publicfactory){function isInteger(obj){return Math.floor(obj)==obj}var skillLevel=$scope.skillLevel={},skillLevel_param=$scope.skillLevel_param={},skillLevel_param_add=$scope.skillLevel_param_add={};skillLevel.noticeService=noticeService,skillLevel.delskillLevelWin=!1,skillLevel.addWin=!1,skillLevel.editeskillLevelWin=[],skillLevel.skillLevel_list=[],skillLevel_param_add.level=skillLevel_param.level="",skillLevel_param_add.title=skillLevel_param.title="",skillLevel_param_add.skill_level_id=skillLevel_param.skill_level_id="",skillLevel_param_add.point=skillLevel_param.point="",skillModel.getSkillLevelList($scope),skillLevel.addskillLevel=function(){void 0!=$scope.skillLevel.skillLevel_list.length&&$scope.skillLevel.skillLevel_list.length>0?$scope.skillLevel_param_add.level=$scope.skillLevel.skillLevel_list.length+1:$scope.skillLevel_param_add.level=1,$scope.skillLevel_param_add.title="",$scope.skillLevel_param_add.point="",$scope.skillLevel.addWin=!0},skillLevel.cancelAddskillLevel=function(){skillLevel_param={},skillLevel.addskillLevelWin=!1},skillLevel.saveAdd=function(){return $scope.skillLevel_param_add.point.length<=0?void alert("技能分数不能为空"):isInteger($scope.skillLevel_param_add.point)?(console.log($scope.skillLevel_param_add.point),"undefined"==typeof $scope.skillLevel_param_add.title||""==$scope.skillLevel_param_add.title?void alert("请填写头衔！"):Publicfactory.checkEnCnstrlen($scope.skillLevel_param_add.title>16)?(alert("头衔不能超过8个字"),!1):void skillModel.addSkillLevel($scope,$state)):void alert("积分只能为非负整数")},skillLevel.editeSkillLevel=function(skillLevel,index){skillLevel_param.skill_level_id=skillLevel.skill_level_id,skillLevel_param.title=skillLevel.title,skillLevel_param.point=skillLevel.point,angular.forEach($scope.skillLevel.editeskillLevelWin,function(one,key){$scope.skillLevel.editeskillLevelWin[key]=!1}),$scope.skillLevel.editeskillLevelWin[index]=!0},skillLevel.cancelEditeskillLevel=function(index){skillLevel_param={},$scope.skillLevel.editeskillLevelWin[index]=!1},skillLevel.saveEdite=function(skillLevel){return $scope.skillLevel_param.point.length<=0?void alert("技能分数不能为空"):isInteger($scope.skillLevel_param.point)?"undefined"==typeof skillLevel_param.title||""==skillLevel_param.title?void alert("请填写头衔！"):Publicfactory.checkEnCnstrlen(skillLevel_param.title)>16?(alert("头衔不能超过8个字"),!1):void skillModel.editSkillLevel($scope,$state):void alert("积分只能为非负整数")},skillLevel.isDelskillLevel=function(skillLevelId){skillLevel_param.skill_level_id=skillLevelId,$scope.skillLevel.delskillLevelWin=!0,$("#masklayer1").show()},skillLevel.cancelDelskillLevel=function(){skillLevel_param.skillLevel_id=skillLevel_param.group_id="",skillLevel.delskillLevelWin=!1,$("#masklayer1").hide()},skillLevel.delskillLevel=function(){skillLevel.delskillLevelWin=!1,skillModel.delSkillLevel($scope,$state),$("#masklayer1").hide()},skillLevel.hide=function(){skillLevel.delskillLevelWin=!1,$("#masklayer1").hide()}});
systemMod.controller("actionCtrl",function($scope,$stateParams,$rootScope,$http,$cookieStore,$cookies,$state,permissionModel){var ctrlAction=$scope.ctrlAction={},permission_param=$scope.permission_param={};ctrlAction.action_list=[];$scope.permitem={},$scope.gname={};permission_param.page=1,permission_param.size=15,$scope.page={curPage:1,tempcurPage:1,sumPage:0},ctrlAction.closeWindows=!1,ctrlAction.closeWindow=function(){ctrlAction.closeWindows=!1},permissionModel.getAllCtrlList($scope),ctrlAction.edit=function(perm){ctrlAction.closeWindows=!0,$scope.permitem=perm;var index=0;for(var o in ctrlAction.gname)perm.parent_id==ctrlAction.gname[o].pid&&(index=o);$scope.ctrlAction.selectgroup=ctrlAction.gname[index]},ctrlAction.editsave=function(perm){if("undefined"==typeof perm)return void $rootScope.$broadcast("error","操作错误，请联系管理员");if(perm.is_contoller_k<0){if("undefined"==typeof ctrlAction.selectgroup)return ctrlAction.closeWindows="closeWindows",!1;perm.parent_id=ctrlAction.selectgroup.pid}else perm.parent_id=0;var URL="",DATA="";if(ctrlAction.closeWindows="closeWindows","undefined"!=typeof perm.pid&&perm.pid>0)URL="/index.php?r=permission/ajax-update",DATA="parent_id="+perm.parent_id+"&pid="+perm.pid+"&p_name="+perm.p_name+"&p_router="+perm.p_router;else{URL="/index.php?r=permission/ajax-add";var pid_other=perm.controller+perm.action+"#"+perm.is_contoller_k+"#"+perm.is_ajax_k;DATA="parent_id="+perm.parent_id+"&pid_other="+pid_other+"&p_name="+perm.p_name+"&p_router="+perm.p_router}$scope.$broadcast("loadOpt","block"),$http({method:"POST",url:URL,data:DATA,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(data,status,headers,config){$scope.$broadcast("loadOpt","none"),data.code&&permissionModel.getAllCtrlList($scope,1),$rootScope.$broadcast("error",data.msg)})},ctrlAction.delsave=function(perm){confirm("你确定要删除【"+perm.p_name+"】？")&&($scope.$broadcast("loadOpt","block"),$http({method:"POST",url:"/index.php?r=permission/ajax-del",data:"pid="+perm.pid,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(data,status,headers,config){$scope.$broadcast("loadOpt","none"),data.code&&permissionModel.getAllCtrlList($scope,1),$rootScope.$broadcast("error",data.msg)}))},$scope.page_fun=function(){$scope.permission_param.page=$scope.page.tempcurPage,permissionModel.getAllCtrlList($scope)}});
systemMod.factory("permissionModel",function($http){var service={};return service.getAllPermission=function($scope){$http.post("/index.php?r=permission/permission/permissionlist",JSON.stringify($scope.permission_param)).success(function(data,status){2e4==data.code&&($scope.permission.permissionList=data.data)})},service});
TaskMod.factory("skillModel",function($http,$timeout,$cookieStore,$cookies,$state,filtersModel){var service={};return service.getSkillList=function($scope){$http.get("/index.php?r=management/skill/skilllist").success(function(data,status){$scope.skill.skill_list=data.data})},service.addSkill=function($scope,$state){$http.post("/index.php?r=management/skill/addskill",JSON.stringify($scope.skill_param)).success(function(data,status){2e4==data.code?service.getSkillList($scope):alert(data.msg)})},service.editSkill=function($scope,$state){$http.post("/index.php?r=management/skill/editskill",JSON.stringify($scope.skill_param)).success(function(data,status){2e4==data.code?service.getSkillList($scope):alert(data.msg)})},service.delSkill=function($scope,$state){$http.post("/index.php?r=management/skill/delskill",JSON.stringify($scope.skill_param)).success(function(data,status){2e4==data.code?service.getSkillList($scope):alert(data.msg)})},service.getSkillLevelList=function($scope){$http.get("/index.php?r=management/skill/skill-level").success(function(data,status){$scope.skillLevel.skillLevel_list=data.data,angular.forEach(data.data,function(item,index){$scope.skillLevel.editeskillLevelWin[index]=!1})})},service.addSkillLevel=function($scope,$state){$http.post("/index.php?r=management/skill/add-skilllevel",JSON.stringify($scope.skillLevel_param_add)).success(function(data,status){"20000"==data.code?(service.getSkillLevelList($scope),$scope.skillLevel.addWin=!1):alert(data.msg)})},service.editSkillLevel=function($scope,$state){$http.post("/index.php?r=management/skill/edite-skilllevel",JSON.stringify($scope.skillLevel_param)).success(function(data,status){2e4==data.code?service.getSkillLevelList($scope):alert(data.msg)})},service.delSkillLevel=function($scope,$state){$http.post("/index.php?r=management/skill/del-skilllevel",JSON.stringify($scope.skillLevel_param)).success(function(data,status){2e4==data.code?service.getSkillLevelList($scope):alert(data.msg)})},service});
systemMod.factory("scoreModel",function($http,$state){var scoreService={};return scoreService.getOrgInfo=function($scope){$http.post("/index.php?r=attendance/attendance/org-info",{search_org_name:$scope.score.search_org_name}).success(function(data,status){$scope.score.orgInfo=data.data})},scoreService.getScoreList=function($scope){$http.post("/index.php?r=management/score/scorelist",JSON.stringify($scope.score_param)).success(function(data,status){$scope.score.scoreList=data.data.list,$scope.page.curPage=data.data.page,$scope.page.sumPage=data.data.total_page})},scoreService.addScore=function($scope,$state){$http.post("/index.php?r=management/score/add-point",JSON.stringify($scope.score_param)).success(function(data,status){2e4==data.code?($scope.score.isAdjustWin=!1,scoreService.getScoreList($scope),$scope.score_param.u_id=[],$scope.score_param.points=0,$scope.score_param.reason="",angular.element(".personalNano_table").find(":checkbox").prop("checked",!1),$("#masklayer1").hide()):alert(data.msg)})},scoreService.viewLog=function($scope,score_param){$http.post("/index.php?r=management/score/log-list",JSON.stringify(score_param)).success(function(data,status){2e4==data.code?$scope.score.logList=data.data:alert(data.msg)})},scoreService.getGroupScoreList=function($scope){$http.post("/index.php?r=management/score/group-scorelist",JSON.stringify($scope.score_param)).success(function(data,status){$scope.score.scoreList=data.data.list,$scope.page.curPage=data.data.page,$scope.page.sumPage=data.data.total_page})},scoreService.addGroupScore=function($scope,$state){$http.post("/index.php?r=management/score/add-grouppoint",JSON.stringify($scope.score_param)).success(function(data,status){2e4==data.code?(scoreService.getOrgInfo($scope),$scope.score.isAdjustWin=!1,scoreService.getGroupScoreList($scope),$scope.score_param.org_ids=[],$scope.score_param.points=0,$scope.score_param.reason="",angular.element(".personalNano_table").find(":checkbox").prop("checked",!1),$("#masklayer1").hide()):20002==data.code?alert(data.msg):20006==data.code?($scope.score.isAdjustWin=!1,scoreService.getGroupScoreList($scope),$scope.score_param.org_ids=[],$scope.score_param.points=0,$scope.score_param.reason="",angular.element(".personalNano_table").find(":checkbox").prop("checked",!1),$scope.score.isErrorWin=!0,$scope.score.error_info.list=data.error_list,$scope.score.error_info.success=data.success,$scope.score.error_info.failed=data.failed):alert(data.msg)})},scoreService.viewSet=function($scope){$http.get("/index.php?r=management/score/viewset").success(function(data,status){2e4==data.code?($scope.score.scoreCronlist=data.data,angular.forEach($scope.score.cycle,function(cycle,index){cycle.nums==$scope.score.scoreCronlist[0].run_cycle&&($scope.score.selectedCycle1=$scope.score.cycle[index]),cycle.nums==$scope.score.scoreCronlist[1].run_cycle&&($scope.score.selectedCycle2=$scope.score.cycle[index])})):alert(data.msg)})},scoreService.saveEditeSet=function($scope,param){$http.post("/index.php?r=management/score/set-scorecron",JSON.stringify(param)).success(function(data,status){2e4==data.code?alert(data.msg):alert(data.msg)})},scoreService});
systemMod.factory("rolesModel",function($http){var service={};return service.getAllRoles=function($scope){$http.post("/index.php?r=permission/permissiongroup/group-list",JSON.stringify($scope.roles_param)).success(function(data,status){2e4==data.code?($scope.roles.rolesList=data.data.permission_group,$scope.page.curPage=data.data.page,$scope.page.sumPage=data.data.totalPage):alert(data.msg)})},service.addRoles=function($scope,$state){$http.post("/index.php?r=permission/permissiongroup/add",JSON.stringify($scope.roles_param)).success(function(data,status){2e4==data.code?$state.go("main.system.roleList",{},{reload:!0}):alert(data.msg)})},service.editeRoles=function($scope,$state){$http.post("/index.php?r=permission/permissiongroup/edite",JSON.stringify($scope.roles_param)).success(function(data,status){2e4==data.code?$state.go("main.system.roleList",{},{reload:!0}):alert(data.msg)})},service.getAllPermission=function($scope){$http.post("/index.php?r=permission/permissiongroup/permissionlist",JSON.stringify($scope.roles_param)).success(function(data,status){2e4==data.code&&($scope.permission.permissionList=data.data.permission,$scope.roles_param.group_name=data.data.group_name)})},service});
systemMod.factory("employeeModel",function($http,$timeout,$cookieStore,$cookies,$state,filtersModel){var service={};return service.getEmployeeList=function($scope){$http.post("/index.php?r=management/employee/list",JSON.stringify($scope.employee_param)).success(function(data){1==data.code&&($scope.employee.memList=data.data.memList,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage)})},service.getAllPerm=function($scope,type){$http.post("/index.php?r=management/employee/allperm",{}).success(function(data){if(1==data.code)if($scope.employee.allPerm=data.data,type){var temp=[];temp.group_id=0,temp.group_name="角色",$scope.employee.allPerm.unshift(temp)}else $scope.employee.allPerm.push({group_id:0,group_name:"无",permission:"[]"}),angular.element.each($scope.employee.allPerm,function(key,val){$scope.employee.allPerm[key].arrpermission=eval("("+val.permission+")")})})},service.addEmployee=function($scope){$http.post("/index.php?r=management/employee/save-emp-info",JSON.stringify($scope.employee_param)).success(function(data){1==data.code?$scope.employee.isSavePer?"edit"==$scope.employee_param.type?$state.go("main.system.employeelist.employeepermission",{u_id:data.data.u_id,is_create:!1}):$state.go("main.system.employeelist.employeepermission",{u_id:data.data.u_id,is_create:!0}):($state.go("main.system.employeelist",{isInit:0},{reload:!0}),alert(data.msg)):alert(data.msg)})},service.getEmpInfo=function($scope){$http.post("/index.php?r=management/employee/emp-info",{u_id:$scope.employee_param.u_id}).success(function(data){1==data.code?($scope.employee_param.real_name=data.data.real_name,$scope.employee_param.email=data.data.email,$scope.employee_param.position=data.data.position,$scope.employee_param.entry_time=data.data.entry_time,$scope.employee_param.is_formal=data.data.is_formal,$scope.employee_param.org_id=data.data.org_id,$scope.employee_param.is_manager=data.data.is_manager,$scope.employee_param.card_no=data.data.card_no,$scope.employee_param.phone=data.data.phone,$scope.employee_param.resumeId=data.data.resumeId,$scope.attend.search_org_name=data.data.org_name,$scope.attend.search_org_name_temp=data.data.org_name,$scope.employee.pwd="!!!******!!!",$scope.depart={value:data.data.org_id,label:data.data.org_name},console.log($scope.depart),service.getOrgManagerInfo($scope)):alert(data.msg)})},service.getAllPermission=function($scope){$http.post("/index.php?r=management/employee/all-permission",{u_id:$scope.employee_param.u_id,is_create:$scope.employee.is_create}).success(function(data){1==data.code?($scope.employee.allPermission=data.data.permissionList,$scope.employee.memInfo=data.data.memInfo):alert(data.msg)})},service.delEmp=function($scope){$http.post("/index.php?r=management/employee/del-emp",{u_id:$scope.employee.u_id}).success(function(data){1==data.code?($scope.employee.u_id="",service.getEmployeeList($scope),alert(data.msg)):($state.go("main.system.employeelist",{isInit:0},{reload:!0}),alert(data.msg))})},service.savePermission=function($scope){$http.post("/index.php?r=management/employee/save-user-perm",JSON.stringify($scope.employee_param)).success(function(data){1==data.code?($state.go("main.system.employeelist",{isInit:0},{reload:!0}),alert(data.msg)):alert(data.msg)})},service.setMyCreateListCookie=function($scope){var MyCreateList={};MyCreateList.page=$scope.employee_param.page,MyCreateList.search_org_name=$scope.employee.org_name,MyCreateList.org_id=$scope.employee_param.org_id,MyCreateList.real_name=$scope.employee_param.real_name,MyCreateList.perm_gourp_id=$scope.employee_param.perm_gourp_id,MyCreateList.role_name=$scope.employee.role_name,$cookieStore.put("EmployeeList",MyCreateList)},service.setInitMyCreateListCookie=function($scope){var MyCreateList={};MyCreateList.page=1,MyCreateList.search_org_name="",MyCreateList.org_id="",MyCreateList.real_name="",MyCreateList.perm_gourp_id="",MyCreateList.role_name="角色",$cookieStore.put("EmployeeList",MyCreateList)},service.getOrgManagerInfo=function($scope){$http.post("/index.php?r=management/employee/org-manager-info",{org_id:$scope.employee_param.org_id}).success(function(data){1==data.code?($scope.employee.isSetManager=!0,$scope.employee.manager_real_name=data.managerInfo.real_name):($scope.employee.isSetManager=!1,$scope.employee.manager_real_name="")})},service});
systemMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/system/view/";$stateProvider.state("main.system",{url:"/system",module:"private",data:{css:["css/system.css","css/lib/datetimepicker.css"]},views:{"systemContent@main":{templateUrl:basePath+"system_content.html"}}}).state("main.system.employeelist",{url:"/employeelist/:isInit",module:"private",views:{"jurisdictionList@main.system":{templateUrl:basePath+"employeelist.html",controller:"EmployeeListCtrl"}}}).state("main.system.employeelist.employeeadd",{url:"/employeeadd",module:"private",views:{"add_staff@main.system":{templateUrl:basePath+"employeeadd.html",controller:"EmployeeAddCtrl"}}}).state("main.system.employeelist.employeeedit",{url:"/employeeedit/:u_id",module:"private",views:{"add_staff@main.system":{templateUrl:basePath+"employeeedit.html",controller:"EmployeeEditCtrl"}}}).state("main.system.employeelist.employeepermission",{url:"/employeepermission/:u_id/:is_create",module:"private",views:{"add_staff@main.system":{templateUrl:basePath+"employeepermission.html",controller:"EmployeePermissionCtrl"}}}).state("main.system.controllerList",{url:"/controllerList",module:"private",views:{"controllerList@main.system":{templateUrl:basePath+"controllerList.html",controller:"actionCtrl"}}}).state("main.system.roleList",{url:"/roleList",module:"private",views:{"roleList@main.system":{templateUrl:basePath+"roleList.html",controller:"rolesCtrl"}}}).state("main.system.roleList.add_role",{url:"/add_role",module:"private",views:{"add_role@main.system":{templateUrl:basePath+"add_role.html",controller:"rolesAddCtrl"}}}).state("main.system.roleList.edit_role",{url:"/edit_role/:group_id",module:"private",views:{"edit_role@main.system":{templateUrl:basePath+"edit_role.html",controller:"rolesEditeCtrl"}}}).state("main.system.skillList",{url:"/skillList",module:"private",views:{"skillList@main.system":{templateUrl:basePath+"skillList.html",controller:"skillCtrl"}}}).state("main.system.gradeSettingList",{url:"/gradeSettingList",module:"private",views:{"gradeSettingList@main.system":{templateUrl:basePath+"gradeSettingList.html",controller:"skillLevelLevelCtrl"}}}).state("main.system.personalNanoCoinList",{url:"/personalNanoCoinList",module:"private",views:{"personalNanoCoinList@main.system":{templateUrl:basePath+"personalNanoCoinList.html",controller:"scoreCtrl"}}}).state("main.system.personalNanoCoinList.examine_nano_details",{url:"/examine_nano_details/:search_id/:type",module:"private",views:{"examine_nano_details@main.system":{templateUrl:basePath+"examine_nano_details.html",controller:"scoreLogCtrl"}}}).state("main.system.departmentNanoCoinList",{url:"/departmentNanoCoinList",module:"private",views:{"departmentNanoCoinList@main.system":{templateUrl:basePath+"departmentNanoCoinList.html",controller:"groupScoreCtrl"}}}).state("main.system.departmentNanoCoinList.examine_nano_details",{url:"/examine_nano_details/:search_id/:type",module:"private",views:{"examine_nano_details@main.system":{templateUrl:basePath+"examine_nano_details.html",controller:"scoreLogCtrl"}}}).state("main.system.personalNanoCoinSet",{url:"/personalNanoCoinSet",module:"private",views:{"personalNanoCoinSet@main.system":{templateUrl:basePath+"personalNanoCoinSet.html",controller:"scoreCronCtrl"}}}).state("main.system.workdaySet",{url:"/workdaySet",module:"private",views:{"workdaySet@main.system":{templateUrl:basePath+"workdaySet.html"}}})}]);
var ApplyMod=angular.module("ApplyMod",["commonMod"]);ApplyMod.controller("applyCtrl",function($scope,$http,$rootScope,Publicfactory,applyModel,$timeout){var apply=$scope.apply={};apply.addfilesbtn=function(){angular.element(".modbor").css({visibility:"visible"}),angular.element(".modbor .applyindexeditbor").addClass("md-show")},apply.formshowdata={title:"53454354354354",html:'\n     <div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView1" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项4</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项15</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项14</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项13</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项12</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项18</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项17</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项16</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项11</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项10</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项9</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项8</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项7</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项6</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项20</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项19666666</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项23</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项25</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项24</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项22</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项21</span></label></li></ul><div class="field-description">56765765</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框</label><span class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项33</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项26465465</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项32</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项31</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项30</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项29</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项28</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项27</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项3</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Text"><label class="widget-title porela break inblock title">文本输入框5464</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">54654654</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框4565</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项134535</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView19" disabled="" type="checkbox"><span>选项25345435</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView19" disabled="" type="checkbox"><span>选项5445</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView19" disabled="" type="checkbox"><span>选项53345345</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项5243</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项3</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项56534</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项5554</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项57</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落456546546546454</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela flex" data-widget="FileComponent"><label class="widget-title porela break inblock title">附件54</label><span style="display: inline;" class="widget-required">*</span> <ul><li class="porela"></li></ul>   <div class="btn blue fr poabso">添加附件</div>   <div class="field-description">456456546</div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框54646</label><span class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项34</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项45</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项44</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项43</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项42</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项41</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项40</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框5465</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView11" disabled="" type="checkbox"><span>选项32</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项47</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项46444</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项49</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项48</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="45654" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Money"><label class="widget-title porela break inblock title">金额45454545</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"> <input class="form-control" disabled="" type="text"> <span class="money-type fr">(人民币)</span><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落546546546</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela flex" data-widget="RadioBox"><label class="widget-title porela break inblock title">单选框4565</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项145654</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项65</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项2456</span></label></li><li><label class="radio-inline"><input checked="checked" name="radioView22" disabled="" type="radio"><span>选项60765777</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项5965</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项64</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项58</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项34564564</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项63676</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateInterval"><label class="widget-title porela break inblock title">日期区间54</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月-日 时:分" disabled="" type="text"><span class="mr5">——</span><input class="form-control" placeholder="年-月-日 时:分" disabled="" type="text"><div class="field-description">456546</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="FileComponent"><label class="widget-title porela break inblock title">附件7657</label><span style="display: inline;" class="widget-required">*</span> <ul><li class="porela"></li></ul>   <div class="btn blue fr poabso">添加附件</div>   <div class="field-description">657657</div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="ImageComponent"><label class="widget-title porela break inblock title">图片56567</label><span style="display: block;" class="widget-required">*</span> <ul><li class="porela"></li></ul>  <div class="btn blue fr poabso">上传图片</div>   <div class="field-description hide"></div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="Email"><label class="widget-title porela break inblock title">邮箱5676</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落567657657</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落67657657</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor porela flex" data-widget="Employee"><label class="widget-title porela break inblock title">用户选择567657</label><span style="display: inline;" class="widget-required">*</span>   <div class="break pbc inblock rcontent"><ul><li></li></ul></div>   <div class="field-description">56765765765</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thickdashed"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="Mobile"><label class="widget-title porela break inblock title">手机657</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">567657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="RadioBox"><label class="widget-title porela break inblock title">单选框311</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项1</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项25456456</span></label></li><li><label class="radio-inline"><input checked="checked" name="radioView35" disabled="" type="radio"><span>选项7464654</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项73564</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项72456</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项71456</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项3</span></label></li></ul><div class="field-description">456546546546</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor porela flex" data-widget="Department"><label class="widget-title porela break inblock title">部门选择65765</label><span style="display: inline;" class="widget-required">*</span> <div class="break pbc inblock rcontent"><ul><li></li></ul></div>   <div class="field-description">657657657</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default field-active borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框q15</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项75</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项82</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项3</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView36" disabled="" type="checkbox"><span>选项81546546</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项806456</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Phone"><label class="widget-title porela break inblock title">电话567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">7567657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thicksolid"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thickdashed"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="Email"><label class="widget-title porela break inblock title">邮箱</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">67657657657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateComponent"><label class="widget-title porela break inblock title">日期56</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月-日" disabled="" type="text"><div class="field-description">5676576</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="NumberComponent"><label class="widget-title porela break inblock title">数字输入框567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">567657657657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thicksolid-double"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor porela flex" data-widget="Employee"><label class="widget-title porela break inblock title">用户选择2</label><span style="display: inline;" class="widget-required">*</span>   <div class="break pbc inblock rcontent"><ul><li></li></ul></div>   <div class="field-description">567657657</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="ImageComponent"><label class="widget-title porela break inblock title">图片5</label><span style="display: inline;" class="widget-required">*</span> <ul><li class="porela"></li></ul>  <div class="btn blue fr poabso">上传图片</div>   <div class="field-description hide"></div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="Select"><label class="widget-title porela break inblock title">下拉菜单</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><select class="form-control choicelist" disabled=""><option class="Select_js" value="">选项15</option><option class="Select_js" value="">选项68</option><option class="Select_js" value="">选项67</option><option selected="selected" class="Select_js" value="">选项66567657</option><option class="Select_js" value="">选项2567657</option><option class="Select_js" value="">选项7056</option><option class="Select_js" value="">选项69567</option><option class="Select_js" value="">选项3</option></select><div class="field-description">567657657657657657657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateInterval"><label class="widget-title porela break inblock title">日期区间5673</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月-日" disabled="" type="text"><span class="mr5">——</span><input class="form-control" placeholder="年-月-日" disabled="" type="text"><div class="field-description">7567</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateInterval"><label class="widget-title porela break inblock title">日期区间567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月" disabled="" type="text"><span class="mr5">——</span><input class="form-control" placeholder="年-月" disabled="" type="text"><div class="field-description">5675</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div>',field:[{formtype:"CheckBox",title:"复选框567",required:1,describe:"56765765",setting:{checkedMax:"5",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!0},2:{itemTitle:"选项4",itemData:!1},3:{itemTitle:"选项15",itemData:!1},4:{itemTitle:"选项14",itemData:!1},5:{itemTitle:"选项13",itemData:!1},6:{itemTitle:"选项12",itemData:!1},7:{itemTitle:"选项18",itemData:!1},8:{itemTitle:"选项17",itemData:!1},9:{itemTitle:"选项16",itemData:!1},10:{itemTitle:"选项11",itemData:!1},11:{itemTitle:"选项10",itemData:!1},12:{itemTitle:"选项9",itemData:!1},13:{itemTitle:"选项8",itemData:!1},14:{itemTitle:"选项7",itemData:!1},15:{itemTitle:"选项6",itemData:!1},16:{itemTitle:"选项20",itemData:!1},17:{itemTitle:"选项19666666",itemData:!1},18:{itemTitle:"选项23",itemData:!1},19:{itemTitle:"选项25",itemData:!1},20:{itemTitle:"选项24",itemData:!1},21:{itemTitle:"选项22",itemData:!1},22:{itemTitle:"选项21",itemData:!1}}}},{formtype:"CheckBox",title:"复选框",required:0,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项33",itemData:!1},3:{itemTitle:"选项26465465",itemData:!1},4:{itemTitle:"选项32",itemData:!1},5:{itemTitle:"选项31",itemData:!1},6:{itemTitle:"选项30",itemData:!1},7:{itemTitle:"选项29",itemData:!1},8:{itemTitle:"选项28",itemData:!1},9:{itemTitle:"选项27",itemData:!1},10:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Text",title:"文本输入框5464",required:1,describe:"54654654"},{formtype:"CheckBox",title:"复选框4565",required:1,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项134535",itemData:!1},1:{itemTitle:"选项25345435",itemData:!0},2:{itemTitle:"选项5445",itemData:!0},3:{itemTitle:"选项53345345",itemData:!0},4:{itemTitle:"选项5243",itemData:!1},5:{itemTitle:"选项3",itemData:!1},6:{itemTitle:"选项56534",itemData:!1},7:{itemTitle:"选项5554",itemData:!1},8:{itemTitle:"选项57",itemData:!1}}}},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落456546546546454</p>\n"},{formtype:"FileComponent",title:"附件54",required:1,describe:"456456546"},{formtype:"CheckBox",title:"复选框54646",required:0,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项34",itemData:!1},2:{itemTitle:"选项45",itemData:!1},3:{itemTitle:"选项44",itemData:!1},4:{itemTitle:"选项43",itemData:!1},5:{itemTitle:"选项2",itemData:!1},6:{itemTitle:"选项42",itemData:!1},7:{itemTitle:"选项41",itemData:!1},8:{itemTitle:"选项40",itemData:!1}}}},{formtype:"CheckBox",title:"复选框5465",required:1,describe:"",setting:{checkedMax:"45654",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项32",itemData:!0},3:{itemTitle:"选项47",itemData:!1},4:{itemTitle:"选项46444",itemData:!1},5:{itemTitle:"选项49",itemData:!1},6:{itemTitle:"选项48",itemData:!1}}}},{formtype:"Money",title:"金额45454545",required:1,describe:"",moneyType:"人民币4444"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落546546546</p>\n"},{formtype:"RadioBox",title:"单选框4565",required:1,describe:"",setting:{radio:{0:{itemTitle:"选项145654",itemData:!1},1:{itemTitle:"选项65",itemData:!1},2:{itemTitle:"选项2456",itemData:!1},3:{itemTitle:"选项60765777",itemData:!0},4:{itemTitle:"选项5965",itemData:!1},5:{itemTitle:"选项64",itemData:!1},6:{itemTitle:"选项58",itemData:!1},7:{itemTitle:"选项34564564",itemData:!1},8:{itemTitle:"选项63676",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间54",required:1,describe:"456546",dateType:"年-月-日 时:分"},{formtype:"FileComponent",title:"附件7657",required:1,describe:"657657"},{formtype:"ImageComponent",title:"图片56567",required:1,describe:""},{formtype:"Email",title:"邮箱5676",required:1,describe:""},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落567657657</p>\n"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落67657657</p>\n"},{formtype:"Employee",title:"用户选择567657",required:1,describe:"56765765765"},{formtype:"DividingLine",styleType:"thickdashed"},{formtype:"Mobile",title:"手机657",required:1,describe:"567657"},{formtype:"RadioBox",title:"单选框311",required:1,describe:"456546546546",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项25456456",itemData:!1},2:{itemTitle:"选项7464654",itemData:!0},3:{itemTitle:"选项73564",itemData:!1},4:{itemTitle:"选项72456",itemData:!1},5:{itemTitle:"选项71456",itemData:!1},6:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Department",title:"部门选择65765",required:1,describe:"657657657"},{formtype:"CheckBox",title:"复选框q15",required:1,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项75",itemData:!1},1:{itemTitle:"选项82",itemData:!1},2:{itemTitle:"选项3",itemData:!1},3:{itemTitle:"选项81546546",itemData:!0},4:{itemTitle:"选项806456",itemData:!1}}}},{formtype:"Phone",title:"电话567",required:1,describe:"7567657"},{formtype:"DividingLine",styleType:"thicksolid"},{formtype:"DividingLine",styleType:"thickdashed"},{formtype:"Email",title:"邮箱",required:1,describe:"67657657657"},{formtype:"DateComponent",title:"日期56",required:1,describe:"5676576",dateType:"年-月-日"},{formtype:"NumberComponent",title:"数字输入框567",required:1,describe:"567657657657"},{formtype:"DividingLine",styleType:"thicksolid-double"},{formtype:"Employee",title:"用户选择2",required:1,describe:"567657657"},{formtype:"ImageComponent",title:"图片5",required:1,describe:""},{formtype:"Select",title:"下拉菜单",required:1,describe:"567657657657657657657",setting:{select:{0:{itemTitle:"选项15",itemData:!1},1:{itemTitle:"选项68",itemData:!1},2:{itemTitle:"选项67",itemData:!1},3:{itemTitle:"选项66567657",itemData:!0},4:{itemTitle:"选项2567657",itemData:!1},5:{itemTitle:"选项7056",itemData:!1},6:{itemTitle:"选项69567",itemData:!1},7:{itemTitle:"选项3",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间5673",required:1,describe:"7567",dateType:"年-月-日"},{formtype:"DateInterval",title:"日期区间567",required:1,describe:"5675",dateType:"年-月"},{formtype:"TextArea",title:"多行文本框33",required:0,describe:"534543545454"},{formtype:"DateInterval",title:"日期区间67",required:1,describe:"",dateType:"年-月-日 时:分"},{formtype:"DateInterval",title:"日期区间5",required:1,describe:"",dateType:"年-月-日"},{formtype:"DateInterval",title:"日期区间56",required:1,describe:"",dateType:"年-月-日 时"},{formtype:"DateInterval",title:"日期区间",required:1,describe:"",dateType:"年-月"},{formtype:"RadioBox",title:"单选框",required:1,describe:"",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项3",itemData:!1}}}}]},apply.formdata={data1:{title:"测试表单标题1",datas:apply.formshowdata.html},data2:{title:apply.formshowdata.title,datas:apply.formshowdata.html}},apply.changeforms=function(str){0==str?($(".createforms .titlebor input").val(""),$(".createforms .scrollbor").html(""),$(".formseditbor .scrollbor").html("")):1==str?($(".createforms .titlebor input").val(apply.formdata.data1.title),$(".createforms .scrollbor").html(apply.formdata.data1.datas),$(".createforms .field:first").trigger("click")):2==str&&($(".createforms .titlebor input").val(apply.formdata.data2.title),$(".createforms .scrollbor").html(apply.formdata.data2.datas),$(".createforms .field:first").trigger("click"))},apply.formPreview=function(){var formtitle=$(".createforms .titlebor input").val(),formhtml=$(".createforms .scrollbor").html();$(".formPreview .formtitles").html(formtitle),$(".formPreview .scrollbor").html(formhtml),$(".formPreview .borderbor").removeClass("field"),$(".formPreview,#masklayer1").show()},apply.formPreviewClose=function(){$(".formPreview .scrollbor").html(""),$(".formPreview,#masklayer1").hide()}});
ApplyMod.controller("applyFlowCtrl",function($scope,$http,$rootScope,Publicfactory,applyModel,$timeout,$stateParams,$state){$scope.readOnly=1==$stateParams.readOnly;var model_id=$stateParams.id,modeltype=$stateParams.type,selectTypes=[{label:"无",value:"-1"}];2==model_id&&(selectTypes=[{label:"无",value:"-1"},{label:"休假时间",value:"leave_sum"}]),1==model_id&&(selectTypes=[{label:"无",value:"-1"}]),$scope.hideFilter=3==model_id||4==model_id||5==model_id||1==model_id;var selectExprs=[{label:"无",value:"0"},{label:">",value:"1"},{label:"<",value:"2"},{label:">=",value:"3"},{label:"<=",value:"4"},{label:"=",value:"5"}],limitTypes=[{label:"无",value:"0"},{label:"年",value:"4"},{label:"月",value:"3"},{label:"周",value:"2"},{label:"日",value:"1"}];$scope.limitTypes=limitTypes,$scope.selectTypes=selectTypes,$scope.selectExprs=selectExprs;var defaultGroup={selectedDeparts:[],selectedMembers:[],scopeType:0,conditions:{type:$scope.selectTypes[0],expression:selectExprs[1],value:0},flows:[{level:1,auditors:[]}]};$scope.defaultGroup=defaultGroup;var _params={model_id:model_id,modeltype:modeltype,limit_num:6,limit_type:limitTypes[0],groups:[defaultGroup]};$scope.params=_params,$scope.supervisor=!0,$scope.validateLimitNumber=function(e){if(console.log("e",e),/^\d+$/g.test($scope.params.limit_num)===!1)return!1},$scope.addGroup=function(){$scope.params.groups.push({selectedDeparts:[],selectedMembers:[],scopeType:0,conditions:{type:$scope.selectTypes[0],expression:$scope.selectExprs[0],value:0},flows:[{level:1,auditors:[]}]})},$scope.copyGroup=function(index){var copiedGroup=_.cloneDeep($scope.params.groups[index]);$scope.params.groups.push(copiedGroup)},$scope.deleteGroupTC=!1,$scope.deleteGroupINDEX=0,$scope.deleteGroup=function(index){$scope.deleteGroupTC=!0,$("#masklayer2").show(),$scope.deleteGroupINDEX=index},$scope.deleteGroupTrue=function(){$scope.params.groups.splice($scope.deleteGroupINDEX,1),$scope.deleteGroupTC=!1,$("#masklayer2").hide()},$scope.deleteGroupFalse=function(){$scope.deleteGroupTC=!1,$("#masklayer2").hide()},$scope.deleteFlow=function(index,subIndex){$scope.params.groups[index].flows.splice(subIndex,1)},$scope.addFlow=function(index){var level=$scope.params.groups[index].flows.length+1;$scope.params.groups[index].flows.push({level:level,auditors:[]})},$scope.addAuditor=function(path){$scope.memberDialogVisble||($scope.onlyOne=!0,$scope.supervisor=!0,$scope.selectedMembersPath=path,$scope.selectedMembers=_.get($scope.params,path+".auditors"),$scope.memberDialogVisble=!0)},$scope.deleteAuditor=function(path){_.update($scope.params,path,function(v){return v.auditors=[],v})},$scope.selectedDepartsPath="",$scope.selectedMembersPath="",$scope.selectedDeparts=[],$scope.departDialogVisble=!1,$scope.onlyOne=!0,$scope.openDepartDialog=function(path){$scope.departDialogVisble||(_.update($scope.params,path,function(v){return v.selectedMembers=[],v}),$scope.selectedDepartsPath=path,$scope.selectedDeparts=_.get($scope.params,path+".selectedDeparts"),$scope.departDialogVisble=!0)},$scope.closeDepartDialog=function(){$scope.departDialogVisble=!1},$scope.selectedMembers=[],$scope.memberDialogVisble=!1,$scope.openMemberDialog=function(path){$scope.memberDialogVisble||(_.update($scope.params,path,function(v){return v.selectedDeparts=[],v}),$scope.onlyOne=!1,$scope.supervisor=!1,$scope.selectedMembersPath=path,$scope.selectedMembers=_.get($scope.params,path+".selectedMembers"),$scope.memberDialogVisble=!0)},$scope.closeMemberDialog=function(){$scope.memberDialogVisble=!1},$scope.$watch("selectedDeparts",function(newValue,oldValue){$scope.selectedDepartsPath&&_.update($scope.params,$scope.selectedDepartsPath,function(v){return v.selectedDeparts=newValue,v.scopeType=1,v})}),$scope.$watch("selectedMembers",function(newValue,oldValue){$scope.selectedMembersPath&&(_.update($scope.params,$scope.selectedMembersPath,function(v){return v.scopeType=0,v.selectedMembers?v.selectedMembers=newValue:v.auditors&&(v.auditors=newValue),v}),_.update($scope.params,"groups[0]",function(v){return v}))}),$scope.deleteDepart=function(depart,index){$scope.params.groups[index].selectedDeparts=_.reject($scope.params.groups[index].selectedDeparts,{value:depart.value})},$scope.deleteMember=function(member,index){$scope.params.groups[index].selectedMembers=_.reject($scope.params.groups[index].selectedMembers,{value:member.value})},$scope.handleLimitChange=function(index,type){"-1"===type.value&&($scope.params.groups[index].conditions.expression=$scope.selectExprs[0],$scope.params.groups[index].conditions.value=0)},$http.get("index.php?r=apply/apply-flow/show-flow&model_id="+model_id).success(function(ret){1===ret.code&&(0==$scope.params.modeltype&&(selectTypes=ret.data.fieldList.map(function(v){return{value:v.field,label:v.title}}),selectTypes.unshift({label:"无",value:"-1"}),$scope.selectTypes=selectTypes),$scope.params.limit_num=Number(ret.data.limit_num),$scope.params.limit_type=_.find(limitTypes,{value:ret.data.limit_type}),$scope.params.groups=ret.data.flow.map(function(v,i){var conditionType=_.find(selectTypes,{value:v.item}),conditionExpr=_.find(selectExprs,{value:v.condition}),selectedMembers=[],selectedDeparts=[];1==v.type&&(selectedDeparts=v.visiblemanInfo.map(function(depart){return{label:depart.org_name,value:depart.org_id}})),0==v.type&&(selectedMembers=v.visiblemanInfo.map(function(member){return{value:member.u_id,label:member.real_name,avatar:member.head_img}}));var group={scopeType:v.type,conditions:{type:conditionType,expression:conditionExpr,value:Number(v.value)},selectedMembers:selectedMembers,selectedDeparts:selectedDeparts};return group.flows=[],_.forEach(v.flow,function(v,k){group.flows.push({level:k,auditors:[{label:v.real_name,value:v.u_id,avatar:v.head_img}]})}),0===group.flows.length&&$scope.addFlow(i),group}),0===ret.data.flow.length&&$scope.addGroup())}),$scope.submit=function(){var reg=/^([1-9]\d*|0)$/;if(!reg.test(angular.element(".limitnumber").val()))return void alert("发起次数限制必须为正整数或0");if(!reg.test(angular.element(".numberday").val()))return void alert("判断条件必须为正整数或0");var payload=_.pick($scope.params,["model_id","modeltype","limit_num"]);if(payload.limit_type=$scope.params.limit_type.value,payload.limit_num>0&&"0"==payload.limit_type)return void alert("请将限制次数与限制周期填写完整");payload.flow=[];var isValid=!0;$scope.params.groups.forEach(function(group){var _flows={};if(_.forEach(group.flows,function(v,i){return 0==v.auditors.length?(alert("请填写审批人"),void(isValid=!1)):void(_flows[i+1]=v.auditors[0].value)}),0==group.selectedDeparts.length&&0==group.selectedMembers.length)return alert("指定部门或指定人不能为空"),void(isValid=!1);var flow={type:group.scopeType,visibleman:0==group.scopeType?group.selectedMembers.map(function(v){return v.value}).join(","):group.selectedDeparts.map(function(v){return v.value}).join(","),condition:group.conditions.expression.value,item:group.conditions.type.value,value:group.conditions.value,flow:_flows};payload.flow.push(flow)}),isValid&&$http.post("index.php?r=apply/apply-flow/create-flow",payload).then(function(ret){1==ret.data.code?(alert("设置成功"),$timeout(function(){$state.go("main.apply.manage")},1e3)):alert(ret.data.msg)})},$scope.goback=function(){$state.go("main.apply.manage")}}),ApplyMod.directive("applyFlow",function($http){return{scope:{modelid:"=",modeltype:"=",status:"@"},replace:!0,restrict:"E",templateUrl:"appnews/modules/apply/view/apply_flow_view.html",link:function($scope,element,attrs){var model_id=$scope.modelid,modeltype=$scope.modeltype,selectTypes=[{label:"无",value:"-1"},{label:"休假时间",value:"0"},{label:"加班时间",value:"1"}];2===model_id&&(selectTypes=[{label:"无",value:"-1"},{label:"休假时间",value:"leave_sum"}]),1===model_id&&(selectTypes=[{label:"无",value:"-1"},{label:"加班时间",value:"1"}]),$scope.hideFilter=3==model_id||4==model_id||5==model_id;var selectExprs=[{label:"无",value:"0"},{label:">",value:"1"},{label:"<",value:"2"},{label:">=",value:"3"},{label:"<=",value:"4"},{label:"=",value:"5"}],limitTypes=[{label:"无",value:"0"},{label:"年",value:"4"},{label:"月",value:"3"},{label:"周",value:"2"},{label:"日",value:"1"}];$scope.limitTypes=limitTypes,$scope.selectTypes=selectTypes,$scope.selectExprs=selectExprs;var defaultGroup={selectedDeparts:[],selectedMembers:[],scopeType:0,conditions:{type:$scope.selectTypes[0],expression:selectExprs[1],value:0},flows:[]},_params={model_id:model_id,modeltype:modeltype,limit_num:6,limit_type:limitTypes[0],groups:[defaultGroup]};$scope.params=_params,$scope.selectedDepartsPath="",$scope.selectedMembersPath="",$scope.selectedDeparts=[],$scope.departDialogVisble=!1,$scope.selectedMembers=[],$scope.isFetched=!1,$scope.$watch("status",function(newValue,oldValue){var selectTypes=[{label:"无",value:"-1"},{label:"休假时间",value:"0"},{label:"加班时间",value:"1"}];2==$scope.modelid&&(selectTypes=[{label:"无",value:"-1"},{label:"休假时间",value:"leave_sum"}]),1==$scope.modelid&&(selectTypes=[{label:"无",value:"-1"},{label:"加班时间",value:"1"}]),$http.get("index.php?r=apply/apply-flow/show-flow&model_id="+$scope.modelid).success(function(ret){1===ret.code&&(0==$scope.modeltype&&(selectTypes=ret.data.fieldList.map(function(v){return{value:v.field,label:v.title}}),selectTypes.unshift({label:"无",value:"-1"})),$scope.selectTypes=selectTypes,$scope.params.limit_num=ret.data.limit_num,$scope.params.limit_type=_.find(limitTypes,{value:ret.data.limit_type}),ret.data.flow&&($scope.params.groups=ret.data.flow.map(function(v){var conditionType=_.find(selectTypes,{value:v.item}),conditionExpr=_.find(selectExprs,{value:v.condition}),selectedMembers=[],selectedDeparts=[];1==v.type&&(selectedDeparts=v.visiblemanInfo.map(function(depart){return{label:depart.org_name,value:depart.org_id}})),0==v.type&&(selectedMembers=v.visiblemanInfo.map(function(member){return{value:member.u_id,label:member.real_name,avatar:member.head_img}}));var group={scopeType:v.type,conditions:{type:conditionType,expression:conditionExpr,value:v.value},selectedMembers:selectedMembers,selectedDeparts:selectedDeparts};return group.flows=[],_.forEach(v.flow,function(v,k){group.flows.push({level:k,auditors:[{label:v.real_name,value:v.u_id,avatar:v.head_img}]})}),group})))})})}}});
ApplyMod.controller("applyshowCtrl",function($scope,$http,$rootScope,Publicfactory,applyModel,$timeout,formshowfactory,$compile){var apply=$scope.apply={};$scope.att=[],apply.formshowdata={title:"53454354354354",html:'\n     <div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView1" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项4</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项15</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项14</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项13</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项12</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项18</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项17</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项16</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项11</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项10</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项9</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项8</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项7</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项6</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项20</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项19666666</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项23</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项25</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项24</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项22</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView1" disabled="" type="checkbox"><span>选项21</span></label></li></ul><div class="field-description">56765765</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框</label><span class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项33</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项26465465</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项32</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项31</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项30</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项29</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项28</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项27</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView13" disabled="" type="checkbox"><span>选项3</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Text"><label class="widget-title porela break inblock title">文本输入框5464</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">54654654</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框4565</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项134535</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView19" disabled="" type="checkbox"><span>选项25345435</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView19" disabled="" type="checkbox"><span>选项5445</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView19" disabled="" type="checkbox"><span>选项53345345</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项5243</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项3</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项56534</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项5554</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView19" disabled="" type="checkbox"><span>选项57</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落456546546546454</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela flex" data-widget="FileComponent"><label class="widget-title porela break inblock title">附件54</label><span style="display: inline;" class="widget-required">*</span> <ul><li class="porela"></li></ul>   <div class="btn blue fr poabso">添加附件</div>   <div class="field-description">456456546</div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框54646</label><span class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项34</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项45</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项44</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项43</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项42</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项41</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView14" disabled="" type="checkbox"><span>选项40</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框5465</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项1</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项2</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView11" disabled="" type="checkbox"><span>选项32</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项47</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项46444</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项49</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView11" disabled="" type="checkbox"><span>选项48</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="45654" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Money"><label class="widget-title porela break inblock title">金额45454545</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"> <input class="form-control" disabled="" type="text"> <span class="money-type fr">(人民币)</span><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落546546546</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela flex" data-widget="RadioBox"><label class="widget-title porela break inblock title">单选框4565</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项145654</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项65</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项2456</span></label></li><li><label class="radio-inline"><input checked="checked" name="radioView22" disabled="" type="radio"><span>选项60765777</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项5965</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项64</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项58</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项34564564</span></label></li><li><label class="radio-inline"><input name="radioView22" disabled="" type="radio"><span>选项63676</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateInterval"><label class="widget-title porela break inblock title">日期区间54</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月-日 时:分" disabled="" type="text"><span class="mr5">——</span><input class="form-control" placeholder="年-月-日 时:分" disabled="" type="text"><div class="field-description">456546</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="FileComponent"><label class="widget-title porela break inblock title">附件7657</label><span style="display: inline;" class="widget-required">*</span> <ul><li class="porela"></li></ul>   <div class="btn blue fr poabso">添加附件</div>   <div class="field-description">657657</div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="ImageComponent"><label class="widget-title porela break inblock title">图片56567</label><span style="display: block;" class="widget-required">*</span> <ul><li class="porela"></li></ul>  <div class="btn blue fr poabso">上传图片</div>   <div class="field-description hide"></div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="Email"><label class="widget-title porela break inblock title">邮箱5676</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落567657657</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="Paragraph"><div class="alert alert-success" role="alert"><p>空白段落67657657</p>\n</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor porela flex" data-widget="Employee"><label class="widget-title porela break inblock title">用户选择567657</label><span style="display: inline;" class="widget-required">*</span>   <div class="break pbc inblock rcontent"><ul><li></li></ul></div>   <div class="field-description">56765765765</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thickdashed"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="Mobile"><label class="widget-title porela break inblock title">手机657</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">567657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="RadioBox"><label class="widget-title porela break inblock title">单选框311</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项1</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项25456456</span></label></li><li><label class="radio-inline"><input checked="checked" name="radioView35" disabled="" type="radio"><span>选项7464654</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项73564</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项72456</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项71456</span></label></li><li><label class="radio-inline"><input name="radioView35" disabled="" type="radio"><span>选项3</span></label></li></ul><div class="field-description">456546546546</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor porela flex" data-widget="Department"><label class="widget-title porela break inblock title">部门选择65765</label><span style="display: inline;" class="widget-required">*</span> <div class="break pbc inblock rcontent"><ul><li></li></ul></div>   <div class="field-description">657657657</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default field-active borderbor of porela flex" data-widget="CheckBox"><label class="widget-title porela break inblock title">复选框q15</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><ul><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项75</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项82</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项3</span></label></li><li><label class="CheckBox_js"><input checked="checked" name="CheckBoxView36" disabled="" type="checkbox"><span>选项81546546</span></label></li><li><label class="CheckBox_js"><input name="CheckBoxView36" disabled="" type="checkbox"><span>选项806456</span></label></li></ul><div class="field-description hide"></div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><input name="checkedMax" value="" type="hidden"></div><div class="field ui-state-default borderbor of porela" data-widget="Phone"><label class="widget-title porela break inblock title">电话567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">7567657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thicksolid"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thickdashed"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor of porela" data-widget="Email"><label class="widget-title porela break inblock title">邮箱</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">67657657657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateComponent"><label class="widget-title porela break inblock title">日期56</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月-日" disabled="" type="text"><div class="field-description">5676576</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="NumberComponent"><label class="widget-title porela break inblock title">数字输入框567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" disabled="" type="text"><div class="field-description">567657657657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DividingLine"><div class="divider-line thicksolid-double"></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i><span class="widget-required"></span></div><div class="field ui-state-default borderbor porela flex" data-widget="Employee"><label class="widget-title porela break inblock title">用户选择2</label><span style="display: inline;" class="widget-required">*</span>   <div class="break pbc inblock rcontent"><ul><li></li></ul></div>   <div class="field-description">567657657</div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="ImageComponent"><label class="widget-title porela break inblock title">图片5</label><span style="display: inline;" class="widget-required">*</span> <ul><li class="porela"></li></ul>  <div class="btn blue fr poabso">上传图片</div>   <div class="field-description hide"></div> <i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela flex" data-widget="Select"><label class="widget-title porela break inblock title">下拉菜单</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><select class="form-control choicelist" disabled=""><option class="Select_js" value="">选项15</option><option class="Select_js" value="">选项68</option><option class="Select_js" value="">选项67</option><option selected="selected" class="Select_js" value="">选项66567657</option><option class="Select_js" value="">选项2567657</option><option class="Select_js" value="">选项7056</option><option class="Select_js" value="">选项69567</option><option class="Select_js" value="">选项3</option></select><div class="field-description">567657657657657657657</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateInterval"><label class="widget-title porela break inblock title">日期区间5673</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月-日" disabled="" type="text"><span class="mr5">——</span><input class="form-control" placeholder="年-月-日" disabled="" type="text"><div class="field-description">7567</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div><div class="field ui-state-default borderbor of porela" data-widget="DateInterval"><label class="widget-title porela break inblock title">日期区间567</label><span style="display: inline;" class="widget-required">*</span><div class="widget-content break pbc inblock rcontent"><input class="form-control" placeholder="年-月" disabled="" type="text"><span class="mr5">——</span><input class="form-control" placeholder="年-月" disabled="" type="text"><div class="field-description">5675</div></div><i class="glyphicon glyphicon-remove-circle" title="移除当前字段"></i></div>',field:[{formtype:"CheckBox",title:"复选框567",required:1,describe:"56765765",setting:{checkedMax:"5",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!0},2:{itemTitle:"选项4",itemData:!1},3:{itemTitle:"选项15",itemData:!1},4:{itemTitle:"选项14",itemData:!1},5:{itemTitle:"选项13",itemData:!1},6:{itemTitle:"选项12",itemData:!1},7:{itemTitle:"选项18",itemData:!1},8:{itemTitle:"选项17",itemData:!1},9:{itemTitle:"选项16",itemData:!1},10:{itemTitle:"选项11",itemData:!1},11:{itemTitle:"选项10",itemData:!1},12:{itemTitle:"选项9",itemData:!1},13:{itemTitle:"选项8",itemData:!1},14:{itemTitle:"选项7",itemData:!1},15:{itemTitle:"选项6",itemData:!1},16:{itemTitle:"选项20",itemData:!1},17:{itemTitle:"选项19666666",itemData:!1},18:{itemTitle:"选项23",itemData:!1},19:{itemTitle:"选项25",itemData:!1},20:{itemTitle:"选项24",itemData:!1},21:{itemTitle:"选项22",itemData:!1},22:{itemTitle:"选项21",itemData:!1}}}},{formtype:"CheckBox",title:"复选框",required:0,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项33",itemData:!1},3:{itemTitle:"选项26465465",itemData:!1},4:{itemTitle:"选项32",itemData:!1},5:{itemTitle:"选项31",itemData:!1},6:{itemTitle:"选项30",itemData:!1},7:{itemTitle:"选项29",itemData:!1},8:{itemTitle:"选项28",itemData:!1},9:{itemTitle:"选项27",itemData:!1},10:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Text",title:"文本输入框5464",required:1,describe:"54654654"},{formtype:"CheckBox",title:"复选框4565",required:1,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项134535",itemData:!1},1:{itemTitle:"选项25345435",itemData:!0},2:{itemTitle:"选项5445",itemData:!0},3:{itemTitle:"选项53345345",itemData:!0},4:{itemTitle:"选项5243",itemData:!1},5:{itemTitle:"选项3",itemData:!1},6:{itemTitle:"选项56534",itemData:!1},7:{itemTitle:"选项5554",itemData:!1},8:{itemTitle:"选项57",itemData:!1}}}},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落456546546546454</p>\n"},{formtype:"FileComponent",title:"附件54",required:1,describe:"456456546"},{formtype:"CheckBox",title:"复选框54646",required:0,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项34",itemData:!1},2:{itemTitle:"选项45",itemData:!1},3:{itemTitle:"选项44",itemData:!1},4:{itemTitle:"选项43",itemData:!1},5:{itemTitle:"选项2",itemData:!1},6:{itemTitle:"选项42",itemData:!1},7:{itemTitle:"选项41",itemData:!1},8:{itemTitle:"选项40",itemData:!1}}}},{formtype:"CheckBox",title:"复选框5465",required:1,describe:"",setting:{checkedMax:"45654",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项32",itemData:!0},3:{itemTitle:"选项47",itemData:!1},4:{itemTitle:"选项46444",itemData:!1},5:{itemTitle:"选项49",itemData:!1},6:{itemTitle:"选项48",itemData:!1}}}},{formtype:"Money",title:"金额45454545",required:1,describe:"",moneyType:"人民币4444"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落546546546</p>\n"},{formtype:"RadioBox",title:"单选框4565",required:1,describe:"",setting:{radio:{0:{itemTitle:"选项145654",itemData:!1},1:{itemTitle:"选项65",itemData:!1},2:{itemTitle:"选项2456",itemData:!1},3:{itemTitle:"选项60765777",itemData:!0},4:{itemTitle:"选项5965",itemData:!1},5:{itemTitle:"选项64",itemData:!1},6:{itemTitle:"选项58",itemData:!1},7:{itemTitle:"选项34564564",itemData:!1},8:{itemTitle:"选项63676",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间54",required:1,describe:"456546",dateType:"年-月-日 时:分"},{formtype:"FileComponent",title:"附件7657",required:1,describe:"657657"},{formtype:"ImageComponent",title:"图片56567",required:1,describe:""},{formtype:"Email",title:"邮箱5676",required:1,describe:""},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落567657657</p>\n"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落67657657</p>\n"},{formtype:"Employee",title:"用户选择567657",required:1,describe:"56765765765"},{formtype:"DividingLine",styleType:"thickdashed"},{formtype:"Mobile",title:"手机657",required:1,describe:"567657"},{formtype:"RadioBox",title:"单选框311",required:1,describe:"456546546546",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项25456456",itemData:!1},2:{itemTitle:"选项7464654",itemData:!0},3:{itemTitle:"选项73564",itemData:!1},4:{itemTitle:"选项72456",itemData:!1},5:{itemTitle:"选项71456",itemData:!1},6:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Department",title:"部门选择65765",required:1,describe:"657657657"},{formtype:"CheckBox",title:"复选框q15",required:1,describe:"",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项75",itemData:!1},1:{itemTitle:"选项82",itemData:!1},2:{itemTitle:"选项3",itemData:!1},3:{itemTitle:"选项81546546",itemData:!0},4:{itemTitle:"选项806456",itemData:!1}}}},{formtype:"Phone",title:"电话567",required:1,describe:"7567657"},{formtype:"DividingLine",styleType:"thicksolid"},{formtype:"DividingLine",styleType:"thickdashed"},{formtype:"Email",title:"邮箱",required:1,describe:"67657657657"},{formtype:"DateComponent",title:"日期56",required:1,describe:"5676576",dateType:"年-月-日"},{formtype:"NumberComponent",title:"数字输入框567",required:1,describe:"567657657657"},{formtype:"DividingLine",styleType:"thicksolid-double"},{formtype:"Employee",title:"用户选择2",required:1,describe:"567657657"},{formtype:"ImageComponent",title:"图片5",required:1,describe:""},{formtype:"Select",title:"下拉菜单",required:1,describe:"567657657657657657657",setting:{select:{0:{itemTitle:"选项15",itemData:!1},1:{itemTitle:"选项68",itemData:!1},2:{itemTitle:"选项67",itemData:!1},3:{itemTitle:"选项66567657",itemData:!0},4:{itemTitle:"选项2567657",itemData:!1},5:{itemTitle:"选项7056",itemData:!1},6:{itemTitle:"选项69567",itemData:!1},7:{itemTitle:"选项3",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间5673",required:1,describe:"7567",dateType:"年-月-日"},{formtype:"DateInterval",title:"日期区间567",required:1,describe:"5675",dateType:"年-月"},{formtype:"TextArea",title:"多行文本框33",required:0,describe:"534543545454"},{formtype:"DateInterval",title:"日期区间67",required:1,describe:"",dateType:"年-月-日 时:分"},{formtype:"DateInterval",title:"日期区间5",required:1,describe:"",dateType:"年-月-日"},{formtype:"DateInterval",title:"日期区间56",required:1,describe:"",dateType:"年-月-日 时"},{formtype:"DateInterval",title:"日期区间",required:1,describe:"",dateType:"年-月"},{formtype:"RadioBox",title:"单选框",required:1,describe:"",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项3",itemData:!1}}}}]},formshowfactory.formshow(apply.formshowdata,$compile,$scope,1),$scope.addFileBtn=function(Uploader,element){Uploader.url="/index.php?r=apply/apply/upload";for(var ele=element.parents(".borderbor").find("ul"),filenamelength=ele.find(".filesize"),fileaftersize=0,i=0;i<filenamelength.length;i++)fileaftersize+=parseFloat(filenamelength.eq(i).html().replace("KB",""));if(fileaftersize=fileaftersize.toFixed(2),element.parents(".borderbor").find(".none").html(fileaftersize),fileaftersize>51200)return alert("总文件大小已超过上限50MB!"),!1;var elesize=element.parents(".borderbor").find(".none").html();Uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){if(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),elesize=parseFloat(elesize)+parseFloat(response.data.data.file_size),elesize>51200)return alert("总文件大小超过50MB，已从上传队列中移除"),!1;var file_root=response.file_root,filefull_path=file_root+"/"+response.data.data.file_path+"/"+response.data.data.real_name,li='<li class="porela"><i class="poabso icon-'+response.data.data.file_type+'"></i><div class="filename fl omit"><a href="'+filefull_path+'" target="_blank">'+response.data.data.file_name+'</a></div><div class="filesize fl omit">'+response.data.data.file_size+'KB</div><div class="del fr">删除</div></li>';ele.append(li),element.parents(".borderbor").find(".none").html(elesize)}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},$(document).on("click",".borderbor .del",function(){
$(this).parent().remove()}),$(".addbtn1.fpgbtn").click(function(){var lis=$(this).parent().find("ul"),li='<li class="porela"><div class="filename fl omit" data-member_id="23">张三李四</div><div class="del fr">删除</div></li>';lis.append(li),$("#masklayer1").show()}),$(".formsave").click(function(){if(formshowfactory.formshowsave(apply.formshowdata)){var showFormssave=new jQuery.showeditForm,result=showFormssave.saveForm();console.log({postdata:JSON.stringify(result)})}})});
ApplyMod.controller("applyeditshowCtrl",function($scope,$http,$rootScope,Publicfactory,applyModel,$timeout,formshowfactory,$compile){var apply=$scope.apply={};$scope.att=[],apply.formshoweditdata={title:"53454354354354",field:[{formtype:"CheckBox",title:"复选框567",required:1,describe:"56765765",inputvalue:"on",setting:{checkedMax:"5",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!0},2:{itemTitle:"选项4",itemData:!1},3:{itemTitle:"选项15",itemData:!1},4:{itemTitle:"选项14",itemData:!1},5:{itemTitle:"选项13",itemData:!1},6:{itemTitle:"选项12",itemData:!1},7:{itemTitle:"选项18",itemData:!1},8:{itemTitle:"选项17",itemData:!1},9:{itemTitle:"选项16",itemData:!1},10:{itemTitle:"选项11",itemData:!0},11:{itemTitle:"选项10",itemData:!0},12:{itemTitle:"选项9",itemData:!1},13:{itemTitle:"选项8",itemData:!1},14:{itemTitle:"选项7",itemData:!1},15:{itemTitle:"选项6",itemData:!1},16:{itemTitle:"选项20",itemData:!1},17:{itemTitle:"选项19666666",itemData:!1},18:{itemTitle:"选项23",itemData:!1},19:{itemTitle:"选项25",itemData:!0},20:{itemTitle:"选项24",itemData:!0},21:{itemTitle:"选项22",itemData:!1},22:{itemTitle:"选项21",itemData:!1}}}},{formtype:"CheckBox",title:"复选框",required:0,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!0},1:{itemTitle:"选项2",itemData:!0},2:{itemTitle:"选项33",itemData:!1},3:{itemTitle:"选项26465465",itemData:!1},4:{itemTitle:"选项32",itemData:!1},5:{itemTitle:"选项31",itemData:!1},6:{itemTitle:"选项30",itemData:!1},7:{itemTitle:"选项29",itemData:!1},8:{itemTitle:"选项28",itemData:!0},9:{itemTitle:"选项27",itemData:!0},10:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Text",title:"文本输入框5464",required:1,describe:"54654654",inputvalue:"5677"},{formtype:"CheckBox",title:"复选框4565",required:1,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项134535",itemData:!0},1:{itemTitle:"选项25345435",itemData:!0},2:{itemTitle:"选项5445",itemData:!0},3:{itemTitle:"选项53345345",itemData:!0},4:{itemTitle:"选项5243",itemData:!0},5:{itemTitle:"选项3",itemData:!0},6:{itemTitle:"选项56534",itemData:!0},7:{itemTitle:"选项5554",itemData:!0},8:{itemTitle:"选项57",itemData:!0}}}},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落456546546546454</p>\n"},{formtype:"FileComponent",title:"附件54",required:1,describe:"456456546",inputvalue:"",setting:{FileComponent:{0:{FileComponent:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">项目详情-进度项目详情-进度项目详情-进度项目详情-进度项目详情-进度项目详情-进度项目详情-进度项目详情-进度项目详情-进度项目详情-进度项目详情-进度.png</a></div><div class="filesize fl omit">7.37KB</div><div class="del fr">删除</div>'},1:{FileComponent:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">11974119.png</a></div><div class="filesize fl omit">5.64KB</div><div class="del fr">删除</div>'},2:{FileComponent:'<i class="poabso icon-txt"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">新建文本文档 (2).txt</a></div><div class="filesize fl omit">11.97KB</div><div class="del fr">删除</div>'},3:{FileComponent:'<i class="poabso icon-rar"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">ad7.rar</a></div><div class="filesize fl omit">88.04KB</div><div class="del fr">删除</div>'}}}},{formtype:"CheckBox",title:"复选框54646",required:0,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!0},1:{itemTitle:"选项34",itemData:!0},2:{itemTitle:"选项45",itemData:!0},3:{itemTitle:"选项44",itemData:!0},4:{itemTitle:"选项43",itemData:!0},5:{itemTitle:"选项2",itemData:!1},6:{itemTitle:"选项42",itemData:!1},7:{itemTitle:"选项41",itemData:!1},8:{itemTitle:"选项40",itemData:!1}}}},{formtype:"CheckBox",title:"复选框5465",required:1,describe:"",inputvalue:"on",setting:{checkedMax:"45654",checkbox:{0:{itemTitle:"选项1",itemData:!0},1:{itemTitle:"选项2",itemData:!0},2:{itemTitle:"选项32",itemData:!0},3:{itemTitle:"选项47",itemData:!0},4:{itemTitle:"选项46444",itemData:!0},5:{itemTitle:"选项49",itemData:!1},6:{itemTitle:"选项48",itemData:!1}}}},{formtype:"Money",title:"金额45454545",required:1,describe:"",inputvalue:"33",moneyType:"人民币4444"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落546546546</p>\n"},{formtype:"RadioBox",title:"单选框4565",required:1,describe:"",inputvalue:"on",setting:{radio:{0:{itemTitle:"选项145654",itemData:!1},1:{itemTitle:"选项65",itemData:!1},2:{itemTitle:"选项2456",itemData:!1},3:{itemTitle:"选项60765777",itemData:!0},4:{itemTitle:"选项5965",itemData:!1},5:{itemTitle:"选项64",itemData:!1},6:{itemTitle:"选项58",itemData:!1},7:{itemTitle:"选项34564564",itemData:!1},8:{itemTitle:"选项63676",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间54",required:1,describe:"456546",inputvalue:"2016-09-07 09:45",dateType:"年-月-日 时:分",dateTimeEnd:"2016-09-07 09:50"},{formtype:"FileComponent",title:"附件7657",required:1,describe:"657657",inputvalue:"",setting:{FileComponent:{0:{FileComponent:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">项目详情-进度.png</a></div><div class="filesize fl omit">7.37KB</div><div class="del fr">删除</div>'}}}},{formtype:"ImageComponent",title:"图片56567",required:1,describe:"",inputvalue:"",setting:{ImageComponent:{0:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">11974119.png</a></div><div class="filesize fl omit">5.64KB</div><div class="del fr">删除</div>'},1:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Hydrangeas - 副本.jpg</a></div><div class="filesize fl omit">581.33KB</div><div class="del fr">删除</div>'},2:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Hydrangeas.jpg</a></div><div class="filesize fl omit">581.33KB</div><div class="del fr">删除</div>'},3:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Koala - 副本.jpg</a></div><div class="filesize fl omit">762.53KB</div><div class="del fr">删除</div>'},4:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Koala.jpg</a></div><div class="filesize fl omit">762.53KB</div><div class="del fr">删除</div>'}}}},{formtype:"Email",title:"邮箱5676",required:1,describe:"",inputvalue:"456434@wer.com"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落567657657</p>\n"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落67657657</p>\n"},{formtype:"Employee",title:"用户选择567657",required:1,describe:"56765765765",setting:{Employee:{0:{itemName:"张三李四",itemId:"23"},1:{itemName:"张三李四",itemId:"23"},2:{itemName:"张三李四",itemId:"23"},3:{itemName:"张三李四",itemId:"23"},4:{itemName:"张三李四",itemId:"23"}}}},{formtype:"DividingLine",styleType:"solid"},{formtype:"Mobile",title:"手机657",required:1,describe:"567657",inputvalue:"13555555555"},{formtype:"RadioBox",title:"单选框311",required:1,describe:"456546546546",inputvalue:"on",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项25456456",itemData:!1},2:{itemTitle:"选项7464654",itemData:!0},3:{itemTitle:"选项73564",itemData:!1},4:{itemTitle:"选项72456",itemData:!1},5:{itemTitle:"选项71456",itemData:!1},6:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Department",title:"部门选择65765",required:1,describe:"657657657",setting:{Employee:{0:{itemName:"张三李四",itemId:"23"},1:{itemName:"张三李四",itemId:"23"}}}},{formtype:"CheckBox",title:"复选框q15",required:1,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项75",itemData:!0},1:{itemTitle:"选项82",itemData:!0},2:{itemTitle:"选项3",itemData:!0},3:{itemTitle:"选项81546546",itemData:!0},4:{itemTitle:"选项806456",itemData:!0}}}},{formtype:"Phone",title:"电话567",required:1,describe:"7567657",inputvalue:"2323555"},{formtype:"DividingLine",styleType:"solid"},{formtype:"DividingLine",styleType:"solid"},{formtype:"Email",title:"邮箱",required:1,describe:"67657657657",inputvalue:"32443@eer.com"},{formtype:"DateComponent",title:"日期56",required:1,describe:"5676576",inputvalue:"2016-09-06",dateType:"年-月-日"},{formtype:"NumberComponent",title:"数字输入框567",required:1,describe:"567657657657",inputvalue:"34"},{formtype:"DividingLine",styleType:"solid"},{formtype:"Employee",title:"用户选择2",required:1,describe:"567657657",setting:{Employee:{0:{itemName:"张三李四",itemId:"23"},1:{itemName:"张三李四",itemId:"23"},2:{itemName:"张三李四",itemId:"23"}}}},{formtype:"ImageComponent",title:"图片5",required:1,describe:"",inputvalue:"",setting:{ImageComponent:{0:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Hydrangeas - 副本.jpg</a></div><div class="filesize fl omit">581.33KB</div><div class="del fr">删除</div>'},1:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Hydrangeas.jpg</a></div><div class="filesize fl omit">581.33KB</div><div class="del fr">删除</div>'},2:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Koala.jpg</a></div><div class="filesize fl omit">762.53KB</div><div class="del fr">删除</div>'},3:{itemImgs:'<i class="poabso icon-img"></i><div class="filename fl omit"><a href="D:\\WWW\\oa222\\basic/../file/apply/20160907/">Koalawerwrwrewr.jpg</a></div><div class="filesize fl omit">762.53KB</div><div class="del fr">删除</div>'}}}},{formtype:"Select",title:"下拉菜单",required:1,describe:"567657657657657657657",setting:{select:{0:{itemTitle:"选项15",itemData:!1},1:{itemTitle:"选项68",itemData:!1},2:{itemTitle:"选项67",itemData:!1},3:{itemTitle:"选项66567657",itemData:!0},4:{itemTitle:"选项2567657",itemData:!1},5:{itemTitle:"选项7056",itemData:!1},6:{itemTitle:"选项69567",itemData:!1},7:{itemTitle:"选项3",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间5673",required:1,describe:"7567",inputvalue:"2016-09-06",dateType:"年-月-日",dateTimeEnd:"2016-09-28"},{formtype:"DateInterval",title:"日期区间567",required:1,describe:"5675",inputvalue:"2016-06",dateType:"年-月",dateTimeEnd:"2016-07"},{formtype:"TextArea",title:"多行文本框33",required:0,describe:"534543545454",inputvalue:"而违法是的范德萨的放&nbsp;而违法是的<br/>范德萨的放&nbsp;而违法是的范德萨的放&nbsp;而违法是的范德萨的放&nbsp;而违法是的范德萨的放&nbsp;而违法是的范德萨的放<br/>&nbsp;而违法是的范德萨的放&nbsp;而违法是的范德萨<br/>的放&nbsp;而违法是的范德萨的放&nbsp;而违法是的范德萨<br/>的放&nbsp;而违法是的范德萨的放&nbsp;而违法是的范<br/>德萨的放&nbsp;"},{formtype:"DateInterval",title:"日期区间67",required:1,describe:"",inputvalue:"2016-09-07 09:55",dateType:"年-月-日 时:分",dateTimeEnd:"2016-09-07 09:55"},{formtype:"DateInterval",title:"日期区间5",required:1,describe:"",inputvalue:"2016-08-30",dateType:"年-月-日",dateTimeEnd:"2016-09-06"},{formtype:"DateInterval",title:"日期区间56",required:1,describe:"",inputvalue:"2016-09-07 13",dateType:"年-月-日 时",dateTimeEnd:"2016-09-07 13"},{formtype:"DateInterval",title:"日期区间",required:1,describe:"",inputvalue:"2016-09",dateType:"年-月",dateTimeEnd:"2016-10"},{formtype:"RadioBox",title:"单选框",required:1,describe:"",inputvalue:"on",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项3",itemData:!0}}}}]},formshowfactory.formshow(apply.formshoweditdata,$compile,$scope,1),$scope.addFileBtn=function(Uploader,element){Uploader.url="/index.php?r=apply/apply/upload";for(var ele=element.parents(".borderbor").find("ul"),filenamelength=ele.find(".filesize"),fileaftersize=0,i=0;i<filenamelength.length;i++)fileaftersize+=parseFloat(filenamelength.eq(i).html().replace("KB",""));if(fileaftersize=fileaftersize.toFixed(2),element.parents(".borderbor").find(".none").html(fileaftersize),fileaftersize>51200)return alert("总文件大小已超过上限50MB!"),!1;var elesize=element.parents(".borderbor").find(".none").html();Uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){if(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),elesize=parseFloat(elesize)+parseFloat(response.data.data.file_size),elesize>51200)return alert("总文件大小超过50MB，已从上传队列中移除"),!1;var file_root=response.file_root,filefull_path=file_root+"/"+response.data.data.file_path+"/"+response.data.data.real_name,li='<li class="porela"><i class="poabso icon-'+response.data.data.file_type+'"></i><div class="filename fl omit"><a href="'+filefull_path+'" target="_blank">'+response.data.data.file_name+'</a></div><div class="filesize fl omit">'+response.data.data.file_size+'KB</div><div class="del fr">删除</div></li>';ele.append(li),element.parents(".borderbor").find(".none").html(elesize)}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},$(document).on("click",".borderbor .del",function(){$(this).parent().remove()}),$(".addbtn1.fpgbtn").click(function(){var lis=$(this).parent().find("ul"),li='<li class="porela"><div class="filename fl omit" data-member_id="23">张三李四</div><div class="del fr">删除</div></li>';lis.append(li),$("#masklayer1").show()}),$(".formsave").click(function(){if(formshowfactory.formshowsave(apply.formshoweditdata)){var showFormssave=new jQuery.showeditForm,result=showFormssave.saveForm();console.log(JSON.stringify(result))}})});
ApplyMod.controller("applyshowformdataCtrl",function($scope,$http,$rootScope,Publicfactory,applyModel,$timeout,formshowfactory,$compile){var apply=$scope.apply={};apply.formshowdata={title:"53454354354354",field:[{formtype:"CheckBox",title:"复选框567",required:1,describe:"56765765",inputvalue:"on",setting:{checkedMax:"5",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!0},2:{itemTitle:"选项4",itemData:!1},3:{itemTitle:"选项15",itemData:!0},4:{itemTitle:"选项14",itemData:!1},5:{itemTitle:"选项13",itemData:!1},6:{itemTitle:"选项12",itemData:!1},7:{itemTitle:"选项18",itemData:!1},8:{itemTitle:"选项17",itemData:!1},9:{itemTitle:"选项16",itemData:!1},10:{itemTitle:"选项11",itemData:!1},11:{itemTitle:"选项10",itemData:!1},12:{itemTitle:"选项9",itemData:!1},13:{itemTitle:"选项8",itemData:!1},14:{itemTitle:"选项7",itemData:!1},15:{itemTitle:"选项6",itemData:!1},16:{itemTitle:"选项20",itemData:!1},17:{itemTitle:"选项19666666",itemData:!1},18:{itemTitle:"选项23",itemData:!1},19:{itemTitle:"选项25",itemData:!1},20:{itemTitle:"选项24",itemData:!1},21:{itemTitle:"选项22",itemData:!1},22:{itemTitle:"选项21",itemData:!1}}}},{formtype:"CheckBox",title:"复选框",required:0,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项33",itemData:!1},3:{itemTitle:"选项26465465",itemData:!0},4:{itemTitle:"选项32",itemData:!1},5:{itemTitle:"选项31",itemData:!1},6:{itemTitle:"选项30",itemData:!1},7:{itemTitle:"选项29",itemData:!1},8:{itemTitle:"选项28",itemData:!1},9:{itemTitle:"选项27",itemData:!1},10:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Text",title:"文本输入框5464",required:1,describe:"54654654",inputvalue:"asdasd234"},{formtype:"CheckBox",title:"复选框4565",required:1,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项134535",itemData:!1},1:{itemTitle:"选项25345435",itemData:!0},2:{itemTitle:"选项5445",itemData:!0},3:{itemTitle:"选项53345345",itemData:!0},4:{itemTitle:"选项5243",itemData:!0},5:{itemTitle:"选项3",itemData:!0},6:{itemTitle:"选项56534",itemData:!1},7:{itemTitle:"选项5554",itemData:!1},8:{itemTitle:"选项57",itemData:!1}}}},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落456546546546454</p>\n"},{formtype:"FileComponent",title:"附件54",required:1,describe:"456456546",inputvalue:"",setting:{FileComponent:{0:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},1:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},2:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},3:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},4:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},5:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},6:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},7:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},8:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'}}}},{formtype:"CheckBox",title:"复选框54646",required:0,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项34",itemData:!1},2:{itemTitle:"选项45",itemData:!1},3:{itemTitle:"选项44",itemData:!1},4:{itemTitle:"选项43",itemData:!0},5:{itemTitle:"选项2",itemData:!1},6:{itemTitle:"选项42",itemData:!1},7:{itemTitle:"选项41",itemData:!1},8:{itemTitle:"选项40",itemData:!1}}}},{formtype:"CheckBox",title:"复选框5465",required:1,describe:"",inputvalue:"on",setting:{checkedMax:"45654",checkbox:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项32",itemData:!0},3:{itemTitle:"选项47",itemData:!1},4:{itemTitle:"选项46444",itemData:!1},5:{itemTitle:"选项49",itemData:!1},6:{itemTitle:"选项48",itemData:!1}}}},{formtype:"Money",title:"金额45454545",required:1,describe:"",inputvalue:"1233432",moneyType:"人民币4444"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落546546546</p>\n"},{formtype:"RadioBox",title:"单选框4565",required:1,describe:"",inputvalue:"on",setting:{radio:{0:{itemTitle:"选项145654",itemData:!1},1:{itemTitle:"选项65",itemData:!0},2:{itemTitle:"选项2456",itemData:!1},3:{itemTitle:"选项60765777",itemData:!1},4:{itemTitle:"选项5965",itemData:!1},5:{itemTitle:"选项64",itemData:!1},6:{itemTitle:"选项58",itemData:!1},7:{itemTitle:"选项34564564",itemData:!1},8:{itemTitle:"选项63676",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间54",required:1,describe:"456546",inputvalue:"2016-09-05 17:05",dateType:"年-月-日 时:分",dateTimeEnd:"2016-09-05 17:25"},{formtype:"FileComponent",title:"附件7657",required:1,describe:"657657",inputvalue:"",setting:{FileComponent:{0:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},1:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},2:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},3:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},4:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},5:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},6:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},7:{FileComponent:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'}}}},{formtype:"ImageComponent",title:"图片56567",required:1,describe:"",inputvalue:"",setting:{ImageComponent:{0:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},1:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},2:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},3:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},4:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},5:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},6:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'}}}},{formtype:"Email",title:"邮箱5676",required:1,describe:"",inputvalue:"wsdfas@12.com"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落567657657</p>\n"},{formtype:"Paragraph",styleType:"alert-success",content:"<p>空白段落67657657</p>\n"},{formtype:"Employee",title:"用户选择567657",required:1,describe:"56765765765",setting:{Employee:{0:{itemName:"张三李四",itemId:"23"},1:{itemName:"张三李四",itemId:"23"},2:{itemName:"张三李四",itemId:"23"},3:{itemName:"张三李四",itemId:"23"},4:{itemName:"张三李四",itemId:"23"},5:{itemName:"张三李四",itemId:"23"},6:{itemName:"张三李四",itemId:"23"},7:{itemName:"张三李四",itemId:"23"},8:{itemName:"张三李四",itemId:"23"},9:{itemName:"张三李四",itemId:"23"},10:{itemName:"张三李四",itemId:"23"},11:{itemName:"张三李四",itemId:"23"},12:{itemName:"张三李四",itemId:"23"},13:{itemName:"张三李四",itemId:"23"},14:{itemName:"张三李四",itemId:"23"},15:{itemName:"张三李四",itemId:"23"},16:{itemName:"张三李四",itemId:"23"}}}},{formtype:"DividingLine",styleType:"solid"},{formtype:"Mobile",title:"手机657",required:1,describe:"567657",inputvalue:"15202515441"},{formtype:"RadioBox",title:"单选框311",required:1,describe:"456546546546",inputvalue:"on",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项25456456",itemData:!1},2:{itemTitle:"选项7464654",itemData:!0},3:{itemTitle:"选项73564",itemData:!1},4:{itemTitle:"选项72456",itemData:!1},5:{itemTitle:"选项71456",itemData:!1},6:{itemTitle:"选项3",itemData:!1}}}},{formtype:"Department",title:"部门选择65765",required:1,describe:"657657657",setting:{Employee:{0:{itemName:"张三李四",itemId:"23"},1:{itemName:"张三李四",itemId:"23"},2:{itemName:"张三李四",itemId:"23"},3:{itemName:"张三李四",itemId:"23"},4:{itemName:"张三李四",itemId:"23"},5:{itemName:"张三李四",itemId:"23"},6:{itemName:"张三李四",itemId:"23"},7:{itemName:"张三李四",itemId:"23"},8:{itemName:"张三李四",itemId:"23"},9:{itemName:"张三李四",itemId:"23"},10:{itemName:"张三李四",itemId:"23"},11:{itemName:"张三李四",itemId:"23"},12:{itemName:"张三李四",itemId:"23"},13:{itemName:"张三李四",itemId:"23"},14:{itemName:"张三李四",itemId:"23"},15:{itemName:"张三李四",itemId:"23"},16:{itemName:"张三李四",itemId:"23"},17:{itemName:"张三李四",itemId:"23"},18:{itemName:"张三李四",itemId:"23"},19:{itemName:"张三李四",itemId:"23"},20:{itemName:"张三李四",itemId:"23"},21:{itemName:"张三李四",itemId:"23"},22:{itemName:"张三李四",itemId:"23"},23:{itemName:"张三李四",itemId:"23"},24:{itemName:"张三李四",itemId:"23"},25:{itemName:"张三李四",itemId:"23"}}}},{formtype:"CheckBox",title:"复选框q15",required:1,describe:"",inputvalue:"on",setting:{checkedMax:"",checkbox:{0:{itemTitle:"选项75",itemData:!1},1:{itemTitle:"选项82",itemData:!0},2:{itemTitle:"选项3",itemData:!1},3:{itemTitle:"选项81546546",itemData:!0},4:{itemTitle:"选项806456",itemData:!1}}}},{formtype:"Phone",title:"电话567",required:1,describe:"7567657",inputvalue:"3333333"},{formtype:"DividingLine",styleType:"solid"},{formtype:"DividingLine",styleType:"solid"},{formtype:"Email",title:"邮箱",required:1,describe:"67657657657",inputvalue:"wsdfas@12.com"},{formtype:"DateComponent",title:"日期56",required:1,describe:"5676576",inputvalue:"2016-09-05",dateType:"年-月-日"},{formtype:"NumberComponent",title:"数字输入框567",required:1,describe:"567657657657",inputvalue:"22"},{formtype:"DividingLine",styleType:"solid"},{formtype:"Employee",title:"用户选择2",required:1,describe:"567657657",setting:{Employee:{0:{itemName:"张三李四",itemId:"23"},1:{itemName:"张三李四",itemId:"23"},2:{itemName:"张三李四",itemId:"23"},3:{itemName:"张三李四",itemId:"23"},4:{itemName:"张三李四",itemId:"23"},5:{itemName:"张三李四",itemId:"23"},6:{itemName:"张三李四",itemId:"23"},7:{itemName:"张三李四",itemId:"23"},8:{itemName:"张三李四",itemId:"23"},9:{itemName:"张三李四",itemId:"23"},10:{itemName:"张三李四",itemId:"23"},11:{itemName:"张三李四",itemId:"23"},12:{itemName:"张三李四",itemId:"23"},13:{itemName:"张三李四",itemId:"23"},14:{itemName:"张三李四",itemId:"23"}}}},{formtype:"ImageComponent",title:"图片5",required:1,describe:"",inputvalue:"",setting:{ImageComponent:{0:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},1:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},2:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},3:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'},4:{itemImgs:'<i class="poabso filesiconmin"></i><div class="filename fl omit"><a href="#">产品功能文档.pdf</a></div><div class="filesize fl omit">12.18KB</div><div class="del fr">删除</div>'}}}},{formtype:"Select",title:"下拉菜单",required:1,describe:"567657657657657657657",setting:{select:{0:{itemTitle:"选项15",itemData:!1},1:{itemTitle:"选项68",itemData:!1},2:{itemTitle:"选项67",itemData:!1},3:{itemTitle:"选项66567657",itemData:!0},4:{itemTitle:"选项2567657",itemData:!1},5:{itemTitle:"选项7056",itemData:!1},6:{itemTitle:"选项69567",itemData:!1},7:{itemTitle:"选项3",itemData:!1}}}},{formtype:"DateInterval",title:"日期区间5673",required:1,describe:"7567",inputvalue:"2016-09-06",dateType:"年-月-日",dateTimeEnd:"2016-09-22"},{formtype:"DateInterval",title:"日期区间567",required:1,describe:"5675",inputvalue:"2016-06",dateType:"年-月",dateTimeEnd:"2016-11"},{formtype:"TextArea",title:"多行文本框33",required:0,describe:"534543545454",inputvalue:"ssasas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的asas3423232342的身份ds<br/>df&nbsp;<br/>dsdsf&nbsp;<br/>&nbsp;"},{formtype:"DateInterval",title:"日期区间67",required:1,describe:"",inputvalue:"2016-09-05 17:05",dateType:"年-月-日 时:分",dateTimeEnd:"2016-09-05 17:55"},{formtype:"DateInterval",title:"日期区间5",required:1,describe:"",inputvalue:"2016-09-08",dateType:"年-月-日",dateTimeEnd:"2016-09-22"},{formtype:"DateInterval",title:"日期区间56",required:1,describe:"",inputvalue:"2016-09-05 17",dateType:"年-月-日 时",dateTimeEnd:"2016-09-05 18"},{formtype:"DateInterval",title:"日期区间",required:1,describe:"",inputvalue:"2016-09",dateType:"年-月",dateTimeEnd:"2016-10"},{formtype:"RadioBox",title:"单选框",required:1,describe:"",inputvalue:"on",setting:{radio:{0:{itemTitle:"选项1",itemData:!1},1:{itemTitle:"选项2",itemData:!1},2:{itemTitle:"选项3",itemData:!0}}}}]},formshowfactory.formshow(apply.formshowdata,$compile,$scope,0)});
ApplyMod.controller("MyApplyListController",function($scope,$http,$state,$rootScope,$stateParams,Publicfactory,applyModel,leaveApplyModel,noticeModel,filtersModel,checkModel,formshowfactory,permissionService){if(!permissionService.checkPermission("ApplyMyapply"))return $state.go("main.index",{},{reload:!1}),!1;$scope.isMine=!0;var apply=$scope.apply={};apply.myDate=new Date;var applyParams=$scope.applyParams={};applyParams.status=-1,applyParams.model_id=0,applyParams.begin="",applyParams.end="",applyParams.detailRankPagePopup=!1,applyParams.page=1,apply.curTime=apply.myDate.valueOf(),apply.rankPopup=!1,apply.rankEditPopup=!1,apply.rankApplyDesc="",apply.rankFiles=[],apply.drainPopup=!1,apply.drainDetailPopup=!1,apply.drainDesc="",apply.drainCheckAm=!1,apply.drainCheckPm=!1,apply.beginTime="",apply.drainPunchInfo={},apply.flexibleWorkPopup=!1,apply.flexibleDetailWorkPopup=!1,apply.is_am=1,$scope.att=[],apply.file_root="",$scope.page={curPage:1,tempcurPage:1,sumPage:0},apply.arrStatus=[{text:"状态",value:-1},{text:"待审批",value:0},{text:"已审批",value:1},{text:"已拒绝",value:2},{text:"已撤回",value:3}],apply.isStatusWin=!1,apply.statusWinButton=function(){$("#applyType").hide(),angular.element("#projectInfo").is(":hidden")?angular.element("#projectInfo").show():angular.element("#projectInfo").hide()},apply.selectSearchStatus=function(status){applyParams.status=status,angular.element.each(apply.arrStatus,function(key,val){val.value==status&&angular.element("#status").html(val.text)}),apply.isStatusWin=!1,angular.element("#projectInfo").hide()},apply.modelList=[],applyModel.getApplyModel($scope),apply.modelWinButton=function(){$("#projectInfo").hide(),angular.element("#applyType").is(":hidden")?angular.element("#applyType").show():angular.element("#applyType").hide()},apply.selectSearchModel=function(modelId){applyParams.model_id=modelId,angular.element.each(apply.modelList,function(key,val){val.model_id==modelId&&angular.element("#model").html(val.title)}),apply.isModelWin=!1,angular.element("#applyType").hide()},applyModel.getMyApplyList($scope),apply.search=function(){$scope.page={curPage:1,tempcurPage:1,sumPage:0},$scope.applyParams.page=1,applyModel.getMyApplyList($scope)},$scope.page_fun=function(){$scope.applyParams.page=$scope.page.tempcurPage,applyModel.getMyApplyList($scope)},apply.delApplyId=0,apply.delApply=function(apply_id){apply.delApplyId=apply_id,apply.showDelWin=!0,$("#masklayer2").show()},apply.doDel=function(){applyModel.delApply(apply.delApplyId,$scope),apply.showDelWin=!1,apply.overtimeShowWin=!1,apply.drainDetailPopup=!1,apply.flexibleDetailWorkPopup=!1,apply.rankPopup=!1,apply.customShowWin=!1,apply.isLeaveDetailApplyWin=!1},apply.revokeApplyId=0,apply.revoke=function(apply_id){apply.revokeApplyId=apply_id,apply.showRevokeWin=!0,$("#masklayer1").show()},apply.revokeRbtn=function(apply_id){apply.revokeApplyId=apply_id,apply.showRevokeWinRbtn=!0,$("#masklayer1").show()},apply.doRevoke=function(){applyModel.revoke(apply.revokeApplyId,$scope),apply.rankPopup=!1,apply.showRevokeWin=!1,apply.drainDetailPopup=!1,apply.overtimeShowWin=!1,apply.flexibleDetailWorkPopup=!1,apply.customShowWin=!1,apply.showRevokeWin=!1,apply.isLeaveDetailApplyWin=!1,apply.showRevokeWinRbtn=!1,$("#masklayer1,#masklayer2").hide()},apply.press=function(apply_id){applyModel.press(apply_id,$scope),apply.showRevokeWin=!1,apply.showDelWin=!1,apply.overtimeShowWin=!1,apply.drainDetailPopup=!1,apply.flexibleDetailWorkPopup=!1,apply.rankPopup=!1,apply.customShowWin=!1,apply.isLeaveDetailApplyWin=!1};var applyEditParam=$scope.applyEditParam={};applyEditParam.apply_id=0,apply.editApply=function(apply_id,model_id){if($("#masklayer1").show(),2==model_id)leave_apply.apply_id=apply_id,leaveApplyModel.getLeaveApplyType($scope),leaveApplyModel.getLeaveApplyDetail($scope,!0);else switch(applyModel.applyDetail($scope,apply_id,1),applyEditParam=$scope.applyEditParam={},applyEditParam.apply_id=apply_id,model_id=parseInt(model_id)){case 1:apply.overtimeShowEditWin=!0,apply.overtimeShowWin=!1;break;case 3:apply.drainPopup=!0;break;case 4:apply.flexibleWorkPopup=!0;break;case 5:apply.rankEditPopup=!0;break;default:apply.customShowEditWin=!0,apply.customShowWin=!1,callback()}},apply.detailApply=function(apply_id,model_id){if($("#masklayer1").show(),2==model_id)leave_apply.apply_id=apply_id,leaveApplyModel.getLeaveApplyDetail($scope,!1);else switch(applyModel.applyDetail($scope,apply_id,0),applyEditParam.apply_id=apply_id,model_id){case 1:apply.overtimeShowWin=!0;break;case 3:apply.drainDetailPopup=!0;break;case 4:apply.flexibleDetailWorkPopup=!0;break;case 5:apply.rankPopup=!0;break;default:apply.customShowWin=!0}},apply.customHideWin=function(){$("#masklayer1").hide(),apply.showRevokeWin=!1},apply.editSubmit=function(){if(applyEditParam.type=apply.detail.data.type,applyEditParam.note=apply.detail.data.note,applyEditParam.currentDay=apply.detail.data.currentDay,applyEditParam.isNextDay=apply.detail.data.isNextDay,applyEditParam.begin_time_str=apply.detail.data.begin_time_str,applyEditParam.end_time_str=apply.detail.data.end_time_str,0==applyEditParam.type)return void alert("请选择加班类型");if(""==applyEditParam.currentDay||""==applyEditParam.begin_time_str||""==applyEditParam.end_time_str)return void alert("请选择加班开始结束时间");var beginDateStr=filtersModel.filterDateTime(applyEditParam.currentDay).replace(/(00:00)/,applyEditParam.begin_time_str),endDateStr=filtersModel.filterDateTime(applyEditParam.currentDay).replace(/(00:00)/,applyEditParam.end_time_str),bDate=new Date(Date.parse(beginDateStr)),eDate=new Date(Date.parse(endDateStr));if(bDate>eDate&&!applyEditParam.isNextDay)return void alert("同一天加班开始时间不可大于结束时间");if(applyEditParam.isNextDay&&applyEditParam.end_time_str>"06:00")return void alert("加班跨天，结束时间必须小于次日06:00");var callBack=function(){apply.overtimeShowEditWin=!1};return""==applyEditParam.note?void alert("请填写加班工作说明"):Publicfactory.checkEnCnstrlen(applyEditParam.note)>200?(alert("工作说明必须100字以内"),!1):(applyEditParam.currentDay=filtersModel.filterTime(applyEditParam.currentDay),void applyModel.applyEdit($scope,callBack))};var closeWin=function(){apply.customShowEditWin=!1};apply.abc=function(){var group=$scope.group={};$scope.selectedMembers=[],$scope.selectedDeparts=[],group.memberdialog=!1;var fields="",currentType="";$scope.att=[],$scope.addFileBtn=function(Uploader,element){Uploader.url="/index.php?r=apply/apply/upload";for(var ele=element.parents(".borderbor").find("ul"),filenamelength=ele.find(".filesize"),fileaftersize=0,i=0;i<filenamelength.length;i++)fileaftersize+=parseFloat(filenamelength.eq(i).html().replace("KB",""));if(fileaftersize=fileaftersize.toFixed(2),element.parents(".borderbor").find(".none").html(fileaftersize),fileaftersize>51200)return alert("总文件大小已超过上限50MB!"),!1;var elesize=element.parents(".borderbor").find(".none").html();Uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){if(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),elesize=parseFloat(elesize)+parseFloat(response.data.data.file_size),elesize>51200)return alert("总文件大小超过50MB，已从上传队列中移除"),!1;var file_root=response.file_root,filefull_path=file_root+"/"+response.data.data.file_path+"/"+response.data.data.real_name,li='<li class="porela"><i class="poabso icon-'+response.data.data.file_type+'"></i><div class="filename fl omit"><a href="'+filefull_path+'" target="_blank">'+response.data.data.file_name+'</a></div><div class="filesize fl omit">'+response.data.data.file_size+'KB</div><div class="del fr">删除</div></li>';ele.append(li),element.parents(".borderbor").find(".none").html(elesize)}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},$(document).on("click",".borderbor .del",function(){$(this).parent().remove();var id=$(this).parent().find(".filename").attr("data-member_id");$scope.selectedMembers.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedMembers.splice(index,1)}),$scope.selectedDeparts.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedDeparts.splice(index,1)})}),$scope.addgroup=function($event,index){$("#masklayer2").show(),fields=angular.element($event.target).attr("id"),currentType=index,0==index?group.departDialogVisble=!0:group.memberDialogVisble=!0},$scope.lishtml=function(i,value,label){var li='<li class="porela"><div class="filename fl omit" data-member_id="'+value+'">'+label+'</div><div class="del fr">删除</div></li>';return li},$scope.cancels=function(index){var index=fields;group.memberDialogVisble=!1,$("#masklayer2").hide();var lis=$("#formpresentation_edit .borderbor").eq(index).find("ul"),targetArray=currentType?$scope.selectedMembers:$scope.selectedDeparts;if(lis.find("li").length<=0)for(var i=0;i<targetArray.length;i++)lis.append($scope.lishtml(i,targetArray[i].value,targetArray[i].label));else{var currentSelectArray=[],selectedArray=[];lis.find("li").each(function(iArray){currentSelectArray.push(parseInt(lis.find("li").eq(iArray).find(".filename").attr("data-member_id")))}),targetArray.forEach(function(item){selectedArray.push({value:parseInt(item.value),label:item.label})}),currentSelectArray=currentSelectArray.sort(function(prev,next){return next-prev}),selectedArray=selectedArray.sort(function(prev,next){return next-prev}),selectedArray.forEach(function(item,index){currentSelectArray.indexOf(item.value)==-1&&lis.append($scope.lishtml(void 0,item.value,item.label))})}}},apply.abc();var callback=function(){$(".formsave").click(function(){if(formshowfactory.formshowsave(JSON.parse($scope.apply.detail.form_json))){var showFormssave=new jQuery.showeditForm,result=showFormssave.saveForm();$scope.applyEditParam=result,$scope.applyEditParam.apply_id=applyEditParam.apply_id,applyModel.applyEdit($scope,closeWin)}})},leave_apply=$scope.leave_apply={},apply_param=$scope.apply_param={};apply_param.apply_id="",apply_param.type="",apply_param.begin_time="",apply_param.end_time="",apply_param.leave_sum="",apply_param.content="",apply_param.att="",leave_apply.apply_id="",leave_apply.leaveApplyInfo="",leave_apply.typestr="",leave_apply.isLeaveEditApplyWin=!1,apply.isLeaveDetailApplyWin=!1,apply.isDetailBtn=!1,apply.leaveType=[],apply.typeSum="",leave_apply.getLeaveApplyTypeSum=function(){apply.typeSum.sum1="",apply.typeSum.sum2="",apply.typeSum.sum3="",1!=apply_param.type&&2!=apply_param.type&&3!=apply_param.type||leaveApplyModel.getLeaveApplyTypeSum($scope)},leave_apply.saveLeaveApplyBtn=function(){return reg=/^[0-9]\d*(\.\d+)?$/,reg.test(apply_param.leave_sum)?10*apply_param.leave_sum%5!=0?(alert("休假必须以0.5天为最小单位！"),!1):checkModel.checkStrLen(apply_param.content)>200?(alert("详细说明必须100字以内"),!1):(apply_param.att=$scope.att,void leaveApplyModel.editLeaveApply($scope)):(alert("请输入正确的休假天数！"),!1)},leave_apply.closeEditLeaveApplyBtn=function(){leaveApplyModel.closeEditLeaveApply($scope),$("#masklayer1").hide()},apply.downFileBtn=function(obj){noticeModel.fileDownload($scope,obj.file_path,obj.real_name,obj.file_name)},$scope.addAttBtn=function(Uploader){Uploader.url="/index.php?r=apply/apply/upload",Uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),$scope.att.push(response.data.data),apply.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFileBtn=function(index){$scope.att.splice(index,1)},apply.rankApplySubmit=function(){},apply.addRankFileBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),apply.rankFiles.push(response.data.data),apply.file_root=response.file_root,applyEditParam.att=apply.rankFiles):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.rankDelFiles=function(index){apply.rankFiles.splice(index,1)},apply.rankEditSubmit=function(){var applyEditCancel=function(){apply.rankEditPopup=!1,$("#masklayer1").hide()};return applyEditParam.note=$scope.apply.rankApplyDesc,void 0==apply.rankApplyDesc||0==apply.rankApplyDesc.length?void alert("请输入职级申请内容！"):void 0!=apply.rankApplyDesc&&Publicfactory.checkEnCnstrlen(apply.rankApplyDesc)>1e3?(alert("职级申请内容不能超过500字！"),!1):0==apply.rankFiles.length?(alert("请添加附件！"),!1):void applyModel.applyEdit($scope,applyEditCancel)},apply.editPopupCtr=function(popupStatus){switch(popupStatus){case"3":apply.drainPopup=!1,apply.drainDetailPopup=!1;break;case"5":apply.rankEditPopup=!1,apply.rankPopup=!1;break;case"6":apply.rankPopup=!1,apply.rankEditPopup=!0;break;case"7":apply.drainPopup=!0,apply.drainDetailPopup=!1;break;case"8":apply.flexibleDetailWorkPopup=!1,apply.flexibleWorkPopup=!0;break;case"9":apply.flexibleDetailWorkPopup=!1,apply.flexibleWorkPopup=!1}},apply.drainTimePoint=function(timePoint){apply.is_am=timePoint},apply.drainPunchSub=function(){if(apply.drainDesc=$scope.apply.drainDesc,0==apply.drainDesc.length||Publicfactory.checkEnCnstrlen(apply.drainDesc)>200)return void alert("请输入忘打卡说明,且最多只能输入100个字！");var applyEditCancel=function(){apply.drainPopup=!1,$("#masklayer1").hide()};return apply.beginTime>apply.curTime?void alert("忘打卡时间超期，请从新选择！"):(applyEditParam.note=apply.drainDesc,applyEditParam.is_am=apply.is_am,applyEditParam.check_date=$scope.apply.beginTime,console.log(applyEditParam.check_date),void applyModel.applyEdit($scope,applyEditCancel))},apply.editPopup=!1,apply.timePoint=[],apply.beginTime=apply.myDate.valueOf(),apply.endTime=apply.myDate.valueOf(),apply.workTimePoint="",apply.desc="",apply.files=[],apply.info={},apply.id="",$scope.att=[],$scope.addFlexibleBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),apply.files.push(response.data.data),apply.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFlexibleFiles=function(index){apply.files.splice(index,1)},apply.submitFlexibleWorkInfo=function(){if(apply.desc=$scope.apply.desc,applyEditParam.begin_time=Date.parse(new Date($scope.apply.beginTime))/1e3,applyEditParam.end_time=Date.parse(new Date($scope.apply.endTime))/1e3,applyEditParam.store_id=$scope.apply.flexibleWork.id,applyEditParam.att=apply.files,applyEditParam.note=apply.desc,applyEditParam.store_id<=0)return void alert("请选择需抵用的加班时间!");if(applyEditParam.begin_time>=applyEditParam.end_time)return void alert("申请结束时间不能大于等于开始时间，请重新选择！");if(0==apply.desc.length||Publicfactory.checkEnCnstrlen(apply.desc)>200)return alert("请输入详细说明,且最多只能输入100个字！"),!1;var flexibleWork=function(){apply.flexibleWorkPopup=!1};applyModel.applyEdit($scope,flexibleWork),$("#masklayer1").hide(),apply.flexibleWorkPopup=!1},parseInt($stateParams.apply_id)&&parseInt($stateParams.model_id)&&apply.detailApply($stateParams.apply_id,parseInt($stateParams.model_id)),angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor").length&&angular.element(".selectbor  ul").hide()}),angular.element(".selecttimebor").bind("click",function(event){$(".selectbor ul").hide()}),apply.showmask=function(){$("#masklayer2").show()},apply.hidemask=function(){$("#masklayer2").hide()},apply.chehuihidemask=function(){$("#masklayer1").hide()}});
ApplyMod.controller("rankApplyCtrl",function($scope,$http,checkModel,applyModel,Publicfactory){var rank=$scope.rankApply={};$scope.att={},rank.rankApplyDesc="",$scope.apply_param={},rank.files=[],rank.modelId=5,rank.file_root="",$("#masklayer1").show(),$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){rank.files.push(response.data.data);for(var isRepeated,result=[],len=rank.files.length,i=0;i<len;i++){isRepeated=!1;for(var resultLen=result.length,j=0;j<resultLen;j++)if(rank.files[i].file_name==result[j].file_name){isRepeated=!0;break}isRepeated||result.push(rank.files[i])}rank.files=result,rank.file_root=response.file_root}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},rank.delFiles=function(index){rank.files.splice(index,1)},rank.submitRankInfo=function(){return rank.rankApplyDesc=$scope.rankApply.rankApplyDesc,rank.rankApplyDesc.length<=0||Publicfactory.checkEnCnstrlen(rank.rankApplyDesc)>1e3?(alert("请输入内容,且不能超过500字！"),!1):rank.files.length<=0?(alert("请上传附件！"),!1):($scope.apply_param.model_id=rank.modelId,$scope.apply_param.att=rank.files,$scope.apply_param.note=rank.rankApplyDesc,applyModel.createApply($scope),void 0)}});
ApplyMod.controller("drainPunchCtrl",function($scope,$http,applyModel,$timeout,Publicfactory){var drain=$scope.drainPunch={};$scope.apply_param={},drain.myDate=new Date,drain.beginTime=drain.myDate.getFullYear()+"-"+(drain.myDate.getMonth()+1)+"-"+drain.myDate.getDate(),drain.curTime=drain.myDate.valueOf(),drain.desc="",drain.is_am="1",drain.note="",$("#masklayer1").show(),drain.drainTimePoint=function(timePoint){drain.is_am=timePoint},drain.drainPunch=function(){if(drain.beginTime=$scope.drainPunch.beginTime,drain.desc=$scope.drainPunch.desc,drain.beginTime>drain.curTime)return void alert("忘打卡时间超期，请重新选择！");if(drain.is_am.length<=0)return void alert("请选择上午还是下午忘打卡！");if(drain.desc.length<=0)return void alert("请输入忘打卡说明！");if(""!=drain.desc.YLstringcheck()){if(Publicfactory.checkEnCnstrlen(drain.desc)>200)return alert("忘打卡说明长度不能大于100个字"),!1;$scope.apply_param.check_date=$scope.drainPunch.beginTime,$scope.apply_param.note=drain.desc,$scope.apply_param.is_am=drain.is_am,$scope.apply_param.model_id=3,applyModel.createApply($scope)}}});
ApplyMod.controller("ApplyAppController",function($scope,$http,$state,$rootScope,Publicfactory,applyModel,permissionService){if(!permissionService.checkPermission("ApplyApply"))return $state.go("main.index",{},{reload:!1}),!1;$scope.applyApp={};applyModel.getUsefulModel($scope)});
ApplyMod.controller("ApplyModelListController",function($scope,$http,$rootScope,Publicfactory,applyModel,applySetModel){var model=$scope.model={},modelParam=$scope.modelParam={};$scope.modelid=1,$scope.modeltype=2,applyModel.getAllModel($scope),modelParam.modelId=0,modelParam.title="",model.editTitlePop=function(modelId,oldTitle){model.showTitleWin=!0,modelParam.modelId=modelId,modelParam.title=oldTitle,model.showMask()},model.doEditTitle=function(){if(""==modelParam.title)return alert("请填写标题"),!1;if(""==modelParam.title.YLstringcheck())return alert("标题不能为空！"),!1;var patt=/[^\u4e00-\u9fa5a-zA-Z\d]/g;return modelParam.title.YLstringcheck().match(patt)?(alert("表单标题只能包含中文、字母、数字"),!1):Publicfactory.checkEnCnstrlen(modelParam.title)>40?(alert("请填写标题不能超过20个汉字"),!1):(applyModel.editTitle(modelParam.modelId,modelParam.title,$scope),model.showTitleWin=!1,model.closeMask(),void 0)},model.stopModelPop=function(modelId,name){model.showStopWin=!0,modelParam.modelId=modelId,model.tipTitle=name,model.showMask()},model.doStop=function(){applyModel.doStop(modelParam.modelId,0,$scope),model.showStopWin=!1,model.closeMask()},model.turnOnModel=function(modelId){applyModel.doStop(modelId,1,$scope)},model.delModelPop=function(modelId,name){model.showDelWin=!0,modelParam.modelId=modelId,model.tipTitle=name,model.showMask()},model.doDel=function(){applyModel.doDel(modelParam.modelId,$scope),model.showDelWin=!1,model.closeMask()},model.tabSwitch=function($event,status){var target=angular.element($event.target);target.addClass("selected"),0==status?(target.next().removeClass("selected"),target.parents(".ui-widget-winbor").find(".scrollbor").eq(0).show(),target.parents(".ui-widget-winbor").find(".scrollbor").eq(1).removeClass("block")):($scope.status=1,target.prev().removeClass("selected"),target.parents(".ui-widget-winbor").find(".scrollbor").eq(1).addClass("block"),target.parents(".ui-widget-winbor").find(".scrollbor").eq(0).hide())},model.showMask=function(model_id,model_type){var _tempStatus=new Date;$scope.status=_tempStatus.getTime(),$scope.modelid=model_id,$scope.modeltype=model_type,$("#masklayer1").show()},model.closeMask=function(modeltype){$scope.status=0,$("#masklayer1").hide();var target=angular.element("#formpresentation .changebtn span");0==modeltype&&(target.eq(0).addClass("selected"),target.eq(1).removeClass("selected"),angular.element("#formpresentation .scrollbor").eq(0).show(),angular.element("#formpresentation .scrollbor").eq(1).removeClass("block"))},model.derectiveParam=0,model.customerformshow=function(model_id){angular.element("#scroll").html(""),model.customerform=!0,applySetModel.showModel($scope,model_id)}});
ApplyMod.controller("LeaveApplyCreateCtrl",function($scope,$http,$rootScope,Publicfactory,applyModel,$timeout,checkModel,leaveApplyModel,FileUploader,$state){var apply=$scope.apply={},apply_param=$scope.apply_param={};apply_param.model_id=2,apply_param.type="",apply_param.begin_time="",apply_param.end_time="",apply_param.leave_sum="",apply_param.content="",apply_param.att=[],apply.leaveType="",apply.typeSum="",$scope.att=[],apply.file_root="",$("#masklayer1").show(),leaveApplyModel.getLeaveApplyType($scope),apply.getLeaveApplyTypeSum=function(){1!=apply_param.type&&2!=apply_param.type&&3!=apply_param.type||(apply.typeSum="",leaveApplyModel.getLeaveApplyTypeSum($scope))},$scope.addAttBtn=function(Uploader){Uploader.url="/index.php?r=apply/apply/upload",Uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?($scope.att.push(response.data.data),apply.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFileBtn=function(index){$scope.att.splice(index,1)},apply.saveLeaveApplyBtn=function(){return reg=/^[0-9]\d*(\.\d+)?$/,reg.test(apply_param.leave_sum)?apply_param.leave_sum<=0?(alert("请输入正确的休假天数！"),!1):10*apply_param.leave_sum%5!=0?(alert("休假必须以0.5天为最小单位！"),!1):(apply_param.att=$scope.att,checkModel.checkStrLen(apply_param.content)>200?void alert("详细说明必须100字以内"):void leaveApplyModel.createLeaveApply($scope)):(alert("请输入正确的休假天数！"),!1)},apply.cancelBtn=function(){$state.go("^"),$("#masklayer1").hide()}});
ApplyMod.controller("AgentApplyListController",function($scope,$http,$state,$rootScope,$stateParams,Publicfactory,applyModel,leaveApplyModel,noticeModel,permissionService){if(!permissionService.checkPermission("ApplyMyapprove"))return $state.go("main.index",{},{reaload:!1}),!1;$scope.isAgent=!0;var apply=$scope.apply={},applyParams=$scope.applyParams={},apply_approve=$scope.apply_approve={};apply.tempDay="",apply.status=0,apply.rankDetail=[],apply.rankLevel="",applyParams.status=0,applyParams.model_id=0,applyParams.begin="",applyParams.end="",applyParams.serach="",apply.apply_id="",apply.rankDetailPopup=!1,apply.drainPunchPopup=!1,apply.showVieryRankPopup=!1,apply.showRefuseRankPopup=!1,apply.showVieryLastRankPopup=!1,apply.showVieryDrainPopup=!1,apply.showRefuseDrainPopup=!1,apply.flexibleWorkPopup=!1,apply.flexibleWorkDetailList=[],apply.flexibleWorkVieryPopup=!1,apply.flexibleWorkRefusePopup=!1,applyParams.page=1,$scope.att=[],apply.file_root="",apply.showVieryWin=!1,apply.showRefuseWin=!1,apply.batchResWin=!1,apply.level_rank="",apply.comment="",apply.score=0,apply.isOvertimeLastStepWin=!1,apply.modeltype="",apply_approve.apply_id="",apply_approve.comment="",apply_approve.leave_sum="",apply_approve.real_hours="",apply_approve.begin_time="",apply_approve.end_time="",$scope.page={curPage:1,tempcurPage:1,sumPage:0},apply.arrStatus=[{text:"待审批",value:0},{text:"已审批",value:1},{text:"已拒绝",value:2}],apply.isStatusWin=!1,apply.statusWinButton=function(){$("#applyType").hide(),angular.element("#projectInfo").is(":hidden")?angular.element("#projectInfo").show():angular.element("#projectInfo").hide()},apply.selectSearchStatus=function(status){applyParams.status=status,angular.element.each(apply.arrStatus,function(key,val){val.value==status&&angular.element("#status").html(val.text)}),apply.isStatusWin=!1,angular.element("#projectInfo").hide()},apply.modelList=[],applyModel.getApplyModel($scope),apply.modelWinButton=function(){$("#projectInfo").hide(),angular.element("#applyType").is(":hidden")?angular.element("#applyType").show():angular.element("#applyType").hide()},apply.selectSearchModel=function(modelId){applyParams.model_id=modelId,angular.element.each(apply.modelList,function(key,val){val.model_id==modelId&&angular.element("#model").html(val.title)}),apply.isModelWin=!1,$("#applyType").hide()},applyModel.getMyAgentList($scope),apply.selected=[],apply.selectAll=function($event){apply.selected=[];var checkbox=$event.target;checkbox.checked&&angular.forEach(apply.list,function(tmpObj){tmpObj.allowBatch&&apply.selected.push(parseInt(tmpObj.apply_id))})},apply.clearAll=function(){angular.element("#selectAll").prop("checked",!1),apply.selected=[]},apply.updateSelected=function(action,id){var id=parseInt(id);if("add"==action&&apply.selected.indexOf(id)==-1&&apply.selected.push(id),"remove"==action&&apply.selected.indexOf(id)!=-1){var idx=apply.selected.indexOf(id);apply.selected.splice(idx,1)}},apply.updateSelection=function($event,id){var id=parseInt(id),checkbox=$event.target,action=checkbox.checked?"add":"remove";apply.updateSelected(action,id)},apply.isSelected=function(id){var id=parseInt(id);return apply.selected.indexOf(id)>=0},apply.clickBatchVerify=function(){var checkeds=$(".applytablelistbor li .checkbox:checked").length;return checkeds<=0?(alert("请选择申请单"),!1):(apply.showVieryWin=!0,apply.verifyComment="",void apply.showmask())},apply.clickBatchRefuse=function(){var checkeds=$(".applytablelistbor li .checkbox:checked").length;return checkeds<=0?void alert("请选择申请单"):(apply.showRefuseWin=!0,apply.refuseComment="",void apply.showmask())},apply.verifyComment="",apply.verifyBatch=function(){return apply.selected.length<=0?void alert("请选择申请单"):Publicfactory.checkEnCnstrlen(apply.verifyComment)>100?void alert("内容不能超过50个字!"):(applyModel.verifyBatch($scope),void apply.clearAll())},apply.refuseComment="",apply.refuseBatch=function(){return apply.selected.length<=0?void alert("请选择申请单"):""==apply.refuseComment?void alert("请填写驳回意见"):Publicfactory.checkEnCnstrlen(apply.refuseComment)>100?void alert("内容不能超过50个字!"):(applyModel.refuseBatch($scope),void apply.clearAll())},apply.closeBatchResWin=function(){$scope.apply.successNum="",$scope.apply.failNum="",$scope.apply.failList=[],apply.batchResWin=!1,$("#masklayer1").hide()},apply.search=function(){apply.status=applyParams.status,apply.clearAll(),$scope.page={curPage:1,tempcurPage:1,sumPage:0},$scope.applyParams.page=1,applyModel.getMyAgentList($scope)},$scope.page_fun=function(){apply.clearAll(),$scope.applyParams.page=$scope.page.tempcurPage,applyModel.getMyAgentList($scope)},apply.detailApply=function(model_id,apply_id,modeltype){switch($("#masklayer1").show(),apply.modeltype=modeltype,model_id){case"1":leave_apply.apply_id=apply_id,leave_apply.model_id=model_id,applyModel.applyDetail($scope,apply_id),apply.overtimeShowWin=!0;break;case"2":leave_apply.apply_id=apply_id,leave_apply.model_id=model_id,leaveApplyModel.getLeaveApplyDetail($scope,!1);break;case"3":apply.drainPunchPopup=!0,apply.apply_id=apply_id,applyModel.rankDetail($scope,apply.apply_id);break;case"4":apply.flexibleWorkPopup=!0,apply.apply_id=apply_id,applyModel.applyDetail($scope,apply.apply_id);break;case"5":apply.rankDetailPopup=!0,apply.apply_id=apply_id,applyModel.rankDetail($scope,apply.apply_id);break;default:leave_apply.apply_id=apply_id,leave_apply.model_id=model_id,apply.customShowWin=!0,apply.apply_id=apply_id,applyModel.applyDetail($scope,apply_id,0)}};var leave_apply=$scope.leave_apply={},apply_param=$scope.apply_param={};apply_param.apply_id="",apply_param.type="",apply_param.begin_time="",apply_param.end_time="",apply_param.leave_sum="",apply_param.content="",apply_param.att="",leave_apply.apply_id="",leave_apply.model_id="",leave_apply.leaveApplyInfo="",leave_apply.typestr="",leave_apply.isLeaveEditApplyWin=!1,apply.isLeaveDetailApplyWin=!1,apply.isDetailBtn=!0,leave_apply.isLeaveLastStepWin=!1,leave_apply.last_begin_time="",leave_apply.last_end_time="",leave_apply.isShowVieryWin=!1,leave_apply.isShowRefuseWin=!1,leave_apply.comment="",apply.leaveType=[],apply.typeSum="",leave_apply.closeEditLeaveApplyBtn=function(){leaveApplyModel.closeEditLeaveApply($scope),$("#masklayer1").hide(),leave_apply.isShowRefuseWin=!1,apply.showVieryDrainPopup=!1},apply.downFileBtn=function(obj){noticeModel.fileDownload($scope,obj.file_path,obj.real_name,obj.file_name,obj.file_size)},leave_apply.openVerifyWin=function(){leave_apply.comment="",leave_apply.isShowVieryWin=!0,leave_apply.isShowRefuseWin=!1},leave_apply.openLeaveLastStepWin=function(){leave_apply.comment="",apply.tempDay=apply_param.leave_sum,leaveApplyModel.getLeaveClockTime($scope)},leave_apply.showAgreeWin=function(){apply_approve.real_hours="",apply_approve.begin_time="",apply_approve.end_time="",leave_apply.last_begin_time="",leave_apply.last_end_time="",1==apply.modeltype?1==leave_apply.model_id?$scope.apply.detail.last_step?leave_apply.openOvertimeLastStepWin():leave_apply.openVerifyWin():2==leave_apply.model_id&&(leave_apply.leaveApplyInfo.last_step?leave_apply.openLeaveLastStepWin():leave_apply.openVerifyWin()):leave_apply.openVerifyWin()},leave_apply.verifyBtn=function(){if(2==leave_apply.model_id)if(leave_apply.leaveApplyInfo.last_step){if(reg=/^[0-9]\d*(\.\d+)?$/,!reg.test(apply_param.leave_sum))return alert("请输入正确的休假天数！"),!1;if(apply_param.leave_sum<=0)return alert("请输入正确的休假天数！"),!1;if(10*apply_param.leave_sum%5!=0)return alert("休假必须以0.5天为最小单位！"),!1;apply_approve.leave_sum=apply_param.leave_sum}else apply_approve.leave_sum="";return leave_apply.comment=leave_apply.comment.replace(/(^\s*)/g,""),Publicfactory.checkEnCnstrlen(leave_apply.comment)>100?(alert("同意原因不能超过50个汉字！"),!1):(leave_apply.isLeaveLastStepWin=!1,apply.isOvertimeLastStepWin=!1,leave_apply.isShowVieryWin=!1,apply_approve.apply_id=leave_apply.apply_id,apply_approve.comment=leave_apply.comment,applyModel.verify($scope),void 0)},leave_apply.openRefuseWin=function(){leave_apply.comment="",leave_apply.isShowVieryWin=!1,leave_apply.isShowRefuseWin=!0},leave_apply.refuseBtn=function(){return leave_apply.comment=leave_apply.comment.replace(/(^\s*)/g,""),""==leave_apply.comment?(alert("请填写驳回意见"),!1):Publicfactory.checkEnCnstrlen(leave_apply.comment)>100?(alert("驳回意见不能超过50个汉字"),!1):(leave_apply.isShowRefuseWin=!1,apply_approve.apply_id=leave_apply.apply_id,apply_approve.comment=leave_apply.comment,applyModel.refuse($scope),void 0)},$scope.addAttBtn=function(Uploader){Uploader.url="/index.php?r=apply/apply/upload",Uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),$scope.att.push(response.data.data),leave_apply.leaveApplyInfo.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFileBtn=function(index){$scope.att.splice(index,1)},leave_apply.openOvertimeLastStepWin=function(){leave_apply.comment="",apply.tempDay=apply_param.leave_sum,applyModel.getOvertimeClockTime($scope)},apply.popupCtr=function(statusCtr){switch(statusCtr){case"1":break;case"2":break;case"3":apply.drainPunchPopup=!1;break;case"5":apply.rankDetailPopup=!1;break;case"7":apply.showVieryRankPopup=!0;break;case"8":apply.showVieryRankPopup=!1;break;case"9":apply.showRefuseRankPopup=!0;break;case"10":apply.showRefuseRankPopup=!1;break;case"11":apply.showVieryLastRankPopup=!0,$http.post("/index.php?r=apply/apply/get-rank-level",{detailId:apply.rankDetail.detail_id}).success(function(data){2e4==data.code&&(apply.level_rank=data.data.rank_level)});break;case"12":apply.showVieryLastRankPopup=!1;break;case"13":apply.showVieryDrainPopup=!0;break;case"14":apply.showRefuseDrainPopup=!0;break;case"15":apply.showVieryDrainPopup=!1;break;case"16":apply.showRefuseDrainPopup=!1}apply.comment.length>0&&(apply.comment="")},apply.popupCtrClose=function(){$("#masklayer1").hide(),apply.showVieryDrainPopup=!1,apply.showRefuseRankPopup=!1,apply.showRefuseDrainPopup=!1,apply.showVieryLastRankPopup=!1},apply.customHideWin=function(){$("#masklayer1").hide(),leave_apply.isShowRefuseWin=!1,leave_apply.isShowVieryWin=!1},apply.rankVieryCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.score=$scope.apply.score,apply_approve.comment=$scope.apply.comment,apply_approve.level_rank=$scope.apply.level_rank,Publicfactory.checkEnCnstrlen(apply_approve.level_rank)<=0?void alert("请填写职级评定"):Publicfactory.checkEnCnstrlen(apply_approve.comment)>100||0==Publicfactory.checkEnCnstrlen(apply_approve.comment)?void alert("请输入同意原因，且不能超过50个汉字!"):void applyModel.verify($scope)},apply.rankVieryLastCtr=function(step,last_step){var isNub=/^([1-9]\d*|[0]{1,1})$/;if(apply_approve.apply_id=apply.apply_id,apply_approve.score=$scope.apply.score,apply_approve.level_rank=$scope.apply.level_rank,apply_approve.comment=$scope.apply.comment,1==last_step){if(0==Publicfactory.checkEnCnstrlen(apply_approve.level_rank)||Publicfactory.checkEnCnstrlen(apply_approve.level_rank)>20)return void alert("请填写职级评定,且最多只能输入10个字!");if(!isNub.test(apply_approve.score)||apply_approve.score>=1e8)return void alert("请填写积分奖励,且为不能超过100000000的正整数!")}else if(1==step&&0==last_step){if(0==Publicfactory.checkEnCnstrlen(apply_approve.level_rank)||Publicfactory.checkEnCnstrlen(apply_approve.level_rank)>20)return void alert("请填写职级评定,且最多只能输入10个字!");if(Publicfactory.checkEnCnstrlen(apply_approve.comment)>100)return void alert("请填写同意原因，且最多只能输入50个字!")}else if(1!=step&&0==last_step&&Publicfactory.checkEnCnstrlen(apply_approve.comment)>100)return void alert("请填写同意原因，且最多只能输入50个字!");applyModel.verify($scope)},apply.rankRefuseCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=$scope.apply.comment,apply_approve.comment.length<=0||Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请填写驳回原因,且不能超过50个字!"):void applyModel.refuse($scope)},apply.drainVieryCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=$scope.apply.comment,Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("同意原因不能超过50个字!"):(applyModel.verify($scope),apply.drainPunchPopup=!1,apply.showVieryDrainPopup=!1,$("#masklayer1").hide(),void 0)},apply.drainRefuseCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=$scope.apply.comment,apply_approve.comment.length<=0||Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请填写驳回原因,且不能超过50个字!"):void applyModel.refuse($scope)},apply.flexibleWorkComment="",apply.flexibleWorkViery=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=apply.flexibleWorkComment,Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请输入同意原因，且不能超过50个字!"):void applyModel.verify($scope)},apply.flexibleWorkRefuseCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=apply.flexibleWorkComment,0==apply_approve.comment.length||Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请填写驳回原因，且不能超过50个字!"):void applyModel.refuse($scope)},parseInt($stateParams.apply_id)&&parseInt($stateParams.model_id)&&"undefined"!=typeof $stateParams.model_type&&""!=$stateParams.model_type&&apply.detailApply($stateParams.model_id,$stateParams.apply_id,$stateParams.model_type),angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor").length&&angular.element(".selectbor  ul").hide()}),angular.element(".selecttimebor").bind("click",function(event){$(".selectbor ul").hide()}),apply.showmask=function(){$("#masklayer1").show()},apply.hidemask=function(){$("#masklayer1").hide()}});
ApplyMod.controller("applyModelCreateCtrl",function($scope,$http,$rootScope,applyModel,applySetModel,formshowfactory){var apply=$scope.apply={};applySetModel.getCustomList($scope),apply.addfilesbtn=function(){angular.element(".modbor").css({visibility:"visible"}),angular.element(".modbor .applyindexeditbor").addClass("md-show")},apply.changeforms=function(model_id){0==model_id?($(".createforms .scrollbor").html(""),$(".formseditbor .scrollbor").html("")):applySetModel.getModelHTML(model_id)},apply.formPreview=function(){var formtitle=$(".createforms .titlebor input").val(),formhtml=$(".createforms .scrollbor").html();$(".formPreview .formtitles").html(formtitle),$(".formPreview .scrollbor").html(formhtml),$(".formPreview .borderbor").removeClass("field"),$(".formPreview .borderbor.SelectSelect select").removeAttr("disabled"),$(".formPreview,#masklayer1").show()},apply.formPreviewClose=function(){$(".formPreview .scrollbor").html(""),$(".formPreview,#masklayer1").hide()}});
ApplyMod.controller("flexibleWorkCtr",function($scope,$http,checkModel,applyModel,Publicfactory){var flexibleWork=$scope.flexibleWork={};$scope.apply_param={},flexibleWork.timePoint=[],flexibleWork.beginTime="",flexibleWork.endTime="",flexibleWork.desc="",flexibleWork.files=[],flexibleWork.info={},flexibleWork.id="",flexibleWork.file_root="",applyModel.getFlexibleWorkTimePoint($scope,1),$scope.att={},flexibleWork.selectTimePoint=function(id){flexibleWork.id=id},$("#masklayer1").show(),$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){flexibleWork.files.push(response.data.data);for(var isRepeated,result=[],len=flexibleWork.files.length,i=0;i<len;i++){isRepeated=!1;for(var resultLen=result.length,j=0;j<resultLen;j++)if(flexibleWork.files[i].file_name==result[j].file_name){isRepeated=!0;break}isRepeated||result.push(flexibleWork.files[i])}flexibleWork.files=result,flexibleWork.file_root=response.file_root}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},flexibleWork.delFiles=function(index){flexibleWork.files.splice(index,1)},flexibleWork.submitRankInfo=function(){return flexibleWork.desc=$scope.flexibleWork.desc,$scope.apply_param.begin_time=$scope.flexibleWork.beginTime,$scope.apply_param.end_time=$scope.flexibleWork.endTime,$scope.apply_param.model_id=4,$scope.apply_param.store_id=$scope.flexibleWork.id,$scope.apply_param.att=flexibleWork.files,$scope.apply_param.note=flexibleWork.desc,$scope.apply_param.begin_time>=$scope.apply_param.end_time?void alert("申请结束时间不能小于等于开始时间，请重新选择！"):$scope.apply_param.store_id<=0?void alert("请选择需抵用的加班时间!"):flexibleWork.desc.length<=0||Publicfactory.checkEnCnstrlen(flexibleWork.desc)>200?(alert("请输入详细说明,且不能超过100个字！"),!1):void applyModel.createApply($scope)}});
ApplyMod.controller("OvertimeApplyCreateCtrl",function($scope,$http,$state,$stateParams,applyModel,filtersModel,checkModel,Publicfactory){var overtime=$scope.overtime={},apply_param=$scope.apply_param={};apply_param.model_id=$stateParams.model_id,apply_param.type="0",apply_param.currentDay="",apply_param.begin_time_str="",apply_param.end_time_str="",apply_param.note="",apply_param.isNextDay=!1,$("#masklayer1").show(),overtime.doSubmit=function(){if(0==apply_param.type)return void alert("请选择加班类型");if(""==apply_param.currentDay||""==apply_param.begin_time_str||""==apply_param.end_time_str)return void alert("请选择加班开始结束时间");var beginDateStr=filtersModel.filterDateTime(apply_param.currentDay).replace(/(00:00)/,apply_param.begin_time_str),endDateStr=filtersModel.filterDateTime(apply_param.currentDay).replace(/(00:00)/,apply_param.end_time_str),bDate=new Date(Date.parse(beginDateStr)),eDate=new Date(Date.parse(endDateStr));return bDate>eDate&&!apply_param.isNextDay?void alert("同一天加班开始时间不可大于结束时间"):apply_param.isNextDay&&apply_param.end_time_str>"06:00"?void alert("加班跨天，结束时间必须小于次日06:00"):""==apply_param.note?void alert("请填写加班工作说明"):Publicfactory.checkEnCnstrlen(apply_param.note)>200?(alert("工作说明必须100字以内"),!1):(apply_param.currentDay=filtersModel.filterTime(apply_param.currentDay),void applyModel.createApply($scope))},overtime.cancel=function(){$state.go("^"),$("#masklayer1").hide()}});
ApplyMod.controller("CustomApplyCreateCtrl",function($scope,$http,$rootScope,$state,$stateParams,Publicfactory,applyModel,applySetModel,formshowfactory){var apply=$scope.apply={},model=$scope.model={},model_id=($scope.apply_param={},$stateParams.model_id),group=$scope.group={};$scope.selectedMembers=[],$scope.selectedDeparts=[],group.memberdialog=!1;var fields="",currentType="";$scope.att=[],$("#masklayer1").show(),$scope.addFileBtn=function(Uploader,element){Uploader.url="/index.php?r=apply/apply/upload";for(var ele=element.parents(".borderbor").find("ul"),filenamelength=ele.find(".filesize"),fileaftersize=0,i=0;i<filenamelength.length;i++)fileaftersize+=parseFloat(filenamelength.eq(i).html().replace("KB",""));if(fileaftersize=fileaftersize.toFixed(2),element.parents(".borderbor").find(".none").html(fileaftersize),fileaftersize>51200)return alert("总文件大小已超过上限50MB!"),!1;var elesize=element.parents(".borderbor").find(".none").html();Uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){if(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),elesize=parseFloat(elesize)+parseFloat(response.data.data.file_size),elesize>51200)return alert("总文件大小超过50MB，已从上传队列中移除"),!1;var file_root=response.file_root,filefull_path=file_root+"/"+response.data.data.file_path+"/"+response.data.data.real_name,li='<li class="porela"><i class="poabso icon-'+response.data.data.file_type+'"></i><div class="filename fl omit"><a href="'+filefull_path+'" target="_blank">'+response.data.data.file_name+'</a></div><div class="filesize fl omit">'+response.data.data.file_size+'KB</div><div class="del fr">删除</div></li>';ele.append(li),element.parents(".borderbor").find(".none").html(elesize)}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},$(document).on("click",".borderbor .del",function(){$(this).parent().remove();var id=$(this).parent().find(".filename").attr("data-member_id");$scope.selectedMembers.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedMembers.splice(index,1)}),$scope.selectedDeparts.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedDeparts.splice(index,1)})}),$scope.addgroup=function($event,index){$("#masklayer2").show(),fields=angular.element($event.target).attr("id"),currentType=index,0==index?group.departDialogVisble=!0:group.memberDialogVisble=!0},$scope.lishtml=function(i,value,label){var li='<li class="porela"><div class="filename fl omit" data-member_id="'+value+'">'+label+'</div><div class="del fr">删除</div></li>';return li},$scope.cancels=function(index){var index=fields;group.memberDialogVisble=!1,$("#masklayer2").is(":hidden")?$("#masklayer1").hide():$("#masklayer2").hide();var lis=$(".borderbor").eq(index).find("ul");if($scope.selectedMembers.length>0||$scope.selectedDeparts.length>0){var targetArray=currentType?$scope.selectedMembers:$scope.selectedDeparts;if(lis.find("li").length<=0)for(var i=0;i<targetArray.length;i++)lis.append($scope.lishtml(i,targetArray[i].value,targetArray[i].label));else{var currentSelectArray=[],selectedArray=[];lis.find("li").each(function(iArray){currentSelectArray.push(parseInt(lis.find("li").eq(iArray).find(".filename").attr("data-member_id")))}),targetArray.forEach(function(item){selectedArray.push({value:parseInt(item.value),label:item.label})}),currentSelectArray=currentSelectArray.sort(function(prev,next){return next-prev}),selectedArray=selectedArray.sort(function(prev,next){return next-prev}),selectedArray.forEach(function(item,index){currentSelectArray.indexOf(item.value)==-1&&lis.append($scope.lishtml(void 0,item.value,item.label))})}}},$(".formsave").click(function(){if(formshowfactory.formshowsave(model.formshowdata)){var showFormssave=new jQuery.showeditForm,result=showFormssave.saveForm();$scope.apply_param=result,$scope.apply_param.model_id=model_id,applyModel.createApply($scope)}}),applySetModel.showModel($scope,model_id,1),apply.cancel=function(){$state.go("^"),$("#masklayer1").hide()}});
ApplyMod.factory("applyModel",function($http,$state,filtersModel,formshowfactory,$compile,util){var service={};return service.getMyApplyList=function($scope){$http.post("/index.php?r=apply/apply/apply-list",JSON.stringify($scope.applyParams)).success(function(data,status){$scope.apply.list=data.list,$scope.page.curPage=data.curPage,$scope.page.sumPage=data.sumPage})},service.getMyAgentList=function($scope){$http.post("/index.php?r=apply/apply/apply-agent",JSON.stringify($scope.applyParams)).success(function(data,status){$scope.apply.list=data.list,$scope.page.curPage=data.curPage,$scope.page.sumPage=data.sumPage})},service.getApplyModel=function($scope){$http.get("/index.php?r=apply/apply-model/model-list").success(function(data){$scope.apply.modelList=data.data,$scope.apply.modelList.unshift({model_id:0,title:"申请单名称"})})},service.delApply=function(apply_id,$scope){$http.get("/index.php?r=apply/apply/apply-del&apply_id="+apply_id).success(function(data){alert(data.msg),1==data.code&&(service.closeMark($scope),service.getMyApplyList($scope))})},service.press=function(apply_id,$scope){$http.get("/index.php?r=apply/apply/press&apply_id="+apply_id).success(function(data){alert(data.msg),1==data.code&&(service.closeMark($scope),service.getMyApplyList($scope))})},service.revoke=function(apply_id,$scope,applyStatus){$http.get("/index.php?r=apply/apply/revoke&apply_id="+apply_id).success(function(data){alert(data.msg),1==data.code&&($("#masklayer1").hide(),$scope.apply.isLeaveDetailApplyWin=!1,service.getMyApplyList($scope),4==applyStatus&&($scope.apply.editPopup=!0))})},service.getUsefulModel=function($scope){$http.get("/index.php?r=apply/apply-model/useful-list").success(function(data){$scope.applyApp.modelList=data.data})},service.getAllModel=function($scope){$http.get("/index.php?r=apply/apply-model/model-list").success(function(data){$scope.model.modelList=data.data})},service.verifyBatch=function($scope){$http.post("/index.php?r=apply/apply/batch-verify",{apply_ids:$scope.apply.selected,comment:$scope.apply.verifyComment}).success(function(data){$scope.apply.successNum=data.data.successNum,$scope.apply.failNum=data.data.failNum,$scope.apply.failList=data.data.failList,$scope.apply.batchResWin=!0,$scope.apply.showVieryWin=!1,$scope.apply.verifyComment="",service.getMyAgentList($scope)})},service.refuseBatch=function($scope){$http.post("/index.php?r=apply/apply/batch-refuse",{apply_ids:$scope.apply.selected,comment:$scope.apply.refuseComment}).success(function(data){$scope.apply.successNum=data.data.successNum,$scope.apply.failNum=data.data.failNum,$scope.apply.failList=data.data.failList,$scope.apply.batchResWin=!0,$scope.apply.showRefuseWin=!1,$scope.apply.refuseComment="",$("#masklayer1").hide(),service.getMyAgentList($scope)})},service.verify=function($scope){$http.post("/index.php?r=apply/apply/verify",JSON.stringify($scope.apply_approve)).success(function(data){1==data.code?($("#masklayer1").hide(),$scope.apply.isLeaveDetailApplyWin=!1,$scope.apply.customShowWin=!1,$scope.apply.overtimeShowWin=!1,$scope.apply.rankDetailPopup=!1,$scope.apply.drainPunchPopup=!1,$scope.apply.showRefuseDrainPopup=!1,$scope.apply.showVieryLastRankPopup=!1,$scope.apply.showRefuseRankPopup=!1,$scope.apply.showVieryDrainPopup=!1,$scope.apply.flexibleWorkVieryPopup=!1,$scope.apply.flexibleWorkPopup=!1,$scope.apply.score=0,$scope.apply.level_rank="",$scope.apply.comment="",service.getMyAgentList($scope),alert(data.msg)):($scope.apply_param.leave_sum=$scope.apply.tempDay,alert(data.msg))})},service.refuse=function($scope){$http.post("/index.php?r=apply/apply/refuse",JSON.stringify($scope.apply_approve)).success(function(data){1==data.code?($scope.apply.isLeaveDetailApplyWin=!1,$scope.apply.customShowWin=!1,$scope.apply.overtimeShowWin=!1,$scope.apply.rankDetailPopup=!1,$scope.apply.drainPunchPopup=!1,$scope.apply.showRefuseDrainPopup=!1,$scope.apply.showRefuseRankPopup=!1,$scope.apply.flexibleWorkPopup=!1,$scope.apply.flexibleWorkRefusePopup=!1,service.getMyAgentList($scope),alert(data.msg),$("#masklayer1").hide()):alert(data.msg)})},service.editTitle=function(modelId,title,$scope){$http.post("/index.php?r=apply/apply-model/update-title",{model_id:modelId,title:title}).success(function(data){alert(data.msg),1==data.code&&service.getAllModel($scope)})},service.doStop=function(modelId,status,$scope){$http.post("/index.php?r=apply/apply-model/model-state",{model_id:modelId,status:status}).success(function(data){alert(data.msg),1==data.code&&service.getAllModel($scope)})},service.doDel=function(modelId,$scope){$http.get("/index.php?r=apply/apply-model/model-delete&model_id="+modelId).success(function(data){alert(data.msg),1==data.code&&service.getAllModel($scope)})},service.rankDetail=function($scope,applyId){$http.get("/index.php?r=apply/apply/show-detail&apply_id="+applyId).success(function(data){$scope.apply.rankDetail=data.data,$scope.apply.file_root=data.data.file_root})},service.createApply=function($scope){$http.post("/index.php?r=apply/apply/create-apply",JSON.stringify($scope.apply_param)).success(function(data,status){1==data.code?(alert(data.msg),$state.go("main.apply.mine",{apply_id:0,model_id:0})):alert(data.msg)})},service.applyDetail=function($scope,applyId,action){$http.get("/index.php?r=apply/apply/show-detail&apply_id="+applyId).success(function(data){data.data=util.setImgRand(data.data),data.data.verifyRecorders=util.setImgRand(data.data.verifyRecorders),$scope.apply.detail=data.data,$scope.apply.file_root=$scope.apply.detail.file_root,1==$scope.apply.detail.model_id&&($scope.apply.detail.data.begin_time=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.begin_time),$scope.apply.detail.data.end_time=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.end_time),$scope.apply.detail.data.currentDay=filtersModel.filterTime(1e3*$scope.apply.detail.data.overtime),$scope.apply.detail.data.isNextDay=1==$scope.apply.detail.data.is_next_day),3==$scope.apply.detail.model_id&&($scope.apply.beginTime=filtersModel.filterTime(1e3*$scope.apply.detail.data.check_date),1==$scope.apply.detail.data.is_am?$scope.apply.drainCheckAm=!0:2==$scope.apply.detail.data.is_am&&($scope.apply.drainCheckPm=!0),1==action&&($scope.apply.detail.data.isShowPage=!0),$scope.apply.drainDesc=$scope.apply.detail.data.note),4==$scope.apply.detail.model_id&&($scope.apply.flexibleWorkDetailList=data.data,$scope.apply.beginTime=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.begin_time),$scope.apply.endTime=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.end_time),$scope.apply.workTimePoint=$scope.apply.detail.data.flexibleWorkTime,$scope.apply.id=$scope.apply.detail.data.store_id,$scope.apply.desc=$scope.apply.detail.data.note,$scope.apply.files=$scope.apply.detail.data.att,service.getFlexibleWorkTimePoint($scope,2),1==action&&($scope.apply.detail.data.isShowPage=!0)),5==$scope.apply.detail.model_id&&(1==action&&($scope.apply.detail.data.isShowPage=!0),$scope.apply.rankApplyDesc=$scope.apply.detail.data.note,$scope.apply.rankFiles=$scope.apply.detail.data.att),$scope.apply.detail.model_id>5&&formshowfactory.formshow(JSON.parse(data.data.form_json),$compile,$scope,action)})},service.applyEdit=function($scope,callBack){$http.post("/index.php?r=apply/apply/edit-apply",JSON.stringify($scope.applyEditParam)).success(function(data){alert(data.msg),1==data.code&&($("#masklayer1").hide(),callBack(),service.getMyApplyList($scope))})},service.getOvertimeClockTime=function($scope){$http.get("/index.php?r=apply/apply/overtime&apply_id="+$scope.leave_apply.apply_id).success(function(data){1==data.code?($scope.apply_approve.end_time=data.data.end_time,$scope.apply_approve.begin_time=data.data.begin_time,$scope.apply_approve.real_hours=data.data.real_hours,$scope.apply.isOvertimeLastStepWin=!0):alert(data.msg)})},service.getFlexibleWorkTimePoint=function($scope,i){$http.post("/index.php?r=apply/apply/flexible-work").success(function(data){1==i?$scope.flexibleWork.timePoint=data.data:2==i&&($scope.apply.timePoint=data.data,angular.forEach(data.data,function(val,key){$scope.apply.workTimePoint==val.timeOutData&&($scope.apply.flexibleWork=val)}))})},service.closeMark=function($scope){$("#masklayer1").hide(),$scope.apply.isLeaveDetailApplyWin=!1},service});
ApplyMod.factory("applySetModel",function($http,$state,filtersModel,formshowfactory,$compile){var service={};return service.showModel=function($scope,model_id,action,callback){action=action||0,$http.get("/index.php?r=apply/apply-model/model-show&model_id="+model_id).success(function(data){$scope.model.formshowdata=data.data,formshowfactory.formshow(data.data,$compile,$scope,action),"function"==typeof callback&&callback()})},service.getCustomList=function($scope){$http.get("/index.php?r=apply/apply-model/custom-model-list").success(function(data){$scope.apply.customList=data.data})},service.getModelHTML=function(model_id){$http.get("/index.php?r=apply/apply-model/model-show&model_id="+model_id).success(function(data){$(".createforms .scrollbor").html(data.data.html),$(".createforms .field:first").trigger("click")})},service});
ApplyMod.factory("leaveApplyModel",function($http,$timeout,$cookieStore,$cookies,$state,filtersModel,applyModel){var service={};return service.getLeaveApplyTypeSum=function($scope){$http.post("/index.php?r=apply/apply/leave-apply-sum",JSON.stringify($scope.apply_param)).success(function(data,status){$scope.apply.typeSum=data.data})},service.getLeaveApplyType=function($scope){$http.post("/index.php?r=apply/apply/leave-apply-type",{}).success(function(data,status){$scope.apply.leaveType=data.data,"undefined"!=typeof $scope.leave_apply&&"undefined"!=typeof $scope.leave_apply.typestr&&angular.element.each($scope.apply.leaveType,function(key,val){$scope.apply_param.type==val.statuskey&&($scope.leave_apply.typestr=val.statusstr)})})},service.createLeaveApply=function($scope){$http.post("/index.php?r=apply/apply/create-apply",JSON.stringify($scope.apply_param)).success(function(data,status){1==data.code?$state.go("main.apply.mine",{apply_id:0,model_id:0}):alert(data.msg)})},service.getLeaveApplyDetail=function($scope,isEdit){$http.get("/index.php?r=apply/apply/show-detail&apply_id="+$scope.leave_apply.apply_id).success(function(data){1==data.code?($scope.apply_param.apply_id=data.data.apply_id,$scope.apply_param.type=data.data.data.type,$scope.apply_param.begin_time=data.data.data.begin_time,$scope.apply_param.end_time=data.data.data.end_time,$scope.apply_param.leave_sum=data.data.data.leave_sum,$scope.apply_param.content=data.data.data.content,$scope.att=[],$scope.att=data.data.data.att,$scope.leave_apply.leaveApplyInfo=data.data,$scope.apply.file_root=data.data.file_root,isEdit?($scope.leave_apply.isLeaveEditApplyWin=!0,$scope.apply.isLeaveDetailApplyWin=!1,1!=$scope.apply_param.type&&2!=$scope.apply_param.type&&3!=$scope.apply_param.type||service.getLeaveApplyTypeSum($scope)):($scope.apply.isLeaveDetailApplyWin=!0,service.getLeaveApplyType($scope))):alert(data.msg)})},service.editLeaveApply=function($scope){$http.post("/index.php?r=apply/apply/edit-apply",JSON.stringify($scope.apply_param)).success(function(data,status){1==data.code?(service.closeEditLeaveApply($scope),applyModel.getMyApplyList($scope),alert(data.msg)):alert(data.msg)})},service.closeEditLeaveApply=function($scope){$scope.apply_param.apply_id="",$scope.apply_param.type="",$scope.apply_param.begin_time="",$scope.apply_param.end_time="",$scope.apply_param.leave_sum="",$scope.apply_param.content="",$scope.apply_param.att="",$scope.att=[],$scope.leave_apply.isLeaveEditApplyWin=!1,$scope.apply.isLeaveDetailApplyWin=!1,$("#masklayer1").hide(),"undefined"!=typeof $scope.leave_apply.typestr&&($scope.leave_apply.typestr="")},service.getLeaveClockTime=function($scope){$http.post("/index.php?r=apply/apply/leave-clock-time",{apply_id:$scope.leave_apply.apply_id,date:$scope.apply_param.begin_time}).success(function(data,status){1==data.code?($scope.leave_apply.last_end_time=data.data.offTime,$scope.leave_apply.last_begin_time=data.data.onTime,$scope.leave_apply.isLeaveLastStepWin=!0):alert(data.msg)})},service.closeMark=function($scope){$("#masklayer1").hide(),$scope.apply.isLeaveDetailApplyWin=!1},service});
ApplyMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/apply/view/";$stateProvider.state("main.apply",{url:"/apply",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"applyContent@main":{templateUrl:basePath+"apply_content.html"}}}).state("main.apply.mine",{url:"/mine/:apply_id/:model_id",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"apply_mine@main.apply":{templateUrl:basePath+"apply_myapply_list.html",controller:"MyApplyListController"}}}).state("main.apply.agent",{url:"/agent/:apply_id/:model_id/:model_type",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"apply_agent@main.apply":{templateUrl:basePath+"apply_agent_list.html",controller:"AgentApplyListController"}}}).state("main.apply.application",{url:"/application",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"apply_application@main.apply":{templateUrl:basePath+"apply_model_list.html",controller:"ApplyAppController"}}}).state("main.apply.application.overtimecreate",{url:"/overtimecreate/:model_id",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"overtime_apply@main.apply":{templateUrl:basePath+"overtime_apply_create.html",controller:"OvertimeApplyCreateCtrl"}}}).state("main.apply.application.leaveapplycreate",{url:"/leaveapplycreate",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"leave_apply@main.apply":{templateUrl:basePath+"leave_apply_create.html",controller:"LeaveApplyCreateCtrl"}}}).state("main.apply.application.customcreate",{url:"/customcreate/:model_id",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"leave_apply@main.apply":{templateUrl:basePath+"apply_custom_create.html",controller:"CustomApplyCreateCtrl"}}}).state("main.apply.manage",{url:"/manage",module:"private",data:{css:["css/apply.css","css/lib/datetimepicker.css"]},views:{"apply_manage@main.apply":{templateUrl:basePath+"apply_manage_list.html",controller:"ApplyModelListController"}},onExit:function(){angular.element(".applyindexeditbor").remove()}}).state("main.apply.rankApply",{url:"/rankApply",module:"private",views:{"apply_rankApply@main.apply":{templateUrl:basePath+"rank_apply.html",controller:"rankApplyCtrl"}}}).state("main.apply.flexibleWork",{url:"/flexibleWork",module:"private",views:{"apply_flexibleWork@main.apply":{templateUrl:basePath+"flexible_work_apply.html",controller:"flexibleWorkCtr"}}}).state("main.apply.drainPunchApply",{url:"/drainPunchApply",module:"private",views:{"apply_drainPunchApply@main.apply":{templateUrl:basePath+"drainPunch_apply.html",controller:"drainPunchCtrl"}}}).state("main.apply.flow",{url:"/flow/:id/:type/:readOnly",module:"private",views:{"apply_flow@main.apply":{templateUrl:basePath+"apply_flow.html",controller:"applyFlowCtrl"}}}).state("main.apply.createModel",{url:"/createModel",module:"private",views:{"apply_createModel@main.apply":{templateUrl:basePath+"apply_model_create.html",controller:"applyModelCreateCtrl"}},onExit:function(){}}).state("main.apply.demo",{url:"/demo",module:"private",views:{"apply_demo@main.apply":{templateUrl:basePath+"apply_demo.html",controller:"applyCtrl"}},onExit:function(){angular.element(".formindexbor").remove()}}).state("main.apply.demoform",{url:"/demoform",module:"private",views:{"apply_demoform@main.apply":{templateUrl:basePath+"apply_demoform.html",controller:"applyshowCtrl"}},onExit:function(){angular.element(".formpresentation").html(""),angular.element(".datetimepicker").remove()}}).state("main.apply.demoeditform",{url:"/demoeditform",module:"private",views:{"apply_demoeditform@main.apply":{templateUrl:basePath+"apply_demoeditform.html",controller:"applyeditshowCtrl"}},onExit:function(){angular.element(".formpresentation").html(""),angular.element(".datetimepicker").remove()}}).state("main.apply.demoshowform",{url:"/demoshowform",module:"private",views:{"apply_demoshowform@main.apply":{templateUrl:basePath+"apply_demoshowform.html",controller:"applyshowformdataCtrl"}},onExit:function(){angular.element(".formpresentation").html("")}})}]);
var ApplymobileMod=angular.module("ApplymobileMod",["commonMod"]);ApplymobileMod.controller("ApplymobileAppController",function($location,$scope,$http,$state,$rootScope,Publicfactory,applyModel,permissionService){$scope.applyApp={};applyModel.getUsefulModel($scope),$(".mainsbar").css({"overflow-y":"auto"})});
ApplymobileMod.controller("OvertimeApplymobileCreateCtrl",function($scope,$http,$state,$stateParams,applyModel,filtersModel,checkModel,Publicfactory){var overtime=$scope.overtime={},apply_param=$scope.apply_param={};apply_param.model_id=$stateParams.model_id,apply_param.type="0",apply_param.currentDay="",apply_param.begin_time_str="",apply_param.end_time_str="",apply_param.note="",apply_param.isNextDay=!1,$("#masklayer1").show(),$(".mainsbar").css({"overflow-y":"hidden"}),overtime.doSubmit=function(){if(0==apply_param.type)return void alert("请选择加班类型");if(""==apply_param.currentDay||""==apply_param.begin_time_str||""==apply_param.end_time_str)return void alert("请选择加班开始结束时间");var beginDateStr=filtersModel.filterDateTime(apply_param.currentDay).replace(/(00:00)/,apply_param.begin_time_str),endDateStr=filtersModel.filterDateTime(apply_param.currentDay).replace(/(00:00)/,apply_param.end_time_str),bDate=new Date(Date.parse(beginDateStr)),eDate=new Date(Date.parse(endDateStr));return bDate>eDate&&!apply_param.isNextDay?void alert("同一天加班开始时间不可大于结束时间"):apply_param.isNextDay&&apply_param.end_time_str>"06:00"?void alert("加班跨天，结束时间必须小于次日06:00"):""==apply_param.note?void alert("请填写加班工作说明"):Publicfactory.checkEnCnstrlen(apply_param.note)>200?(alert("工作说明必须100字以内"),!1):(apply_param.currentDay=filtersModel.filterTime(apply_param.currentDay),void applyModel.createApply($scope))},overtime.cancel=function(){$("#masklayer1").hide(),$(".mainsbar").css({"overflow-y":"auto"}),$state.go("^")}});
ApplymobileMod.controller("LeaveApplymobileCreateCtrl",function($scope,$http,$rootScope,Publicfactory,applyModel,$timeout,checkModel,leaveApplyModel,FileUploader,$state){var apply=$scope.apply={},apply_param=$scope.apply_param={};apply_param.model_id=2,apply_param.type="",apply_param.begin_time="",apply_param.end_time="",apply_param.leave_sum="",apply_param.content="",apply_param.att=[],apply.leaveType="",apply.typeSum="",$scope.att=[],apply.file_root="",$("#masklayer1").show(),$(".mainsbar").css({"overflow-y":"hidden"}),leaveApplyModel.getLeaveApplyType($scope),apply.getLeaveApplyTypeSum=function(){1!=apply_param.type&&2!=apply_param.type&&3!=apply_param.type||(apply.typeSum="",leaveApplyModel.getLeaveApplyTypeSum($scope))},$scope.addAttBtn=function(Uploader){Uploader.url="/index.php?r=apply/apply/upload",Uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?($scope.att.push(response.data.data),apply.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFileBtn=function(index){$scope.att.splice(index,1)},apply.saveLeaveApplyBtn=function(){return reg=/^[0-9]\d*(\.\d+)?$/,reg.test(apply_param.leave_sum)?apply_param.leave_sum<=0?(alert("请输入正确的休假天数！"),!1):10*apply_param.leave_sum%5!=0?(alert("休假必须以0.5天为最小单位！"),!1):(apply_param.att=$scope.att,checkModel.checkStrLen(apply_param.content)>200?void alert("详细说明必须100字以内"):void leaveApplyModel.createLeaveApply($scope)):(alert("请输入正确的休假天数！"),!1)},apply.cancelBtn=function(){$("#masklayer1").hide(),$(".mainsbar").css({"overflow-y":"auto"}),$state.go("^")}});
ApplymobileMod.controller("drainPunchmobileCtrl",function($scope,$http,applyModel,$timeout,Publicfactory,$state,$location,$timeout){var drain=$scope.drainPunch={};$scope.apply_param={},drain.myDate=new Date,drain.beginTime=drain.myDate.getFullYear()+"-"+(drain.myDate.getMonth()+1)+"-"+drain.myDate.getDate(),drain.curTime=drain.myDate.valueOf(),drain.desc="",drain.is_am="1",drain.note="",$("#masklayer1").show(),$(".mainsbar").css({"overflow-y":"hidden"}),drain.drainTimePoint=function(timePoint){drain.is_am=timePoint},drain.drainPunch=function(){if(drain.beginTime=$scope.drainPunch.beginTime,drain.desc=$scope.drainPunch.desc,drain.beginTime>drain.curTime)return void alert("忘打卡时间超期，请从新选择！");if(drain.is_am.length<=0)return void alert("请选择上午还是下午忘打卡！");if(drain.desc.length<=0)return void alert("请输入忘打卡说明！");if(""!=drain.desc.YLstringcheck()){if(Publicfactory.checkEnCnstrlen(drain.desc)>200)return alert("忘打卡说明长度不能大于100个字"),!1;$scope.apply_param.check_date=$scope.drainPunch.beginTime,$scope.apply_param.note=drain.desc,$scope.apply_param.is_am=drain.is_am,$scope.apply_param.model_id=3,applyModel.createApply($scope)}},drain.cancelBtn=function(){$("#masklayer1").hide(),$(".mainsbar").css({"overflow-y":"auto"}),$state.go("^")},$location.path().indexOf("/drainPunchApply")>0&&$timeout(function(){$(".mainsbar").css({"overflow-y":"hidden"})})});
ApplymobileMod.controller("rankApplymobileCtrl",function($scope,$http,checkModel,applyModel,Publicfactory,$state,$location,$timeout){var rank=$scope.rankApply={};$scope.att={},rank.rankApplyDesc="",$scope.apply_param={},rank.files=[],rank.modelId=5,rank.file_root="",$("#masklayer1").show(),$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){rank.files.push(response.data.data);for(var isRepeated,result=[],len=rank.files.length,i=0;i<len;i++){isRepeated=!1;for(var resultLen=result.length,j=0;j<resultLen;j++)if(rank.files[i].file_name==result[j].file_name){isRepeated=!0;break}isRepeated||result.push(rank.files[i])}rank.files=result,rank.file_root=response.file_root}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},rank.delFiles=function(index){rank.files.splice(index,1)},rank.submitRankInfo=function(){return rank.rankApplyDesc=$scope.rankApply.rankApplyDesc,rank.rankApplyDesc.length<=0||Publicfactory.checkEnCnstrlen(rank.rankApplyDesc)>1e3?(alert("请输入内容,且不能超过500字！"),!1):rank.files.length<=0?(alert("请上传附件！"),!1):($scope.apply_param.model_id=rank.modelId,$scope.apply_param.att=rank.files,$scope.apply_param.note=rank.rankApplyDesc,applyModel.createApply($scope),void 0)},rank.cancel=function(){$("#masklayer1").hide(),$(".mainsbar").css({"overflow-y":"auto"}),$state.go("^")},$location.path().indexOf("/rankApply")>0&&$timeout(function(){$(".mainsbar").css({"overflow-y":"hidden"})})});
ApplymobileMod.controller("flexibleWorkmobileCtr",function($scope,$http,checkModel,applyModel,Publicfactory,$state){var flexibleWork=$scope.flexibleWork={};$scope.apply_param={},flexibleWork.timePoint=[],flexibleWork.myDate=new Date,flexibleWork.beginTime=flexibleWork.myDate.valueOf(),flexibleWork.endTime=flexibleWork.myDate.valueOf(),flexibleWork.desc="",flexibleWork.files=[],flexibleWork.info={},flexibleWork.id="",flexibleWork.file_root="",applyModel.getFlexibleWorkTimePoint($scope,1),$scope.att={},flexibleWork.selectTimePoint=function(id){flexibleWork.id=id},$("#masklayer1").show(),$(".mainsbar").css({"overflow-y":"hidden"}),$scope.addFileBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){flexibleWork.files.push(response.data.data);for(var isRepeated,result=[],len=flexibleWork.files.length,i=0;i<len;i++){isRepeated=!1;for(var resultLen=result.length,j=0;j<resultLen;j++)if(flexibleWork.files[i].file_name==result[j].file_name){isRepeated=!0;break}isRepeated||result.push(flexibleWork.files[i])}flexibleWork.files=result,flexibleWork.file_root=response.file_root}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},flexibleWork.delFiles=function(index){flexibleWork.files.splice(index,1)},flexibleWork.submitRankInfo=function(){return flexibleWork.desc=$scope.flexibleWork.desc,$scope.apply_param.begin_time=Date.parse(new Date($scope.flexibleWork.beginTime))/1e3,$scope.apply_param.end_time=Date.parse(new Date($scope.flexibleWork.endTime))/1e3,$scope.apply_param.model_id=4,$scope.apply_param.store_id=$scope.flexibleWork.id,$scope.apply_param.att=flexibleWork.files,$scope.apply_param.note=flexibleWork.desc,$scope.apply_param.begin_time>=$scope.apply_param.end_time?void alert("申请结束时间不能小于等于开始时间，请重新选择！"):$scope.apply_param.store_id<=0?void alert("请选择需抵用的加班时间!"):flexibleWork.desc.length<=0||Publicfactory.checkEnCnstrlen(flexibleWork.desc)>200?(alert("请输入详细说明,且不能超过100个字！"),!1):void applyModel.createApply($scope)},flexibleWork.cancel=function(){$("#masklayer1").hide(),$(".mainsbar").css({"overflow-y":"auto"}),$state.go("^")}});
ApplymobileMod.controller("ApplyMobileController",function($scope,$http,$state,$rootScope,$stateParams){$("#mLayer2").show()}),ApplymobileMod.controller("MyApplyListmobileController",function($scope,$http,$state,$rootScope,$stateParams,Publicfactory,applymobileModel,leaveApplyModel,noticeModel,filtersModel,checkModel,formshowfactory,permissionService){$scope.isMine=!0;var apply=$scope.apply={};apply.myDate=new Date;var applyParams=$scope.applyParams={};applyParams.status=-1,applyParams.model_id=0,applyParams.begin="",applyParams.end="",applyParams.detailRankPagePopup=!1,applyParams.page=1,apply.curTime=apply.myDate.valueOf(),apply.rankPopup=!1,apply.rankEditPopup=!1,apply.rankApplyDesc="",apply.rankFiles=[],apply.drainPopup=!1,apply.drainDetailPopup=!1,apply.drainDesc="",apply.drainCheckAm=!1,apply.drainCheckPm=!1,apply.beginTime="",apply.drainPunchInfo={},apply.flexibleWorkPopup=!1,apply.flexibleDetailWorkPopup=!1,apply.is_am=1,$scope.att=[],apply.file_root="",$scope.page={curPage:1,tempcurPage:1,sumPage:0},apply.arrStatus=[{text:"状态",value:-1},{text:"待审批",value:0},{text:"已审批",value:1},{text:"已拒绝",value:2},{text:"已撤回",value:3}],apply.isStatusWin=!1,apply.statusWinButton=function(){$("#applyType").hide(),angular.element("#projectInfo").is(":hidden")?angular.element("#projectInfo").show():angular.element("#projectInfo").hide()},apply.selectSearchStatus=function(status){applyParams.status=status,angular.element.each(apply.arrStatus,function(key,val){val.value==status&&angular.element("#status").html(val.text)}),apply.isStatusWin=!1,angular.element("#projectInfo").hide()},apply.modelList=[],applymobileModel.getApplyModel($scope),apply.modelWinButton=function(){$("#projectInfo").hide(),angular.element("#applyType").is(":hidden")?angular.element("#applyType").show():angular.element("#applyType").hide()},apply.selectSearchModel=function(modelId){applyParams.model_id=modelId,angular.element.each(apply.modelList,function(key,val){val.model_id==modelId&&angular.element("#model").html(val.title)}),apply.isModelWin=!1,angular.element("#applyType").hide()},applymobileModel.getMyApplyList($scope),apply.search=function(){$scope.page={curPage:1,tempcurPage:1,sumPage:0},$scope.applyParams.page=1,applymobileModel.getMyApplyList($scope)},$scope.page_fun=function(){$scope.applyParams.page=$scope.page.tempcurPage,applymobileModel.getMyApplyList($scope)},apply.delApplyId=0,apply.delApply=function(apply_id){apply.delApplyId=apply_id,apply.showDelWin=!0,$("#masklayer2").show()},apply.doDel=function(){applymobileModel.delApply(apply.delApplyId,$scope)},apply.revokeApplyId=0,apply.revoke=function(apply_id){apply.revokeApplyId=apply_id,apply.showRevokeWin=!0,$("#masklayer1").show()},apply.doRevoke=function(){applymobileModel.revoke(apply.revokeApplyId,$scope)},apply.press=function(apply_id){applymobileModel.press(apply_id,$scope)};var applyEditParam=$scope.applyEditParam={};applyEditParam.apply_id=0,apply.customHideWin=function(){$("#masklayer1").hide(),apply.showRevokeWin=!1},apply.editSubmit=function(){if(applyEditParam.type=apply.detail.data.type,applyEditParam.note=apply.detail.data.note,applyEditParam.currentDay=apply.detail.data.currentDay,applyEditParam.isNextDay=apply.detail.data.isNextDay,applyEditParam.begin_time_str=apply.detail.data.begin_time_str,applyEditParam.end_time_str=apply.detail.data.end_time_str,0==applyEditParam.type)return void alert("请选择加班类型");if(""==applyEditParam.currentDay||""==applyEditParam.begin_time_str||""==applyEditParam.end_time_str)return void alert("请选择加班开始结束时间");var beginDateStr=filtersModel.filterDateTime(applyEditParam.currentDay).replace(/(00:00)/,applyEditParam.begin_time_str),endDateStr=filtersModel.filterDateTime(applyEditParam.currentDay).replace(/(00:00)/,applyEditParam.end_time_str),bDate=new Date(Date.parse(beginDateStr)),eDate=new Date(Date.parse(endDateStr));if(bDate>eDate&&!applyEditParam.isNextDay)return void alert("同一天加班开始时间不可大于结束时间");if(applyEditParam.isNextDay&&applyEditParam.end_time_str>"06:00")return void alert("加班跨天，结束时间必须小于次日06:00");var callBack=function(){apply.overtimeShowEditWin=!1};return""==applyEditParam.note?void alert("请填写加班工作说明"):Publicfactory.checkEnCnstrlen(applyEditParam.note)>200?(alert("工作说明必须100字以内"),!1):(apply_param.currentDay=filtersModel.filterTime(apply_param.currentDay),void applyModel.applyEdit($scope,callBack))};var closeWin=function(){apply.customShowEditWin=!1};apply.abc=function(){var group=$scope.group={};$scope.selectedMembers=[],$scope.selectedDeparts=[],group.memberdialog=!1;var fields="",currentType="";$scope.att=[],$scope.addFileBtn=function(Uploader,element){Uploader.url="/index.php?r=apply/apply/upload";for(var ele=element.parents(".borderbor").find("ul"),filenamelength=ele.find(".filesize"),fileaftersize=0,i=0;i<filenamelength.length;i++)fileaftersize+=parseFloat(filenamelength.eq(i).html().replace("KB",""));if(fileaftersize=fileaftersize.toFixed(2),element.parents(".borderbor").find(".none").html(fileaftersize),fileaftersize>51200)return alert("总文件大小已超过上限50MB!"),!1;var elesize=element.parents(".borderbor").find(".none").html();Uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){if(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),elesize=parseFloat(elesize)+parseFloat(response.data.data.file_size),elesize>51200)return alert("总文件大小超过50MB，已从上传队列中移除"),!1;var file_root=response.file_root,filefull_path=file_root+"/"+response.data.data.file_path+"/"+response.data.data.real_name,li='<li class="porela"><i class="poabso icon-'+response.data.data.file_type+'"></i><div class="filename fl omit"><a href="'+filefull_path+'" target="_blank">'+response.data.data.file_name+'</a></div><div class="filesize fl omit">'+response.data.data.file_size+'KB</div><div class="del fr">删除</div></li>';ele.append(li),element.parents(".borderbor").find(".none").html(elesize)}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},$(document).on("click",".borderbor .del",function(){$(this).parent().remove();var id=$(this).parent().find(".filename").attr("data-member_id");$scope.selectedMembers.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedMembers.splice(index,1)}),$scope.selectedDeparts.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedDeparts.splice(index,1)})}),$scope.addgroup=function($event,index){$("#masklayer2").show(),fields=angular.element($event.target).attr("id"),currentType=index,0==index?group.departDialogVisble=!0:group.memberDialogVisble=!0},$scope.lishtml=function(i,value,label){var li='<li class="porela"><div class="filename fl omit" data-member_id="'+value+'">'+label+'</div><div class="del fr">删除</div></li>';return li},$scope.cancels=function(index){var index=fields;group.memberDialogVisble=!1,$("#masklayer2").hide();var lis=$("#formpresentation_edit .borderbor").eq(index).find("ul"),targetArray=currentType?$scope.selectedMembers:$scope.selectedDeparts;if(lis.find("li").length<=0)for(var i=0;i<targetArray.length;i++)lis.append($scope.lishtml(i,targetArray[i].value,targetArray[i].label));else{var currentSelectArray=[],selectedArray=[];lis.find("li").each(function(iArray){currentSelectArray.push(parseInt(lis.find("li").eq(iArray).find(".filename").attr("data-member_id")))}),targetArray.forEach(function(item){selectedArray.push({value:parseInt(item.value),label:item.label})}),currentSelectArray=currentSelectArray.sort(function(prev,next){return next-prev}),selectedArray=selectedArray.sort(function(prev,next){return next-prev}),selectedArray.forEach(function(item,index){currentSelectArray.indexOf(item.value)==-1&&lis.append($scope.lishtml(void 0,item.value,item.label))})}}},apply.abc(),apply.formSave=function(){if(formshowfactory.formshowsave(JSON.parse($scope.apply.detail.form_json))){var showFormssave=new jQuery.showeditForm,result=showFormssave.saveForm();$scope.applyEditParam=result,$scope.applyEditParam.apply_id=applyEditParam.apply_id,applymobileModel.applyEdit($scope,closeWin)}};var leave_apply=$scope.leave_apply={},apply_param=$scope.apply_param={};apply_param.apply_id="",apply_param.type="",apply_param.begin_time="",apply_param.end_time="",apply_param.leave_sum="",apply_param.content="",apply_param.att="",leave_apply.apply_id="",leave_apply.leaveApplyInfo="",leave_apply.typestr="",leave_apply.isLeaveEditApplyWin=!1,apply.isLeaveDetailApplyWin=!1,apply.isDetailBtn=!1,apply.leaveType=[],apply.typeSum="",leave_apply.getLeaveApplyTypeSum=function(){apply.typeSum.sum1="",apply.typeSum.sum2="",apply.typeSum.sum3="",1!=apply_param.type&&2!=apply_param.type&&3!=apply_param.type||leaveApplyModel.getLeaveApplyTypeSum($scope)},leave_apply.saveLeaveApplyBtn=function(){return reg=/^[1-9]\d*(\.\d+)?$/,reg.test(apply_param.leave_sum)?10*apply_param.leave_sum%5!=0?(alert("休假必须以0.5天为最小单位！"),!1):checkModel.checkStrLen(apply_param.content)>200?(alert("详细说明必须100字以内"),!1):(apply_param.att=$scope.att,void leaveApplyModel.editLeaveApply($scope)):(alert("请输入正确的休假天数！"),!1)},leave_apply.closeEditLeaveApplyBtn=function(){leaveApplyModel.closeEditLeaveApply($scope),$("#masklayer1").hide()},apply.downFileBtn=function(obj){noticeModel.fileDownload($scope,obj.file_path,obj.real_name,obj.file_name)},$scope.addAttBtn=function(Uploader){Uploader.url="/index.php?r=apply/apply/upload",Uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),$scope.att.push(response.data.data),apply.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFileBtn=function(index){$scope.att.splice(index,1)},apply.rankApplySubmit=function(){},apply.addRankFileBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),apply.rankFiles.push(response.data.data),apply.file_root=response.file_root,applyEditParam.att=apply.rankFiles):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.rankDelFiles=function(index){apply.rankFiles.splice(index,1)},apply.rankEditSubmit=function(){var applyEditCancel=function(){apply.rankEditPopup=!1,$("#masklayer1").hide()};return applyEditParam.note=$scope.apply.rankApplyDesc,void 0==apply.rankApplyDesc||0==apply.rankApplyDesc.length?void alert("请输入职级申请内容！"):void 0!=apply.rankApplyDesc&&Publicfactory.checkEnCnstrlen(apply.rankApplyDesc)>1e3?(alert("职级申请内容不能超过500字！"),!1):0==apply.rankFiles.length?(alert("请添加附件！"),!1):void applyModel.applyEdit($scope,applyEditCancel)},apply.editPopupCtr=function(popupStatus){switch(popupStatus){case"3":apply.drainPopup=!1,apply.drainDetailPopup=!1;break;case"5":apply.rankEditPopup=!1,apply.rankPopup=!1;break;case"6":apply.rankPopup=!1,apply.rankEditPopup=!0;break;case"7":apply.drainPopup=!0,apply.drainDetailPopup=!1;break;case"8":apply.flexibleDetailWorkPopup=!1,apply.flexibleWorkPopup=!0;break;case"9":apply.flexibleDetailWorkPopup=!1,apply.flexibleWorkPopup=!1}},apply.drainTimePoint=function(timePoint){apply.is_am=timePoint},apply.drainPunchSub=function(){if(apply.drainDesc=$scope.apply.drainDesc,0==apply.drainDesc.length||Publicfactory.checkEnCnstrlen(apply.drainDesc)>200)return void alert("请输入忘打卡说明,且最多只能输入100个字！");var applyEditCancel=function(){apply.drainPopup=!1,$("#masklayer1").hide()};return apply.beginTime>apply.curTime?void alert("忘打卡时间超期，请从新选择！"):(applyEditParam.note=apply.drainDesc,applyEditParam.is_am=apply.is_am,applyEditParam.check_date=$scope.apply.beginTime,console.log(applyEditParam.check_date),void applyModel.applyEdit($scope,applyEditCancel))},apply.editPopup=!1,apply.timePoint=[],apply.beginTime=apply.myDate.valueOf(),apply.endTime=apply.myDate.valueOf(),apply.workTimePoint="",apply.desc="",apply.files=[],apply.info={},apply.id="",$scope.att=[],$scope.addFlexibleBtn=function(uploader){uploader.url="/index.php?r=apply/apply/upload",uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),apply.files.push(response.data.data),apply.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFlexibleFiles=function(index){apply.files.splice(index,1)},apply.submitFlexibleWorkInfo=function(){if(apply.desc=$scope.apply.desc,applyEditParam.begin_time=Date.parse(new Date($scope.apply.beginTime))/1e3,applyEditParam.end_time=Date.parse(new Date($scope.apply.endTime))/1e3,applyEditParam.store_id=$scope.apply.flexibleWork.id,applyEditParam.att=apply.files,applyEditParam.note=apply.desc,applyEditParam.store_id<=0)return void alert("请选择需抵用的加班时间!");if(applyEditParam.begin_time>=applyEditParam.end_time)return void alert("申请结束时间不能大于等于开始时间，请重新选择！");if(0==apply.desc.length||Publicfactory.checkEnCnstrlen(apply.desc)>200)return alert("请输入详细说明,且最多只能输入100个字！"),!1;var flexibleWork=function(){apply.flexibleWorkPopup=!1};applyModel.applyEdit($scope,flexibleWork),$("#masklayer1").hide(),apply.flexibleWorkPopup=!1},parseInt($stateParams.apply_id)&&parseInt($stateParams.model_id)&&apply.detailApply($stateParams.apply_id,parseInt($stateParams.model_id)),angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor").length&&angular.element(".selectbor  ul").hide()}),apply.showmask=function(){$("#masklayer2").show()},apply.hidemask=function(){$("#masklayer2").hide()},apply.chehuihidemask=function(){$("#masklayer1").hide()},apply.toEditApply=function(apply_id,model_id){window.location.href="/index_news.html#/applymobile/mine/"+apply_id+"/0/1"},apply.editApply=function(apply_id,model_id){parseInt($stateParams.action_type)?apply.customShowEditWin=!0:apply.customShowWin=!0,$("#masklayer1").show(),$(".mainsbar").css({"overflow-y":"hidden"}),2==model_id?(leave_apply.apply_id=apply_id,leaveApplyModel.getLeaveApplyType($scope),leaveApplyModel.getLeaveApplyDetail($scope,!0)):1==$stateParams.action_type&&(applymobileModel.applyDetail($scope,apply_id,1),applyEditParam=$scope.applyEditParam={},applyEditParam.apply_id=apply_id,model_id=parseInt(model_id))}($stateParams.apply_id,$stateParams.model_id),apply.detailApply=function(apply_id,model_id){parseInt($stateParams.action_type)?apply.customShowEditWin=!0:apply.customShowWin=!0,$("#masklayer1").show(),$(".mainsbar").css({"overflow-y":"hidden"}),2==model_id?(leave_apply.apply_id=apply_id,leaveApplyModel.getLeaveApplyDetail($scope,!1)):0==$stateParams.action_type&&(applymobileModel.applyDetail($scope,apply_id,0),applyEditParam.apply_id=apply_id)}($stateParams.apply_id,$stateParams.model_id),$(document).on("click","a",function(event){event.preventDefault()})});
ApplymobileMod.controller("AgentApplyListmobileController",function($scope,$http,$state,$rootScope,$stateParams,Publicfactory,applyModel,applymobileModel,leaveApplyModel,noticeModel,permissionService){$scope.isAgent=!0;var apply=$scope.apply={},applyParams=$scope.applyParams={},apply_approve=$scope.apply_approve={};apply.tempDay="",apply.status=0,apply.rankDetail=[],apply.rankLevel="",applyParams.status=0,applyParams.model_id=0,applyParams.begin="",applyParams.end="",applyParams.serach="",apply.apply_id="",apply.rankDetailPopup=!1,apply.drainPunchPopup=!1,apply.showVieryRankPopup=!1,apply.showRefuseRankPopup=!1,apply.showVieryLastRankPopup=!1,apply.showVieryDrainPopup=!1,apply.showRefuseDrainPopup=!1,apply.flexibleWorkPopup=!1,apply.flexibleWorkDetailList=[],apply.flexibleWorkVieryPopup=!1,apply.flexibleWorkRefusePopup=!1,applyParams.page=1,$scope.att=[],apply.file_root="",apply.showVieryWin=!1,apply.showRefuseWin=!1,apply.batchResWin=!1,apply.level_rank="",apply.comment="",apply.score=0,apply.isOvertimeLastStepWin=!1,apply.modeltype="",apply_approve.apply_id="",apply_approve.comment="",apply_approve.leave_sum="",apply_approve.real_hours="",apply_approve.begin_time="",apply_approve.end_time="",$scope.page={curPage:1,tempcurPage:1,sumPage:0},apply.arrStatus=[{text:"待审批",value:0},{text:"已审批",value:1},{text:"已拒绝",value:2}],apply.isStatusWin=!1,apply.statusWinButton=function(){$("#applyType").hide(),angular.element("#projectInfo").is(":hidden")?angular.element("#projectInfo").show():angular.element("#projectInfo").hide()},apply.selectSearchStatus=function(status){applyParams.status=status,angular.element.each(apply.arrStatus,function(key,val){val.value==status&&angular.element("#status").html(val.text)}),apply.isStatusWin=!1,angular.element("#projectInfo").hide()},apply.modelList=[],applyModel.getApplyModel($scope),apply.modelWinButton=function(){$("#projectInfo").hide(),angular.element("#applyType").is(":hidden")?angular.element("#applyType").show():angular.element("#applyType").hide()},apply.selectSearchModel=function(modelId){applyParams.model_id=modelId,angular.element.each(apply.modelList,function(key,val){val.model_id==modelId&&angular.element("#model").html(val.title)}),apply.isModelWin=!1,$("#applyType").hide()},applyModel.getMyAgentList($scope),apply.selected=[],apply.selectAll=function($event){apply.selected=[];var checkbox=$event.target;checkbox.checked&&angular.forEach(apply.list,function(tmpObj){tmpObj.allowBatch&&apply.selected.push(parseInt(tmpObj.apply_id))})},apply.clearAll=function(){angular.element("#selectAll").prop("checked",!1),apply.selected=[]},apply.updateSelected=function(action,id){var id=parseInt(id);if("add"==action&&apply.selected.indexOf(id)==-1&&apply.selected.push(id),"remove"==action&&apply.selected.indexOf(id)!=-1){var idx=apply.selected.indexOf(id);apply.selected.splice(idx,1)}},apply.updateSelection=function($event,id){var id=parseInt(id),checkbox=$event.target,action=checkbox.checked?"add":"remove";apply.updateSelected(action,id)},apply.isSelected=function(id){var id=parseInt(id);return apply.selected.indexOf(id)>=0},apply.clickBatchVerify=function(){var checkeds=$(".applytablelistbor li .checkbox:checked").length;return checkeds<=0?(alert("请选择申请单"),!1):(apply.showVieryWin=!0,apply.verifyComment="",void apply.showmask())},apply.clickBatchRefuse=function(){var checkeds=$(".applytablelistbor li .checkbox:checked").length;return checkeds<=0?void alert("请选择申请单"):(apply.showRefuseWin=!0,apply.refuseComment="",void apply.showmask())},apply.verifyComment="",apply.verifyBatch=function(){return apply.selected.length<=0?void alert("请选择申请单"):Publicfactory.checkEnCnstrlen(apply.verifyComment)>100?void alert("内容不能超过50个字!"):(applyModel.verifyBatch($scope),void apply.clearAll())},apply.refuseComment="",apply.refuseBatch=function(){return apply.selected.length<=0?void alert("请选择申请单"):""==apply.refuseComment?void alert("请填写驳回意见"):Publicfactory.checkEnCnstrlen(apply.refuseComment)>100?void alert("内容不能超过50个字!"):(applyModel.refuseBatch($scope),void apply.clearAll())},apply.closeBatchResWin=function(){$scope.apply.successNum="",$scope.apply.failNum="",$scope.apply.failList=[],apply.batchResWin=!1,$("#masklayer1").hide()},apply.search=function(){apply.status=applyParams.status,apply.clearAll(),$scope.page={curPage:1,tempcurPage:1,sumPage:0},$scope.applyParams.page=1,applyModel.getMyAgentList($scope)},$scope.page_fun=function(){apply.clearAll(),$scope.applyParams.page=$scope.page.tempcurPage,applyModel.getMyAgentList($scope)};var leave_apply=$scope.leave_apply={},apply_param=$scope.apply_param={};apply_param.apply_id="",apply_param.type="",apply_param.begin_time="",apply_param.end_time="",apply_param.leave_sum="",apply_param.content="",apply_param.att="",leave_apply.apply_id="",leave_apply.model_id="",leave_apply.leaveApplyInfo="",leave_apply.typestr="",leave_apply.isLeaveEditApplyWin=!1,apply.isLeaveDetailApplyWin=!1,apply.isDetailBtn=!0,leave_apply.isLeaveLastStepWin=!1,leave_apply.last_begin_time="",leave_apply.last_end_time="",leave_apply.isShowVieryWin=!1,leave_apply.isShowRefuseWin=!1,leave_apply.comment="",apply.leaveType=[],apply.typeSum="",leave_apply.closeEditLeaveApplyBtn=function(){leaveApplyModel.closeEditLeaveApply($scope),$("#masklayer1").hide(),leave_apply.isShowRefuseWin=!1,apply.showVieryDrainPopup=!1},apply.downFileBtn=function(obj){noticeModel.fileDownload($scope,obj.file_path,obj.real_name,obj.file_name,obj.file_size)},leave_apply.openVerifyWin=function(){leave_apply.comment="",leave_apply.isShowVieryWin=!0,leave_apply.isShowRefuseWin=!1},leave_apply.openLeaveLastStepWin=function(){leave_apply.comment="",apply.tempDay=apply_param.leave_sum,leaveApplyModel.getLeaveClockTime($scope)},leave_apply.showAgreeWin=function(){apply_approve.real_hours="",apply_approve.begin_time="",apply_approve.end_time="",leave_apply.last_begin_time="",leave_apply.last_end_time="",1==apply.modeltype?1==leave_apply.model_id?$scope.apply.detail.last_step?leave_apply.openOvertimeLastStepWin():leave_apply.openVerifyWin():2==leave_apply.model_id&&(leave_apply.leaveApplyInfo.last_step?leave_apply.openLeaveLastStepWin():leave_apply.openVerifyWin()):leave_apply.openVerifyWin()},leave_apply.verifyBtn=function(){if(2==leave_apply.model_id)if(leave_apply.leaveApplyInfo.last_step){if(reg=/^[0-9]\d*(\.\d+)?$/,!reg.test(apply_param.leave_sum))return alert("请输入正确的休假天数！"),!1;if(apply_param.leave_sum<=0)return alert("请输入正确的休假天数！"),!1;if(10*apply_param.leave_sum%5!=0)return alert("休假必须以0.5天为最小单位！"),!1;apply_approve.leave_sum=apply_param.leave_sum}else apply_approve.leave_sum="";return leave_apply.comment=leave_apply.comment.replace(/(^\s*)/g,""),Publicfactory.checkEnCnstrlen(leave_apply.comment)>100?(alert("同意原因不能超过50个汉字！"),!1):(apply_approve.apply_id=leave_apply.apply_id,apply_approve.comment=leave_apply.comment,applymobileModel.verify($scope),void 0)},leave_apply.openRefuseWin=function(){leave_apply.comment="",leave_apply.isShowVieryWin=!1,leave_apply.isShowRefuseWin=!0},leave_apply.refuseBtn=function(){return leave_apply.comment=leave_apply.comment.replace(/(^\s*)/g,""),""==leave_apply.comment?(alert("请填写驳回意见"),!1):Publicfactory.checkEnCnstrlen(leave_apply.comment)>100?(alert("驳回意见不能超过50个汉字"),!1):(leave_apply.isShowRefuseWin=!1,apply_approve.apply_id=leave_apply.apply_id,apply_approve.comment=leave_apply.comment,applymobileModel.refuse($scope),void 0)},$scope.addAttBtn=function(Uploader){Uploader.url="/index.php?r=apply/apply/upload",Uploader.onCompleteItem=function(fileItem,response,status,headers){1==response.code?(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),$scope.att.push(response.data.data),leave_apply.leaveApplyInfo.file_root=response.file_root):0==response.code&&(fileItem.remove(),alert(response.msg))}},apply.delFileBtn=function(index){$scope.att.splice(index,1)},leave_apply.openOvertimeLastStepWin=function(){leave_apply.comment="",apply.tempDay=apply_param.leave_sum,applyModel.getOvertimeClockTime($scope)},apply.popupCtr=function(statusCtr){switch(statusCtr){case"1":break;case"2":break;case"3":apply.drainPunchPopup=!1;break;case"5":apply.rankDetailPopup=!1;break;case"7":apply.showVieryRankPopup=!0;break;case"8":apply.showVieryRankPopup=!1;break;case"9":apply.showRefuseRankPopup=!0;break;case"10":apply.showRefuseRankPopup=!1;break;case"11":apply.showVieryLastRankPopup=!0,$http.post("/index.php?r=apply/apply/get-rank-level",{detailId:apply.rankDetail.detail_id}).success(function(data){2e4==data.code&&(apply.level_rank=data.data.rank_level)});break;case"12":apply.showVieryLastRankPopup=!1;break;case"13":apply.showVieryDrainPopup=!0;break;case"14":apply.showRefuseDrainPopup=!0;break;case"15":apply.showVieryDrainPopup=!1;break;case"16":apply.showRefuseDrainPopup=!1}apply.comment.length>0&&(apply.comment="")},apply.popupCtrClose=function(){$("#masklayer1").hide(),apply.showVieryDrainPopup=!1,apply.showRefuseRankPopup=!1,apply.showRefuseDrainPopup=!1,apply.showVieryLastRankPopup=!1},apply.customHideWin=function(){$("#masklayer1").hide(),leave_apply.isShowRefuseWin=!1,leave_apply.isShowVieryWin=!1},apply.rankVieryCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.score=$scope.apply.score,apply_approve.comment=$scope.apply.comment,apply_approve.level_rank=$scope.apply.level_rank,Publicfactory.checkEnCnstrlen(apply_approve.level_rank)<=0?void alert("请填写职级评定"):Publicfactory.checkEnCnstrlen(apply_approve.comment)>100||0==Publicfactory.checkEnCnstrlen(apply_approve.comment)?void alert("请输入同意原因，且不能超过50个汉字!"):void applyModel.verify($scope)},apply.rankVieryLastCtr=function(step,last_step){var isNub=/^([1-9]\d*|[0]{1,1})$/;if(apply_approve.apply_id=apply.apply_id,apply_approve.score=$scope.apply.score,apply_approve.level_rank=$scope.apply.level_rank,apply_approve.comment=$scope.apply.comment,1==last_step){if(0==Publicfactory.checkEnCnstrlen(apply_approve.level_rank)||Publicfactory.checkEnCnstrlen(apply_approve.level_rank)>20)return void alert("请填写职级评定,且最多只能输入10个字!");if(!isNub.test(apply_approve.score)||apply_approve.score>=1e8)return void alert("请填写积分奖励,且为不能超过100000000的正整数!")}else if(1==step&&0==last_step){if(0==Publicfactory.checkEnCnstrlen(apply_approve.level_rank)||Publicfactory.checkEnCnstrlen(apply_approve.level_rank)>20)return void alert("请填写职级评定,且最多只能输入10个字!");if(Publicfactory.checkEnCnstrlen(apply_approve.comment)>100)return void alert("请填写同意原因，且最多只能输入50个字!")}else if(1!=step&&0==last_step&&Publicfactory.checkEnCnstrlen(apply_approve.comment)>100)return void alert("请填写同意原因，且最多只能输入50个字!");applyModel.verify($scope)},apply.rankRefuseCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=$scope.apply.comment,apply_approve.comment.length<=0||Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请填写驳回原因,且不能超过50个字!"):void applyModel.refuse($scope)},apply.drainVieryCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=$scope.apply.comment,Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("同意原因不能超过50个字!"):(applyModel.verify($scope),apply.drainPunchPopup=!1,apply.showVieryDrainPopup=!1,$("#masklayer1").hide(),void 0)},apply.drainRefuseCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=$scope.apply.comment,apply_approve.comment.length<=0||Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请填写驳回原因,且不能超过50个字!"):void applyModel.refuse($scope)},apply.flexibleWorkComment="",apply.flexibleWorkViery=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=apply.flexibleWorkComment,Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请输入同意原因，且不能超过50个字!"):void applyModel.verify($scope)},apply.flexibleWorkRefuseCtr=function(){return apply_approve.apply_id=apply.apply_id,apply_approve.comment=apply.flexibleWorkComment,0==apply_approve.comment.length||Publicfactory.checkEnCnstrlen(apply_approve.comment)>100?void alert("请填写驳回原因，且不能超过50个字!"):void applyModel.refuse($scope)},parseInt($stateParams.apply_id)&&parseInt($stateParams.model_id)&&"undefined"!=typeof $stateParams.model_type&&""!=$stateParams.model_type&&apply.detailApply($stateParams.model_id,$stateParams.apply_id,$stateParams.model_type),angular.element(document).bind("click",function(event){0==angular.element(event.target).parents(".selectbor").length&&angular.element(".selectbor  ul").hide()}),apply.showmask=function(){$("#masklayer1").show()},apply.hidemask=function(){$("#masklayer1").hide()},apply.detailApply=function(model_id,apply_id,modeltype){switch($("#masklayer1").show(),$(".mainsbar").css({"overflow-y":"hidden"}),apply.modeltype=modeltype,model_id){case"1":leave_apply.apply_id=apply_id,leave_apply.model_id=model_id,applyModel.applyDetail($scope,apply_id),apply.overtimeShowWin=!0;break;case"2":leave_apply.apply_id=apply_id,leave_apply.model_id=model_id,leaveApplyModel.getLeaveApplyDetail($scope,!1);break;case"3":apply.drainPunchPopup=!0,apply.apply_id=apply_id,applyModel.rankDetail($scope,apply.apply_id);break;case"4":apply.flexibleWorkPopup=!0,apply.apply_id=apply_id,applyModel.applyDetail($scope,apply.apply_id);break;case"5":apply.rankDetailPopup=!0,apply.apply_id=apply_id,applyModel.rankDetail($scope,apply.apply_id);break;default:leave_apply.apply_id=apply_id,leave_apply.model_id=model_id,apply.customShowWin=!0,apply.apply_id=apply_id,applymobileModel.applyDetail($scope,apply_id,0)}}($stateParams.model_id,$stateParams.apply_id,$stateParams.modeltype),$(document).on("click","a",function(event){event.preventDefault()})});
ApplymobileMod.controller("CustomApplymobileCreateCtrl",function($scope,$http,$location,$timeout,$rootScope,$state,$stateParams,Publicfactory,applymobileModel,applySetModel,formshowfactory){var apply=$scope.apply={},model=$scope.model={},model_id=($scope.apply_param={},$stateParams.model_id),group=$scope.group={};$scope.selectedMembers=[],$scope.selectedDeparts=[],group.memberdialog=!1;var fields="",currentType="";$scope.att=[],$("#masklayer1").show(),$location.path().indexOf("/customcreate")>0&&$timeout(function(){$(".mainsbar").css({"overflow-y":"hidden"})}),$scope.addFileBtn=function(Uploader,element){Uploader.url="/index.php?r=apply/apply/upload";for(var ele=element.parents(".borderbor").find("ul"),filenamelength=ele.find(".filesize"),fileaftersize=0,i=0;i<filenamelength.length;i++)fileaftersize+=parseFloat(filenamelength.eq(i).html().replace("KB",""));if(fileaftersize=fileaftersize.toFixed(2),element.parents(".borderbor").find(".none").html(fileaftersize),fileaftersize>51200)return alert("总文件大小已超过上限50MB!"),!1;var elesize=element.parents(".borderbor").find(".none").html();Uploader.onCompleteItem=function(fileItem,response,status,headers){if(1==response.code){if(response.data.data.file_size=(response.data.data.file_size/1024).toFixed(2),elesize=parseFloat(elesize)+parseFloat(response.data.data.file_size),elesize>51200)return alert("总文件大小超过50MB，已从上传队列中移除"),!1;var file_root=response.file_root,filefull_path=file_root+"/"+response.data.data.file_path+"/"+response.data.data.real_name,li='<li class="porela"><i class="poabso icon-'+response.data.data.file_type+'"></i><div class="filename fl omit"><a href="'+filefull_path+'" target="_blank">'+response.data.data.file_name+'</a></div><div class="filesize fl omit">'+response.data.data.file_size+'KB</div><div class="del fr">删除</div></li>';ele.append(li),element.parents(".borderbor").find(".none").html(elesize)}else 0==response.code&&(fileItem.remove(),alert(response.msg))}},$(document).on("click","a",function(event){event.preventDefault()}),$(document).on("click",".borderbor .del",function(){$(this).parent().remove();var id=$(this).parent().find(".filename").attr("data-member_id");$scope.selectedMembers.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedMembers.splice(index,1)}),$scope.selectedDeparts.forEach(function(item,index){item.value==parseInt(id)&&$scope.selectedDeparts.splice(index,1)})}),$scope.addgroup=function($event,index){$("#masklayer2").show(),fields=angular.element($event.target).attr("id"),currentType=index,0==index?group.departDialogVisble=!0:group.memberDialogVisble=!0},$scope.lishtml=function(i,value,label){var li='<li class="porela"><div class="filename fl omit" data-member_id="'+value+'">'+label+'</div><div class="del fr">删除</div></li>';return li},$scope.cancels=function(index){var index=fields;group.memberDialogVisble=!1,$("#masklayer2").hide();var lis=$(".borderbor").eq(index).find("ul");if($scope.selectedMembers.length>0||$scope.selectedDeparts.length>0){var targetArray=currentType?$scope.selectedMembers:$scope.selectedDeparts;if(lis.find("li").length<=0)for(var i=0;i<targetArray.length;i++)lis.append($scope.lishtml(i,targetArray[i].value,targetArray[i].label));else{var currentSelectArray=[],selectedArray=[];lis.find("li").each(function(iArray){currentSelectArray.push(parseInt(lis.find("li").eq(iArray).find(".filename").attr("data-member_id")))}),targetArray.forEach(function(item){selectedArray.push({value:parseInt(item.value),label:item.label})}),currentSelectArray=currentSelectArray.sort(function(prev,next){return next-prev}),selectedArray=selectedArray.sort(function(prev,next){return next-prev}),selectedArray.forEach(function(item,index){currentSelectArray.indexOf(item.value)==-1&&lis.append($scope.lishtml(void 0,item.value,item.label))})}}},$(".formsave").click(function(){if(formshowfactory.formshowsave(model.formshowdata)){var showFormssave=new jQuery.showeditForm,result=showFormssave.saveForm();$scope.apply_param=result,$scope.apply_param.model_id=model_id,applymobileModel.createApply($scope)}}),applySetModel.showModel($scope,model_id,1),apply.cancel=function(){$state.go("^"),$("#masklayer1").hide()}});
ApplymobileMod.factory("applymobileModel",function($http,$state,filtersModel,formshowfactory,$compile){var service={};return service.getMyApplyList=function($scope){$http.post("/index.php?r=apply/apply/apply-list",JSON.stringify($scope.applyParams)).success(function(data,status){$scope.apply.list=data.list,$scope.page.curPage=data.curPage,$scope.page.sumPage=data.sumPage})},service.getMyAgentList=function($scope){$http.post("/index.php?r=apply/apply/apply-agent",JSON.stringify($scope.applyParams)).success(function(data,status){$scope.apply.list=data.list,$scope.page.curPage=data.curPage,$scope.page.sumPage=data.sumPage})},service.getApplyModel=function($scope){$http.get("/index.php?r=apply/apply-model/model-list").success(function(data){$scope.apply.modelList=data.data,$scope.apply.modelList.unshift({model_id:0,title:"申请单名称"})})},service.delApply=function(apply_id,$scope){$http.get("/index.php?r=apply/apply/apply-del&apply_id="+apply_id).success(function(data){if(alert(data.msg),1==data.code)return void(window.location.href="longtuoa://oa.com/myapplylist")})},service.press=function(apply_id,$scope){$http.get("/index.php?r=apply/apply/press&apply_id="+apply_id).success(function(data){alert(data.msg),1==data.code})},service.revoke=function(apply_id,$scope,applyStatus){$http.get("/index.php?r=apply/apply/revoke&apply_id="+apply_id).success(function(data){if(alert(data.msg),1==data.code)return void(window.location.href="longtuoa://oa.com/myapplylist")})},service.getUsefulModel=function($scope){$http.get("/index.php?r=apply/apply-model/useful-list").success(function(data){$scope.applyApp.modelList=data.data})},service.getAllModel=function($scope){$http.get("/index.php?r=apply/apply-model/model-list").success(function(data){$scope.model.modelList=data.data})},service.verifyBatch=function($scope){$http.post("/index.php?r=apply/apply/batch-verify",{apply_ids:$scope.apply.selected,comment:$scope.apply.verifyComment}).success(function(data){$scope.apply.successNum=data.data.successNum,$scope.apply.failNum=data.data.failNum,$scope.apply.failList=data.data.failList,$scope.apply.verifyComment="",$scope.apply.batchResWin=!0,$scope.apply.showVieryWin=!1,service.getMyAgentList($scope)})},service.refuseBatch=function($scope){$http.post("/index.php?r=apply/apply/batch-refuse",{apply_ids:$scope.apply.selected,comment:$scope.apply.refuseComment}).success(function(data){$scope.apply.successNum=data.data.successNum,$scope.apply.failNum=data.data.failNum,$scope.apply.failList=data.data.failList,$scope.apply.batchResWin=!0,$scope.apply.showRefuseWin=!1,$scope.apply.refuseComment="",$("#masklayer1").hide(),service.getMyAgentList($scope)})},service.verify=function($scope){$http.post("/index.php?r=apply/apply/verify",JSON.stringify($scope.apply_approve)).success(function(data){return 1==data.code?(alert(data.msg),void window.location.reload()):($scope.apply_param.leave_sum=$scope.apply.tempDay,void alert(data.msg))})},service.refuse=function($scope){$http.post("/index.php?r=apply/apply/refuse",JSON.stringify($scope.apply_approve)).success(function(data){return 1==data.code?(alert(data.msg),void window.location.reload()):void alert(data.msg)})},service.editTitle=function(modelId,title,$scope){$http.post("/index.php?r=apply/apply-model/update-title",{model_id:modelId,title:title}).success(function(data){alert(data.msg),1==data.code&&service.getAllModel($scope)})},service.doStop=function(modelId,status,$scope){$http.post("/index.php?r=apply/apply-model/model-state",{model_id:modelId,status:status}).success(function(data){alert(data.msg),1==data.code&&service.getAllModel($scope)})},service.doDel=function(modelId,$scope){$http.get("/index.php?r=apply/apply-model/model-delete&model_id="+modelId).success(function(data){alert(data.msg),1==data.code&&service.getAllModel($scope)})},service.rankDetail=function($scope,applyId){$http.get("/index.php?r=apply/apply/show-detail&apply_id="+applyId).success(function(data){$scope.apply.rankDetail=data.data,$scope.apply.file_root=data.data.file_root})},service.createApply=function($scope){$http.post("/index.php?r=apply/apply/create-apply",JSON.stringify($scope.apply_param)).success(function(data,status){return 1==data.code?(alert(data.msg),void(window.location.href="longtuoa://oa.com/myapplylist")):void alert(data.msg)})},service.applyDetail=function($scope,applyId,action){$http.get("/index.php?r=apply/apply/show-detail&apply_id="+applyId).success(function(data){$scope.apply.detail=data.data,$scope.apply.file_root=$scope.apply.detail.file_root,1==$scope.apply.detail.model_id&&($scope.apply.detail.data.begin_time=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.begin_time),$scope.apply.detail.data.end_time=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.end_time),$scope.apply.detail.data.currentDay=filtersModel.filterTime(1e3*$scope.apply.detail.data.overtime),$scope.apply.detail.data.isNextDay=1==$scope.apply.detail.data.is_next_day),3==$scope.apply.detail.model_id&&($scope.apply.beginTime=filtersModel.filterTime(1e3*$scope.apply.detail.data.check_date),1==$scope.apply.detail.data.is_am?$scope.apply.drainCheckAm=!0:2==$scope.apply.detail.data.is_am&&($scope.apply.drainCheckPm=!0),1==action&&($scope.apply.detail.data.isShowPage=!0),$scope.apply.drainDesc=$scope.apply.detail.data.note),4==$scope.apply.detail.model_id&&($scope.apply.flexibleWorkDetailList=data.data,$scope.apply.beginTime=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.begin_time),$scope.apply.endTime=filtersModel.filterDateTime(1e3*$scope.apply.detail.data.end_time),$scope.apply.workTimePoint=$scope.apply.detail.data.flexibleWorkTime,$scope.apply.id=$scope.apply.detail.data.store_id,$scope.apply.desc=$scope.apply.detail.data.note,$scope.apply.files=$scope.apply.detail.data.att,service.getFlexibleWorkTimePoint($scope,2),1==action&&($scope.apply.detail.data.isShowPage=!0)),5==$scope.apply.detail.model_id&&(1==action&&($scope.apply.detail.data.isShowPage=!0),$scope.apply.rankApplyDesc=$scope.apply.detail.data.note,$scope.apply.rankFiles=$scope.apply.detail.data.att),$scope.apply.detail.model_id>5&&setTimeout(function(){formshowfactory.formshow(JSON.parse(data.data.form_json),$compile,$scope,action)},1500)})},service.applyEdit=function($scope,callBack){$http.post("/index.php?r=apply/apply/edit-apply",JSON.stringify($scope.applyEditParam)).success(function(data){if(alert(data.msg),1==data.code)return void(window.location.href="longtuoa://oa.com/myapplylist")})},service.getOvertimeClockTime=function($scope){$http.get("/index.php?r=apply/apply/overtime&apply_id="+$scope.leave_apply.apply_id).success(function(data){1==data.code?($scope.apply_approve.end_time=data.data.end_time,$scope.apply_approve.begin_time=data.data.begin_time,$scope.apply_approve.real_hours=data.data.real_hours,$scope.apply.isOvertimeLastStepWin=!0):alert(data.msg)})},service.getFlexibleWorkTimePoint=function($scope,i){$http.post("/index.php?r=apply/apply/flexible-work").success(function(data){1==i?$scope.flexibleWork.timePoint=data.data:2==i&&($scope.apply.timePoint=data.data,angular.forEach(data.data,function(val,key){$scope.apply.workTimePoint==val.timeOutData&&($scope.apply.flexibleWork=val)}))})},service.closeMark=function($scope){$("#masklayer1").hide(),$scope.apply.isLeaveDetailApplyWin=!1},service});
ApplymobileMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/applymobile/view/";$stateProvider.state("main.applymobile",{url:"/applymobile",module:"private",data:{css:["css/applymobile.css","css/apply.css","css/lib/mobiledatetimepicker.css"]},views:{"applyContent@main":{templateUrl:basePath+"apply_content.html",controller:"ApplyMobileController"}}}).state("main.applymobile.application",{url:"/application",module:"private",views:{"apply_application@main.applymobile":{templateUrl:basePath+"apply_model_list.html",controller:"ApplymobileAppController"}}}).state("main.applymobile.application.overtimecreate",{url:"/overtimecreate/:model_id",module:"private",data:{css:["css/lib/mobiledatetimepicker.css"]},views:{"overtime_apply@main.applymobile":{templateUrl:basePath+"overtime_apply_create.html",controller:"OvertimeApplymobileCreateCtrl"}}}).state("main.applymobile.application.leaveapplycreate",{url:"/leaveapplycreate",module:"private",views:{"leave_apply@main.applymobile":{templateUrl:basePath+"leave_apply_create.html",controller:"LeaveApplymobileCreateCtrl"}}}).state("main.applymobile.application.drainPunchApply",{url:"/drainPunchApply",module:"private",views:{"apply_drainPunchApply@main.applymobile":{templateUrl:basePath+"drainPunch_apply.html",controller:"drainPunchmobileCtrl"}}}).state("main.applymobile.application.rankApply",{url:"/rankApply",module:"private",views:{"apply_rankApply@main.applymobile":{templateUrl:basePath+"rank_apply.html",controller:"rankApplymobileCtrl"}}}).state("main.applymobile.application.flexibleWork",{url:"/flexibleWork",module:"private",views:{"apply_flexibleWork@main.applymobile":{templateUrl:basePath+"flexible_work_apply.html",controller:"flexibleWorkmobileCtr"}}}).state("main.applymobile.mine",{url:"/mine/:apply_id/:model_id/:action_type",module:"private",views:{"apply_mine@main.applymobile":{templateUrl:basePath+"apply_myapply_list.html",controller:"MyApplyListmobileController"}}}).state("main.applymobile.application.customcreate",{url:"/customcreate/:model_id",module:"private",views:{"leave_apply@main.applymobile":{templateUrl:basePath+"apply_custom_create.html",controller:"CustomApplymobileCreateCtrl"}}}).state("main.applymobile.agent",{url:"/agent/:apply_id/:model_id/:modeltype",module:"private",views:{"apply_agent@main.applymobile":{templateUrl:basePath+"apply_agent_list.html",controller:"AgentApplyListmobileController"}}})}]);
var ColleagueMod=angular.module("ColleagueMod",[]);ColleagueMod.controller("WorkCtr",function($scope,$rootScope,$state,ColleagueModel){var work=$scope.Work={};$scope.allMembers=[],$scope.WorkingConditions=[],work.searchName="",work.currentPage="",work.searchMember="姓名",work.memberShow=!1,ColleagueModel.getAllComMeb($scope,""),ColleagueModel.getWorkingConditions($scope,work.searchName),$scope.page={curPage:1,tempcurPage:1,sumPage:0},work.searchInputMember=function(){work.searchName=$scope.Work.searchName,work.memberShow=!0,ColleagueModel.getAllComMeb($scope,work.searchName)},work.clickInputMember=function(){$scope.page={curPage:1,tempcurPage:1,sumPage:0},ColleagueModel.getWorkingConditions($scope,work.searchName)},work.getSelectName=function(name){$scope.page={curPage:1,tempcurPage:1,sumPage:0},work.searchName=name,work.memberShow=!1},work.dropDownStatusCtr=function(){work.memberShow=!work.memberShow},$(document).bind("click",function(event){0==angular.element(event.target).parents(".mems ").length&&(work.memberShow=!1)}),$scope.workPaging=function(){work.currentPage=$scope.page.tempcurPage,ColleagueModel.getWorkingConditions($scope,work.searchName,"",work.currentPage)}});
ColleagueMod.controller("MyColleagueCtr",function($scope,$state,$http,$compile,$stateParams,ColleagueModel,noticeService,Publicfactory,$cookieStore,permissionService){if(!permissionService.checkPermission("WorkmateMymate"))return $state.go("main.index"),!1;var colleague=$scope.colleague={};$scope.allDepartmentList=[],$scope.allDepartmentChildrenList=[],$scope.DepartmentChildrenList=[],$scope.DepartmentChildOneList=[],$scope.DepartmentChildTwoList=[],$scope.myTeamList=[],$scope.orgNameList=[],colleague.myTeamList=[],colleague.myTeamNubSum="",colleague.memberInfoMess=[],colleague.noticeService=noticeService,colleague.orgId=$cookieStore.get("userInfo").org.org_id,colleague.Uid="",colleague.isLeader="",colleague.companyNubSum="",colleague.departmentCtr=!1,colleague.orgName="",colleague.orgSearchName="",colleague.departmentName="",colleague.departmentNameSearch="纳米娱乐",colleague.sectorSettingsList=[],colleague.sectorSuperiorDepName="",colleague.higherDepartment="",colleague.sectorDepName="",colleague.sectorDepLeader="",colleague.sectorDepOrgId="",colleague.sectorPageOrgId=colleague.orgId,colleague.sectorMemberList=[],colleague.sectorSearchName="",colleague.sectorParentId="",colleague.setSectorParentId="",colleague.gMid="",colleague.transferDepSearName="",colleague.transferDepOrgUid="",colleague.originalDep="",colleague.errorInfo={code:"",msg:""},$scope.page={curPage:1,tempcurPage:1,sumPage:0},$scope.taskPaging=function(){ColleagueModel.myTeamMemberList($scope,colleague.sectorPageOrgId,$scope.page.tempcurPage)},ColleagueModel.myTeamMemberListOne($scope,colleague.orgId),colleague.createPart=!1,colleague.showCreatePart=function(){colleague.createPart=!0,$("#masklayer1").show()},colleague.HideCreatePart=function(){$("#masklayer1").hide(),colleague.createPart=!1},colleague.isShowPartSet=!1,colleague.isShowDissmiss=!1,colleague.isShowTransfer=!1,colleague.isShowAddPrin=!1,ColleagueModel.getAllDepartment($scope,0),colleague.isselected=!0,colleague.selectMsg=function(i,e){e.stopPropagation(),i||(colleague.isselected=!0),i&&(colleague.isselected=!1)},colleague.drop=function(i,ind,e){if(e.stopPropagation(),colleague.isShowTransfer&&(i=2),1==i){var key=0;for(key=0;key<$scope.myTeamList.list.length;key++)ind!=key&&($scope.myTeamList.list[key].isShow=!1);$scope.myTeamList.list[ind].isShow=!$scope.myTeamList.list[ind].isShow,$scope.myTeamList.list[ind].isShow&&$(".msg-detail").show()}else 2==i&&($scope.myTeamList.list[ind].isShow=!1)},colleague.transferDepartmentMemCtr=function(orgUid,uId){$("#masklayer1").show(),colleague.Uid=uId,colleague.isShowTransfer=!0,colleague.transferDepOrgUid=orgUid,ColleagueModel.getOrgInfo($scope,""),ColleagueModel.getTransferDepOrgName($scope,colleague.transferDepOrgUid)},colleague.HideTransfer=function(){$("#masklayer1").hide(),colleague.isShowTransfer=!1},colleague.orgDrop=function(ind){angular.forEach($scope.allDepartmentList,function(one,index){$scope.myTeamList.list[index].isShow=!$scope.myTeamList.list[index].isShow,$scope.myTeamList.list[ind].isShow,2==i&&($scope.myTeamList.list[ind].isShow=!1)})},colleague.departmentShowCtr=function(){colleague.departmentCtr=!0,ColleagueModel.getOrgInfo($scope,"")},colleague.departmentInputCtr=function(){colleague.departmentCtr=!0,ColleagueModel.getOrgInfo($scope,$scope.colleague.departmentNameSearch)},colleague.superiorOrgId="2-0",colleague.selectDepartment=function(orgName,orgID){$scope.colleague.departmentNameSearch=orgName,colleague.superiorOrgId=orgID+"-0",colleague.departmentCtr=!1},colleague.addDepartment=function(){return Publicfactory.checkEnCnstrlen($scope.colleague.departmentNameSearch)<=0?void alert("上级部门不能为空！"):colleague.superiorOrgId.length<=0?void alert("上级部门不存在，请重新选择！"):("纳米娱乐"==$scope.colleague.departmentNameSearch&&(colleague.orgId="2-0"),colleague.departmentName.length>20?void alert("部门名称输入不能超过20个字！"):Publicfactory.checkEnCnstrlen($scope.colleague.departmentName)<=0?void alert("部门名称部门为空！"):void ColleagueModel.addDepartment($scope,colleague.superiorOrgId,$scope.colleague.departmentName))},colleague.getMyGroup=function($event){$scope.page={curPage:1,tempcurPage:1,sumPage:0};var target=angular.element($event.target);target.hasClass("member-num")&&(target=target.parent()),$('.colleague-nav div[class~="col-active"]').removeClass("col-active"),target.addClass("col-active");var icon=target.next().find("i:first-child");icon.html("&#xe60f;").removeClass("down"),target.next().next().remove(),colleague.sectorPageOrgId=colleague.orgId,ColleagueModel.myTeamMemberList($scope,colleague.orgId)},colleague.getGroup=function(parent_id,$event){$scope.page={curPage:1,tempcurPage:1,sumPage:0};var target=angular.element($event.target);(target.hasClass("icon-trigon")||target.hasClass("member-num")||target.hasClass("overf"))&&(target=target.parent()),$('.colleague-nav div[class~="col-active"]').removeClass("col-active"),target.parent().addClass("col-active");var icon=target.find("i:first-child");icon.hasClass("down")?(icon.html("&#xe60f;").removeClass("down"),target.parent().next().remove()):(icon.html("&#xe60b;").addClass("down"),target.parent().parent().siblings().children("ul").remove(),target.parent().parent().siblings().children("div").find('i[class~="down"]').html("&#xe60f;").removeClass("down"),$http.get("/index.php?r=workmate/workmate/list&parent_group_id="+parent_id).success(function(data,status,headers,config){var html="<ul id="+parent_id+">",noHaveData=[];angular.element.each(data.data,function(key,val){val.key||noHaveData.push(val.org_id),html+='<li id="s'+val.org_id+'"><div class="nav-common nav-allcol" ><span data-ng-click="colleague.getGroup('+val.org_id+',$event)"><i class="icon-trigon">&#xe60f;</i><b class="overf">'+val.org_name+'</b>&nbsp;<span class="member-num">'+val.count+'</span></span><i isperm pcode="WorkmateMymateEdite" class="icon-trigon add-dep fr" ng-click="colleague.sectorSettings('+val.org_id+')">&#xe607;</i></div></li>'}),html+="</ul>";var ele=angular.element(html);$compile(ele)($scope),target.parent().parent().append(ele);var div=target.parent(),left=parseFloat(div.css("padding-left"))+15;ele.find("div").css("padding-left",left+"px");for(var i=0;i<noHaveData.length;i++)angular.element("#s"+noHaveData[i]).find("div").css("background","#fff").find("i:first-child").remove();colleague.sectorPageOrgId=parent_id,ColleagueModel.myTeamMemberList($scope,parent_id)}),$event.stopPropagation())},colleague.sectorSettingRemovalDepName="",colleague.sectorSettings=function(orgId){colleague.isShowPartSet=!0,$("#masklayer1").show(),ColleagueModel.getSectorSettings($scope,orgId)},colleague.HidePartSet=function(){colleague.sectorDepLeader="",colleague.gMid="",colleague.isShowPartSet=!1,$("#masklayer1").hide()},colleague.setSectorLeaderPopup=function(orgId){colleague.isShowAddPrin=!0,colleague.sectorDepOrgId=orgId,ColleagueModel.setSectorDepMember($scope,colleague.sectorDepOrgId,"",1)},colleague.getSelectLeader=function(gMid,name){colleague.gMid=gMid,colleague.sectorDepLeader=name,colleague.isShowAddPrin=!1},colleague.selectSectorDepartment=function(orgName,orgID){$scope.colleague.sectorSuperiorDepName=orgName,colleague.setSectorParentId=orgID,colleague.departmentCtr=!1},colleague.selectDepName=function(){colleague.departmentCtr=!0,ColleagueModel.getOrgInfo($scope,$scope.colleague.sectorSuperiorDepName)},colleague.SectorDepartmentPoupeCtr=function(){ColleagueModel.getOrgInfo($scope,""),colleague.departmentCtr=!colleague.departmentCtr},colleague.setDepartment=function(){var flag="";return colleague.sectorSuperiorDepName.length<=0?void alert("上级部门不能为空！"):colleague.setSectorParentId.length<=0&&colleague.sectorSuperiorDepName!=colleague.higherDepartment?void alert("上级部门不存在，请重新选择！"):colleague.sectorDepName.length<=0?void alert("部门名称不能为空！"):(colleague.sectorDepName!=colleague.sectorSettingRemovalDepName&&(flag=1),colleague.sectorDepName.length>20?void alert("部门名称输入不能超过20个字！"):0==colleague.sectorDepLeader.length?void alert("请选择部门负责人！"):void ColleagueModel.setSectorDep($scope,colleague.sectorDepName,colleague.setSectorParentId,colleague.sectorDepOrgId,colleague.gMid,flag))},colleague.divisionDissolution=function(){ColleagueModel.deleteOrgDep($scope.colleague.sectorDepOrgId)},colleague.searchLeader=function(){ColleagueModel.setSectorDepMember($scope,colleague.sectorDepOrgId,$scope.colleague.sectorSearchName)},colleague.transferDepMemSub=function(){return colleague.sectorSuperiorDepName.length<=0?void alert("请选择转移部门！"):void ColleagueModel.TransferDepartmentMem($scope,colleague.transferDepOrgUid,colleague.setSectorParentId)},colleague.transferDepartment=function(parent_id,$event){$http.get("/index.php?r=workmate/workmate/list&parent_group_id="+parent_id).success(function(data,status,headers,config){var html="<ul id="+parent_id+">",noHaveData=[];angular.element.each(data.data,function(key,val){val.key||noHaveData.push(val.org_id),html+='<li id="s'+val.org_id+'"><div class="nav-common nav-allcol" ><span data-ng-click="colleague.getGroup('+val.org_id+',$event)"><i class="icon-trigon">&#xe60f;</i>'+val.org_name+'<span class="member-num">'+val.count+'</span></span><i isperm pcode="WorkmateMymateEdite" class="icon-trigon add-dep fr" ng-click="colleague.sectorSettings('+val.org_id+')">&#xe607;</i></div></li>'}),html+="</ul>";var ele=angular.element(html);$compile(ele)($scope),target.parent().parent().append(ele);var div=target.parent(),left=parseFloat(div.css("padding-left"))+15;ele.find("div").css("padding-left",left+"px");for(var i=0;i<noHaveData.length;i++)angular.element("#s"+noHaveData[i]).find("div").css("background","#fff").find("i:first-child").remove()})}});
ColleagueMod.controller("ScoreboardCtr",function($scope,$state,ColleagueModel,permissionService){if(!permissionService.checkPermission("WorkmateScoreboard"))return $state.go("main.index",{},{reload:!1}),!1;var scoreboard=$scope.scoreBoard=[];scoreboard.richIntegralList=[],scoreboard.dataSelect=1,scoreboard.searchTime="week",scoreboard.integral=[],scoreboard.dataSelectCtr=function(status,selectTime){scoreboard.dataSelect=status,scoreboard.searchTime=selectTime,ColleagueModel.getIntegral($scope,scoreboard.searchTime)},ColleagueModel.getIntegral($scope,scoreboard.searchTime),ColleagueModel.getRichData($scope)});
ColleagueMod.factory("ColleagueModel",function($http,$state,$cookieStore,util){var colleagueService={};return colleagueService.getAllDepartment=function($scope,parentGroupId){$http.get("/index.php?r=workmate/workmate/list&&parent_group_id="+parentGroupId).success(function(data){$scope.colleague.companyNubSum=data.data[0].count})},colleagueService.myTeamMemberList=function($scope,orgId,curPage,type){$http.post("/index.php?r=workmate/workmate/get-my-dep-member",{orgId:orgId,curPage:curPage}).success(function(data){$scope.colleague.isLeader=orgId,data.data.list=util.setImgRand(data.data.list),$scope.myTeamList=data.data,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage,$scope.colleague.memberInfoMess=data.data.list,1==type&&angular.forEach($scope.colleague.memberInfoMess,function(one,index){one.org_id==orgId&&1==one.is_manager&&($scope.colleague.sectorDepLeader=one.real_name,$scope.colleague.gMid=one.org_u_id)})})},colleagueService.myTeamMemberListOne=function($scope,orgId){$http.post("/index.php?r=workmate/workmate/get-my-dep-member",{orgId:orgId}).success(function(data){$scope.colleague.isLeader=orgId,data.data.list=util.setImgRand(data.data.list),$scope.myTeamList=data.data,$scope.colleague.myTeamNubSum=data.data.sum,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},colleagueService.myTeamListSum=function($scope,parentGroupId){$http.post("/index.php?r=workmate/workmate/list",{parent_group_id:parentGroupId}).success(function(data){$scope.colleague.myTeamList=data.data})},colleagueService.getAllComMeb=function($scope,$realName){$http.post("/index.php?r=workmate/workmate/get-all-members",{realName:$realName}).success(function(data){$scope.allMembers=data.data})},colleagueService.getWorkingConditions=function($scope,realName,pageSize,curPage){$http.post("/index.php?r=workmate/workmate/working-situation",{realName:realName,num:pageSize,current:curPage}).success(function(data){$scope.WorkingConditions=data.data.work,$scope.page.sumPage=data.data.totalPage,$scope.page.curPage=$scope.page.tempcurPage})},colleagueService.getOrgInfo=function($scope,orgName){$http.post("/index.php?r=attendance/attendance/org-info",{search_org_name:orgName}).success(function(data){$scope.orgNameList=data.data})},colleagueService.addDepartment=function($scope,groups,gname){$http.post("/index.php?r=workmate/workmate/create-org",{groups:groups,gname:gname}).success(function(data){return $scope.colleague.errorInfo.code=data.code,$scope.colleague.errorInfo.msg=data.msg,0==$scope.colleague.errorInfo.code&&"该部门已存在"==$scope.colleague.errorInfo.msg?void alert("该部门已存在!"):(alert("添加成功！"),void $state.go("main.colleague.myColleague",{},{reload:!0}))})},colleagueService.getRichData=function($scope){$http.post("/index.php?r=workmate/workmate/rich-integral").success(function(data){data.data=util.setImgRand(data.data),$scope.scoreBoard.richIntegralList=data.data})},colleagueService.getIntegral=function($scope,selectData){$http.post("/index.php?r=workmate/workmate/integral",{data:selectData}).success(function(data){data.data=util.setImgRand(data.data),$scope.scoreBoard.integral=data.data})},colleagueService.getSectorSettings=function($scope,orgId){$http.post("/index.php?r=workmate/workmate/org-info",{orgId:orgId}).success(function(data){colleagueService.myTeamMemberList($scope,orgId,"",1),$scope.colleague.sectorSettingsList=data.data,$scope.colleague.sectorSuperiorDepName=$scope.colleague.sectorSettingsList.parent_org_name,$scope.colleague.higherDepartment=$scope.colleague.sectorSettingsList.parent_org_name,$scope.colleague.sectorDepName=$scope.colleague.sectorSettingsList.org_name,$scope.colleague.sectorDepOrgId=$scope.colleague.sectorSettingsList.org_id,$scope.colleague.setSectorParentId=$scope.colleague.sectorSettingsList.parent_org_id,$scope.colleague.sectorSettingRemovalDepName=$scope.colleague.sectorSettingsList.org_name})},colleagueService.SectorSettingsMemberList=function($scope,orgId,realName,type){$http.post("/index.php?r=workmate/workmate/memberlist",{orgId:orgId,realName:realName,type:type}).success(function(data){$scope.colleague.sectorMemberList=data.data.list})},colleagueService.setSectorDep=function($scope,groupName,parentId,orgId,gMid,flag){$http.post("/index.php?r=workmate/workmate/update-org",{groupName:groupName,parentId:parentId,orgId:orgId,gMid:gMid,flag:flag}).success(function(data){if(2e4==data.code){alert(data.msg),$scope.colleague.sectorDepLeader="",$scope.colleague.gMid="";var userInfo=$cookieStore.get("userInfo");userInfo.leave_points=data.data,$cookieStore.put("userInfo",userInfo),colleagueService.myTeamMemberList($scope,$scope.colleague.sectorDepOrgId,$scope.page.tempcurPage),$scope.colleague.isShowPartSet=!1,$("#masklayer1").hide()}else 0==data.code&&alert(data.msg)})},colleagueService.deleteOrgDep=function(orgId){$http.post("/index.php?r=workmate/workmate/delete-org",{orgId:orgId}).success(function(data){if(2e4==data.code)alert(data.msg),$state.go("main.colleague.myColleague",{},{reload:!0});else if(0==data.code)return void alert(data.msg)})},colleagueService.TransferDepartmentMem=function($scope,orgUid,orgId){$http.post("/index.php?r=workmate/workmate/transfer-department",{orgUid:orgUid,orgId:orgId}).success(function(data){if(2e4==data.code){if($cookieStore.get("userInfo").u_id==$scope.colleague.Uid){var userInfo=$cookieStore.get("userInfo");userInfo.org.org_id=orgId,userInfo.leave_points=0,$cookieStore.put("userInfo",userInfo)}alert("转移成功"),$scope.colleague.isShowTransfer=!1,$("#masklayer1").hide(),colleagueService.myTeamMemberList($scope,$scope.colleague.sectorPageOrgId)}else if(0==data.code)return void alert(data.msg)})},colleagueService.getTransferDepOrgName=function($scope,orgUid){$http.post("/index.php?r=workmate/workmate/get-personal-dep-info",{orgUid:orgUid}).success(function(data){$scope.colleague.originalDep=data})},colleagueService.setSectorDepMember=function($scope,orgId,searchName,type){$http.post("/index.php?r=workmate/workmate/select-department-member",{orgId:orgId,searchName:searchName,type:type}).success(function(data){$scope.colleague.sectorMemberList=data.data})},colleagueService});
TaskMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/colleague/view/";$stateProvider.state("main.colleague",{url:"/colleague",module:"private",data:{css:["css/task.css","css/lib/datetimepicker.css","css/colleague.css","css/attendance.css","css/meeting.css"]},views:{"colleagueContent@main":{templateUrl:basePath+"colleague_content.html"}}}).state("main.colleague.work",{url:"/work",module:"private",views:{"work@main.colleague":{templateUrl:basePath+"work.html",controller:"WorkCtr"}}}).state("main.colleague.myColleague",{url:"/myColleague",module:"private",views:{"myColleague@main.colleague":{templateUrl:basePath+"myColleague.html",controller:"MyColleagueCtr"}}}).state("main.colleague.scoreboard",{url:"/scoreboard",module:"private",views:{"scoreboard@main.colleague":{templateUrl:basePath+"scoreboard.html",controller:"ScoreboardCtr"}}})}]);
var personalInfoMod=angular.module("personalInfoMod",[]);personalInfoMod.controller("personalInfoCtrl",function($scope,$state,$http,$rootScope,userModel,$window,$cookieStore){var userInfo=$scope.userInfo={},user_param=$scope.user_param={},param=$scope.param={};userInfo.detail={},userInfo.skills="",user_param.phone="",param.pwd=user_param.pwd="",param.newpass=user_param.newpass="",param.newpass2=user_param.newpass2="",user_param.option="",user_param.val="",userInfo.pwdWin=!1,userInfo.mobileWin=!1,userModel.getMyUserInfo($scope),$scope.filename=function(){return angular.element("#usershowimg")},clipPic("showimgcho","usershowimg",function(data){$http.post("/index.php?r=userinfo/userinfo/setheadimg",{data:data}).success(function(data,status){angular.element("#usershowimg").attr("src",data.filename+"?"+Date.parse(new Date)),angular.element(".user_img img").attr("src",data.filename+"?"+Date.parse(new Date));var userInfoCookie=$cookieStore.get("userInfo");userInfoCookie.head_img=data.data+"?"+Math.random(),$cookieStore.put("userInfo",userInfoCookie),userInfo.detail.head_img=$rootScope.rootUserInfo.head_img=data.data+"?"+Math.random(),location.reload()})},50),userInfo.isChecked=function(value){return 0!=value},userInfo.editeMobile=function(){user_param.option="phone",user_param.val=user_param.phone;var reg=/^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/i;return reg.test(user_param.phone)?void userModel.editeUserInfo($scope,0):void alert("手机号码格式不正确")},userInfo.editePwd=function(){if(param.option="pwd","undefind"==typeof user_param.pwd||null==user_param.pwd||""==user_param.pwd)return void alert("原密码不能为空");if("undefind"==typeof user_param.newpass||null==user_param.newpass||""==user_param.newpass)return void alert("新密码不能为空");if("undefind"==typeof user_param.newpass2||null==user_param.newpass2||""==user_param.newpass2)return void alert("重复新密码不能为空");var pwd_reg=/^[A-Za-z0-9]{6,16}$/;return pwd_reg.test(user_param.newpass)&&pwd_reg.test(user_param.newpass2)?user_param.newpass!=user_param.newpass2?void alert("两次密码不一致"):user_param.newpass.length<6?void alert("密码至少6位"):user_param.pwd===user_param.newpass?void alert("新密码不能与旧密码一致"):(param.val=angular.element.md5(user_param.pwd),param.newpass=angular.element.md5(user_param.newpass),param.newpass2=angular.element.md5(user_param.newpass2),void userModel.editeUserInfo($scope,1)):void alert("密码应为6至16位的字母数字或组合")},userInfo.cancelEdite=function(){user_param.pwd="",user_param.newpass="",user_param.newpass2="",userInfo.pwdWin=!1},userInfo.editePush=function(option,val){user_param.option=option,user_param.val=0==val?1:0,userModel.editeUserInfo($scope,2)},userInfo.back=function(){$window.history.back()},$scope.logout=function(){$cookieStore.remove("userInfo"),$state.go("login",{},{reload:!0})}});
personalInfoMod.controller("skillScoreCtrl",function($scope,$http,$cookieStore,$window,$rootScope,userModel,$timeout){var userInfo=$scope.userInfo={};userInfo.detail={},userInfo.skills="",userInfo.skill_rulls="",userModel.getSkillScore($scope),$scope.filename=function(){return angular.element("#usershowimg")},userInfo.back=function(){$window.history.back()}});
personalInfoMod.controller("vacationCtrl",function($scope,$http,$cookieStore,$window,$rootScope,userModel,$timeout){var userInfo=$scope.userInfo={};$scope.vacation={};userInfo.detail=$cookieStore.get("userInfo"),userModel.getMyVacation($scope),userInfo.back=function(){$window.history.back()}});
personalInfoMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/personalInfo/view/";$stateProvider.state("main.personalInfo",{url:"/personalInfo",module:"private",data:{css:["css/personal_info.css","css/lib/datetimepicker.css"]},views:{"personalInfoContent@main":{templateUrl:basePath+"personalInfo_content.html"}}}).state("main.personalInfo.myInfoList",{url:"/myInfoList",module:"private",views:{"personalInfo_myInfoList@main.personalInfo":{templateUrl:basePath+"personalInfo_myInfoList.html",controller:"personalInfoCtrl"}}}).state("main.personalInfo.skillList",{url:"/skillList",module:"private",views:{"personalInfo_skillList@main.personalInfo":{templateUrl:basePath+"personalInfo_skillList.html",controller:"skillScoreCtrl"}}}).state("main.personalInfo.vacationList",{url:"/vacationList",module:"private",views:{"personalInfo_vacationList@main.personalInfo":{templateUrl:basePath+"personalInfo_vacationList.html",controller:"vacationCtrl"}}})}]);
personalInfoMod.factory("userModel",function($http){var service={};return service.getMyUserInfo=function($scope){$http.get("/index.php?r=userinfo/userinfo/user-info").success(function(data,status){data.data.memberinfo.head_img=data.data.memberinfo.head_img+"?"+Math.random(),$scope.userInfo.detail=data.data.memberinfo,$scope.user_param.phone=$scope.userInfo.detail.phone,$scope.userInfo.skills=data.data.skills})},service.getSkillScore=function($scope){$http.get("/index.php?r=userinfo/userinfo/getmemberskill").success(function(data,status){data.data.memberinfo.head_img=data.data.memberinfo.head_img+"?"+Math.random(),$scope.userInfo.detail=data.data.memberinfo,$scope.userInfo.skills=data.data.skill_list,$scope.userInfo.skill_rulls=data.data.skill_rulls})},service.getMyVacation=function($scope){$http.get("/index.php?r=userinfo/userinfo/get-vacation").success(function(data,status){$scope.vacation.annual_leave=data.data.vacation,$scope.vacation.over_time=data.data.over_time})},service.editeUserInfo=function($scope,type){var str=JSON.stringify($scope.user_param);1==type&&(str=JSON.stringify($scope.param)),$http.post("/index.php?r=userinfo/userinfo/set",str).success(function(data,status){2e4==data.code?($scope.user_param.pwd="",$scope.user_param.newpass="",$scope.user_param.newpass2="",$scope.userInfo.pwdWin=!1,$scope.userInfo.mobileWin=!1,alert(data.msg),service.getMyUserInfo($scope)):alert(data.msg)})},service.editeSkill=function($scope){$http.post("/index.php?r=userinfo/userinfo/skill-set",JSON.stringify($scope.user_param)).success(function(data,status){2e4==data.code?alert(data.msg):alert(data.msg)})},service.uploadHead=function($scope){$http.post("/index.php?r=userinfo/userinfo/setheadimg",JSON.stringify($scope.user_param)).success(function(data,status){2e4==data.code?alert(data.msg):alert(data.msg)})},service});
var MsgMod=angular.module("MsgMod",[]);MsgMod.controller("ApprovalMsgCtrl",function($scope,$http,$rootScope,$timeout,msgModel,Publicfactory,$location,$state){var msg=$scope.msg={},msg_param=$scope.msg_param={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},msg_param.page=1,msg_param.type=1,msg.msgInfo={},msgModel.getMsgListInfo($scope),$scope.page_fun=function(){msg_param.page=$scope.page.tempcurPage,msgModel.getMsgListInfo($scope)},msg.goDetail=function(obj){return null==obj.modeltype||null==obj.model_id?void alert("数据不存在了~"):void $state.go("main.apply.agent",{apply_id:obj.apply_id,model_id:obj.model_id,model_type:obj.modeltype})}});
MsgMod.controller("ApplyMsgCtrl",function($scope,$http,$rootScope,$timeout,msgModel,Publicfactory,$location,$state){var msg=$scope.msg={},msg_param=$scope.msg_param={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},msg_param.page=1,msg_param.type=2,msg.msgInfo={},msgModel.getMsgListInfo($scope),$scope.page_fun=function(){msg_param.page=$scope.page.tempcurPage,msgModel.getMsgListInfo($scope)},msg.goDetail=function(obj){return null==obj.model_id?void alert("数据不存在了~"):void $state.go("main.apply.mine",{apply_id:obj.apply_id,model_id:obj.model_id})}});
MsgMod.controller("MeetingMsgCtrl",function($scope,$http,$rootScope,$timeout,msgModel,Publicfactory,$location){var msg=$scope.msg={},msg_param=$scope.msg_param={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},msg_param.page=1,msg_param.type=3,msg.msgInfo={},msgModel.getMsgListInfo($scope),$scope.page_fun=function(){msg_param.page=$scope.page.tempcurPage,msgModel.getMsgListInfo($scope)}});
MsgMod.controller("TaskMsgCtrl",function($scope,$http,$rootScope,$timeout,msgModel,Publicfactory,$location,$state){var msg=$scope.msg={},msg_param=$scope.msg_param={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},msg_param.page=1,msg_param.type=4,msg.msgInfo={},msgModel.getMsgListInfo($scope),$scope.page_fun=function(){msg_param.page=$scope.page.tempcurPage,msgModel.getMsgListInfo($scope)},msg.goDetail=function(obj){0==obj.menu?alert("数据不存在了~"):1==obj.menu?$state.go("main.task.myTask",{task_id:obj.task_id}):2==obj.menu?$state.go("main.task.myReleaseTask",{task:obj.task_id}):3==obj.menu?$state.go("main.task.rewardTask",{task:obj.task_id}):4==obj.menu&&$state.go("main.task.myRewardTask",{task:obj.task_id})}});
MsgMod.controller("ProjectMsgCtrl",function($scope,$http,$rootScope,$timeout,msgModel,Publicfactory,$location,$state){var msg=$scope.msg={},msg_param=$scope.msg_param={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},msg_param.page=1,msg_param.type=5,msg.msgInfo={},msgModel.getMsgListInfo($scope),$scope.page_fun=function(){msg_param.page=$scope.page.tempcurPage,msgModel.getMsgListInfo($scope)},msg.goDetail=function(obj){0==obj.menu?alert("数据不存在了~"):1==obj.menu?$state.go("main.project.mycreatepro.prodetail",{isInit:1,list_status:0,pro_id:obj.project_id}):2==obj.menu&&$state.go("main.project.myinvoepro.prodetail",{isInit:1,list_status:0,pro_id:obj.project_id})}});
MsgMod.controller("ReportMsgCtrl",function($scope,$http,$rootScope,$timeout,msgModel,Publicfactory,$location,$state){var msg=$scope.msg={},msg_param=$scope.msg_param={};$scope.page={curPage:1,tempcurPage:1,sumPage:0},msg_param.page=1,msg_param.type=6,msg.msgInfo={},msgModel.getMsgListInfo($scope),$scope.page_fun=function(){msg_param.page=$scope.page.tempcurPage,msgModel.getMsgListInfo($scope)},msg.goDetail=function(obj){1==obj.menu?$state.go("main.workStatement.checkTable",{work_id:obj.work_id}):2==obj.menu&&$state.go("main.workStatement.myWorkStatementTable.TabDetails",{work_id:obj.work_id})}});
SurveyMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/msg/view/";$stateProvider.state("main.msg",{url:"/msg",module:"private",data:{css:["css/msg.css"]},views:{"msgContent@main":{templateUrl:basePath+"msg_content.html"}}}).state("main.msg.approvalmsglist",{url:"/approvalmsglist",module:"private",views:{"msg@main.msg":{templateUrl:basePath+"approvalmsglist.html",controller:"ApprovalMsgCtrl"}}}).state("main.msg.applymsglist",{url:"/applymsglist",module:"private",views:{"msg@main.msg":{templateUrl:basePath+"applymsglist.html",controller:"ApplyMsgCtrl"}}}).state("main.msg.meetingmsglist",{url:"/meetingmsglist",module:"private",views:{"msg@main.msg":{templateUrl:basePath+"meetingmsglist.html",controller:"MeetingMsgCtrl"}}}).state("main.msg.taskmsglist",{url:"/taskmsglist",module:"private",views:{"msg@main.msg":{templateUrl:basePath+"taskmsglist.html",controller:"TaskMsgCtrl"}}}).state("main.msg.projectmsglist",{url:"/projectmsglist",module:"private",views:{"msg@main.msg":{templateUrl:basePath+"projectmsglist.html",controller:"ProjectMsgCtrl"}}}).state("main.msg.reportmsglist",{url:"/reportmsglist",module:"private",views:{"msg@main.msg":{templateUrl:basePath+"reportmsglist.html",controller:"ReportMsgCtrl"}}})}]);
MsgMod.factory("msgModel",function($http,$state,$cookieStore,$sce){var service={};return service.getMsgListInfo=function($scope){$http.post("/index.php?r=desk/desk/msg-list-info",JSON.stringify($scope.msg_param)).success(function(data){1==data.code&&($scope.msg.msgInfo=data.data.list,$scope.page.curPage=data.data.page.curPage,$scope.page.sumPage=data.data.page.sumPage)})},service});
var NanoCloudMod=angular.module("NanoCloudMod",[]);NanoCloudMod.controller("NanoCloudSectionCtrl",function($scope,$http,$state,$rootScope,$stateParams,$timeout,$filter,nanoCloudModel,$compile,$state,Publicfactory){var nanocloud=$scope.nanocloud={};nanocloud.isShowUplodingMenu=!1,nanocloud.isShowOperatorMenu=!1,nanocloud.isShowRename=!1,nanocloud.isAllSelected=!1,nanocloud.selecteds=0,nanocloud.isShowSetShare=!1,nanocloud.isShowSetShare=!1,nanocloud.isShowCheckShare=!1,nanocloud.isShowShare=!1,nanocloud.isShowOperateLog=!1,nanocloud.isShowCheckHistoryVer=!1,nanocloud.isShowMoveFile=!1,nanocloud.isShowDeleteFile=!1,nanocloud.isShowCancelJoin=!1,nanocloud.isShowBigUploading=!1,nanocloud.isShowSmallUploading=!1,nanocloud.oldFileName="",nanocloud.myFiles=[],nanocloud.isBiuldNewFile=!1,nanoCloudModel.getMyFiles($scope),nanocloud.indexs=-1,$scope.getindex=function($index){nanocloud.indexs=$index,angular.forEach(nanocloud.myFiles,function(data){data.isSelected=!1}),nanocloud.selected()},$scope.fuzhi=function(){nanocloud.indexs>=0?alert(nanocloud.indexs):console.log(nanocloud.indexs)},nanocloud.dropdown=function(e){nanocloud.isShowUplodingMenu=!nanocloud.isShowUplodingMenu},nanocloud.upLodingFile=function($event){$event.stopPropagation(),nanocloud.isShowUplodingMenu=!nanocloud.isShowUplodingMenu},nanocloud.selected=function(event,index,i){0==i?(nanocloud.isAllSelected=!nanocloud.isAllSelected,nanocloud.isAllSelected?angular.forEach(nanocloud.myFiles,function(data){data.isSelected=!0}):angular.forEach(nanocloud.myFiles,function(data){data.isSelected=!1})):1==i?0==angular.element(event.target).parents("span.operate").length&&(nanocloud.myFiles[index].isSelected=!nanocloud.myFiles[index].isSelected):nanocloud.myFiles[nanocloud.indexs].isSelected=!0;var arr=nanocloud.myFiles.filter(function(data){return 1==data.isSelected});nanocloud.selecteds=arr.length,nanocloud.isShowOperatorMenu=arr.length>0,nanocloud.isAllSelected=arr.length==nanocloud.myFiles.length},nanocloud.rename=function(event,i){var input=null;1==i?(input=angular.element("#li"+nanocloud.indexs).find("input.input-rename").show(),nanocloud.oldFileName=input.val(),nanocloud.selectText(input)):(input=angular.element(event.target).parents("li.list-content").find("input.input-rename").show(),nanocloud.oldFileName=input.val(),nanocloud.selectText(input),angular.element(event.target).parents("div.dia-more").hide())},nanocloud.selectText=function(input){input.prev().hide(),input.focus();var dot=input.val().split(".");dot.length>1?input[0].setSelectionRange(0,dot[0].length):input[0].setSelectionRange(0,input.val().length)},nanocloud.blur=function($event){angular.element($event.target).hide().prev().show(),angular.element($event.target).next().hide()},nanocloud.showDiaMore=function(event){angular.element(document).unbind("mousedown"),angular.element("ul.list div.dia-more").hide(),angular.element(event.target).next().show(),angular.element(document).bind("mousedown",function(e){0==angular.element(e.target).parents("div.dia-more").length&&angular.element("ul.list div.dia-more").hide()})},nanocloud.hideDiaMore=function(event){angular.element(event.currentTarget).find(".dia-more").hide()},nanocloud.createFile=function(){var obj={fileType:"wenjianjia",fileName:"新建文件夹",modifyTime:$filter("date")(new Date,"yyyy-MM-dd HH:mm"),size:0};nanocloud.myFiles.unshift(obj),$timeout(function(){angular.element("#li0").find("input.input-rename").show().focus().prev().hide(),angular.element("#li0").find("input.input-rename")[0].select()})},nanocloud.enterRecycle=function(){$state.go("main.nanoCloud.nanoCloudRecycle")},nanocloud.backToNanocloudSection=function(){$state.go("main.nanoCloud.nanoCloudSection")},nanocloud.deleteFile=function(event){_.remove(nanocloud.myFiles,function(data){return 1==data.isSelected});event&&angular.element(event.target).parents(".right-click").removeClass("open")},nanocloud.fileListToggle=function(event){$(".file>div div").removeClass("folderSelected"),$(event.currentTarget).addClass("folderSelected");var b=$(event.currentTarget).find("b:nth-child(1)");if("+"===b.text()){b.text("-");var id=$(event.currentTarget).attr("id"),left=parseInt($(event.currentTarget).css("padding-left"))+20;id++,$scope["data"+id]=nanocloud.getDatas(id),html='<ul><li ng-repeat="item in data'+id+'"> <div id="'+id+'" ng-click="nanocloud.fileListToggle($event)"  class="fileList" style="padding-left: '+left+'px"> <b class="addIcon f18">+</b> <b class="fileIcon"></b> <span>{{item}}</span> </div> </li> </ul>';var parent=$(event.currentTarget).parent();parent.append($compile(html)($scope))}else b.text("+"),$(event.currentTarget).next().remove()},nanocloud.getDatas=function(id){return 1==id?["项目1a","项目1b"]:2==id?["项目2a","项目2b"]:3==id?["项目3a","项目3b"]:4==id?["项目4a","项目4b"]:void 0},nanocloud.setShare=function(){$("#masklayer1").show(),nanocloud.isShowSetShare=!0},nanocloud.closeSetShare=function(){$("#masklayer1").hide(),nanocloud.isShowSetShare=!1},nanocloud.checkShare=function(){$("#masklayer1").show(),nanocloud.isShowCheckShare=!0},nanocloud.closeCheckShare=function(){$("#masklayer1").hide(),nanocloud.isShowCheckShare=!1},nanocloud.load=function(){},nanocloud.getShareLink=function(){$("#masklayer1").show(),nanocloud.isShowShare=!0},nanocloud.closeGetShareLink=function(){$("#masklayer1").hide(),nanocloud.isShowShare=!1},nanocloud.cancelShare=function(){},nanocloud.showOperateLog=function(){$("#masklayer1").show(),nanocloud.isShowOperateLog=!0},nanocloud.closeOperateLog=function(){$("#masklayer1").hide(),nanocloud.isShowOperateLog=!1},nanocloud.checkHistoryVer=function(){$("#masklayer1").show(),nanocloud.isShowCheckHistoryVer=!0},nanocloud.closeCheckHistoryVer=function(){$("#masklayer1").hide(),nanocloud.isShowCheckHistoryVer=!1},nanocloud.moveFile=function(){$("#masklayer1").show(),nanocloud.isShowMoveFile=!0},nanocloud.closeMoveFile=function(){$("#masklayer1").hide(),nanocloud.isShowMoveFile=!1},nanocloud.copyFile=function(){$("#masklayer1").show(),nanocloud.isShowMoveFile=!0},nanocloud.cancelJoin=function(){$("#masklayer1").show(),nanocloud.isShowCancelJoin=!0},nanocloud.closeCancelJoin=function(){$("#masklayer1").hide(),nanocloud.isShowCancelJoin=!1},nanocloud.deleteFile=function(event){$("#masklayer1").show(),nanocloud.isShowDeleteFile=!0},nanocloud.closeDeleteFile=function(event){$("#masklayer1").hide(),nanocloud.isShowDeleteFile=!1}});
NanoCloudMod.controller("NanoCloudRecycleCtrl",function($scope,$http,$state,nanoCloudModel,$rootScope,$stateParams,$timeout,$filter,$state,Publicfactory){var nanocloud=$scope.nanocloud={};nanocloud.isAllSelected=!1,nanocloud.selecteds=0,nanocloud.isShowOperatorMenu=!1,nanocloud.recycleContent=[],nanoCloudModel.getRecycleContent($scope),nanocloud.indexs=-1,$scope.getindex=function($index){nanocloud.indexs=$index,angular.forEach(nanocloud.recycleContent,function(data){data.isSelected=!1}),nanocloud.selected()},$scope.fuzhi=function(){nanocloud.indexs>=0?alert(nanocloud.indexs):console.log(nanocloud.indexs)},nanocloud.selected=function(index,i){0==i?(nanocloud.isAllSelected=!nanocloud.isAllSelected,nanocloud.isAllSelected?angular.forEach(nanocloud.recycleContent,function(data){data.isSelected=!0}):angular.forEach(nanocloud.recycleContent,function(data){data.isSelected=!1})):1==i?nanocloud.recycleContent[index].isSelected=!nanocloud.recycleContent[index].isSelected:nanocloud.recycleContent[nanocloud.indexs].isSelected=!0;var arr=nanocloud.recycleContent.filter(function(data){return 1==data.isSelected});nanocloud.selecteds=arr.length,nanocloud.isShowOperatorMenu=arr.length>0,nanocloud.isAllSelected=arr.length==nanocloud.recycleContent.length},nanocloud.backToNanocloudSection=function(){$state.go("main.nanoCloud.nanoCloudSection")},nanocloud.deleteFile=function(event){_.remove(nanocloud.recycleContent,function(data){return 1==data.isSelected});event&&angular.element(event.target).parents(".right-click").removeClass("open")}});
NanoCloudMod.factory("nanoCloudModel",function($http,$state,$cookieStore,$sce){var service={};return service.getMyFiles=function($scope){var arr=[{fileType:"pdf",fileName:"示范文档1.pdf",modifyTime:"2016-10-24 16:19",size:"13.5",isSelected:!1,isRenaming:!1},{fileType:"ppt",fileName:"示范文档2.pdf",modifyTime:"2016-10-24 16:19",size:"3.5",isSelected:!1,isRenaming:!1},{fileType:"ai",fileName:"示范文档3.pdf",modifyTime:"2016-10-24 16:19",size:"80.5",isSelected:!1,isRenaming:!1}];$scope.nanocloud.myFiles=arr},service.getRecycleContent=function($scope){var arr=[{fileType:"pdf",fileName:"示范文档1.pdf",modifyTime:"2016-10-24 16:19",size:"13.5",isSelected:!1,isRenaming:!1},{fileType:"ppt",fileName:"示范文档2.pdf",modifyTime:"2016-10-24 16:19",size:"3.5",isSelected:!1,isRenaming:!1},{fileType:"ai",fileName:"示范文档3.pdf",modifyTime:"2016-10-24 16:19",size:"80.5",isSelected:!1,isRenaming:!1}];$scope.nanocloud.recycleContent=arr},service});
NanoCloudMod.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider,$q){var basePath="appnews/modules/nanoCloud/view/";$stateProvider.state("main.nanoCloud",{url:"/nanoCloud",module:"private",data:{css:["css/nanoCloud.css"]},views:{"nanoCloudContent@main":{templateUrl:basePath+"nanoCloud_content.html"}},onEnter:function(){document.oncontextmenu=function(){return!1}},onExit:function(){document.oncontextmenu=function(){return!0}}}).state("main.nanoCloud.nanoCloudSection",{url:"/nanoCloudSection",module:"private",views:{"nanoCloudSection@main.nanoCloud":{templateUrl:basePath+"nanoCloudSection.html",controller:"NanoCloudSectionCtrl"}}}).state("main.nanoCloud.nanoCloudRecycle",{url:"/nanoCloudRecycle",module:"private",views:{"nanoCloudRecycle@main.nanoCloud":{templateUrl:basePath+"nanoCloudRecycle.html",controller:"NanoCloudRecycleCtrl"}}})}]);
angular.module("ng-context-menu",[]).factory("ContextMenuService",function(){return{element:null,menuElement:null}}).directive("contextMenu",["$document","ContextMenuService",function(e,n){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled",closeCallback:"&contextMenuClose"},link:function(t,l,c){function o(n,t){t.addClass("open");var l=e[0].documentElement,c=(window.pageXOffset||l.scrollLeft)-(l.clientLeft||0),o=(window.pageYOffset||l.scrollTop)-(l.clientTop||0),u=t[0].scrollWidth,i=t[0].scrollHeight,a=l.clientWidth+c,d=l.clientHeight+o,p=u+n.pageX,s=i+n.pageY,r=Math.max(n.pageX-c,0),f=Math.max(n.pageY-o,0);p>a&&(r-=p-a),s>d&&(f-=s-d),t.css("top",f+"px"),t.css("left",r+"px"),m=!0}function u(e){e.removeClass("open"),m&&t.closeCallback(),m=!1}function i(e){!t.disabled()&&m&&27===e.keyCode&&t.$apply(function(){u(n.menuElement)})}function a(e){t.disabled()||!m||2===e.button&&e.target===n.element||t.$apply(function(){u(n.menuElement)})}var m=!1;l.bind("contextmenu",function(e){t.disabled()||(null!==n.menuElement&&u(n.menuElement),n.menuElement=angular.element(document.getElementById(c.target)),n.element=e.target,e.preventDefault(),e.stopPropagation(),t.$apply(function(){t.callback({$event:e})}),t.$apply(function(){o(e,n.menuElement)}))}),e.bind("keyup",i),e.bind("click",a),e.bind("contextmenu",a),t.$on("$destroy",function(){e.unbind("keyup",i),e.unbind("click",a),e.unbind("contextmenu",a)})}}}]);